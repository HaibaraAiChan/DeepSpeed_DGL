[2021-06-17 19:38:47,753] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-17 19:38:51,414] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 ds_pseudo_mini_batch_train.py --aggre lstm --batch-size 12289 --log-every 120 --deepspeed_config ds_config.json
[2021-06-17 19:38:52,369] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-17 19:38:52,369] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-17 19:38:52,370] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-17 19:38:52,370] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-17 19:38:52,370] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623958737.9792778
before load_ogb step Time(s): 0.0020
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20668.84375, 'VmSize': 20541.9296875, 'VmHWM': 1165.29296875, 'VmRSS': 1165.29296875}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.5934
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2886
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0013
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.1156
-------------------------------------------------end of load ogb****************** step Time(s): 0.0187
finish constructing ogbn-products
load ogb-products time total: 2.017993927001953
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0189
after inductive else step Time(s): 0.0001
after label step Time(s): 4.4356
after train_g.create_formats_() step Time(s): 1.6836
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 12289
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-17 19:39:06,154] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.4.1+unknown, git-hash=unknown, git-branch=unknown
[2021-06-17 19:39:06,155] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-17 19:39:06,158] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-17 19:39:08,506] [INFO] [engine.py:173:__init__] DeepSpeed Flops Profiler Enabled: False
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/cc/.cache/torch_extensions/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 1.4969797134399414 seconds
[2021-06-17 19:39:11,420] [INFO] [engine.py:693:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-17 19:39:11,420] [INFO] [engine.py:697:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-17 19:39:11,420] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-17 19:39:11,420] [INFO] [engine.py:505:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-17 19:39:11,420] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f23aa3c41d0>
[2021-06-17 19:39:11,421] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 19:39:11,421] [INFO] [config.py:900:print] DeepSpeedEngine configuration:
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   allreduce_always_fp32 ........ False
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   amp_enabled .................. False
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   amp_params ................... False
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   checkpoint_tag_validation_enabled  True
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   checkpoint_tag_validation_fail  False
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   disable_allgather ............ False
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   dump_state ................... False
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   dynamic_loss_scale_args ...... None
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   eigenvalue_enabled ........... False
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   eigenvalue_gas_boundary_resolution  1
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   eigenvalue_layer_num ......... 0
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   eigenvalue_max_iter .......... 100
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   eigenvalue_stability ......... 1e-06
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   eigenvalue_tol ............... 0.01
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   eigenvalue_verbose ........... False
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   elasticity_enabled ........... False
[2021-06-17 19:39:11,421] [INFO] [config.py:904:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   fp16_enabled ................. False
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   fp16_mixed_quantize .......... False
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   global_rank .................. 0
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   gradient_accumulation_steps .. 1
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   gradient_clipping ............ 0.0
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   gradient_predivide_factor .... 1.0
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   initial_dynamic_scale ........ 4294967296
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   loss_scale ................... 0
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   memory_breakdown ............. False
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   optimizer_legacy_fusion ...... False
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   optimizer_name ............... adam
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   pld_enabled .................. False
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   pld_params ................... False
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   prescale_gradients ........... False
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   quantize_change_rate ......... 0.001
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   quantize_groups .............. 1
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   quantize_offset .............. 1000
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   quantize_period .............. 1000
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   quantize_rounding ............ 0
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   quantize_start_bits .......... 16
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   quantize_target_bits ......... 8
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   quantize_training_enabled .... False
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   quantize_type ................ 0
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   quantize_verbose ............. False
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   scheduler_name ............... WarmupLR
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   sparse_attention ............. None
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   sparse_gradients_enabled ..... False
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   steps_per_print .............. 10
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   tensorboard_enabled .......... False
[2021-06-17 19:39:11,422] [INFO] [config.py:904:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-17 19:39:11,423] [INFO] [config.py:904:print]   tensorboard_output_path ...... 
[2021-06-17 19:39:11,423] [INFO] [config.py:904:print]   train_batch_size ............. 1500
[2021-06-17 19:39:11,423] [INFO] [config.py:904:print]   train_micro_batch_size_per_gpu  1500
[2021-06-17 19:39:11,423] [INFO] [config.py:904:print]   use_quantizer_kernel ......... False
[2021-06-17 19:39:11,423] [INFO] [config.py:904:print]   wall_clock_breakdown ......... False
[2021-06-17 19:39:11,423] [INFO] [config.py:904:print]   world_size ................... 1
[2021-06-17 19:39:11,423] [INFO] [config.py:904:print]   zero_allow_untested_optimizer  False
[2021-06-17 19:39:11,423] [INFO] [config.py:904:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": true, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true, 
    "legacy_stage1": false
}
[2021-06-17 19:39:11,423] [INFO] [config.py:904:print]   zero_enabled ................. False
[2021-06-17 19:39:11,423] [INFO] [config.py:904:print]   zero_optimization_stage ...... 0
[2021-06-17 19:39:11,425] [INFO] [config.py:912:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Emitting ninja build file /home/cc/.cache/torch_extensions/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 1.5258848667144775 seconds
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.68408203125GB

Max Memory Allocated 1.2875089645385742  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.76806640625GB

Max Memory Allocated 1.2875089645385742  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.45556640625GB

Max Memory Allocated 16.605494499206543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.45556640625GB

Max Memory Allocated 16.605494499206543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.47119140625GB

Max Memory Allocated 16.605494499206543  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7785 | Train Acc 0.0304 | Speed (samples/sec) nan | GPU 17004.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.43212890625GB

Max Memory Allocated 16.605494499206543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.43212890625GB

Max Memory Allocated 16.605494499206543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.45556640625GB

Max Memory Allocated 16.605494499206543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.34619140625GB

Max Memory Allocated 16.605494499206543  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.33642578125GB

Max Memory Allocated 16.605494499206543  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.34033203125GB

Max Memory Allocated 16.605494499206543  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.30126953125GB

Max Memory Allocated 16.605494499206543  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.30126953125GB

Max Memory Allocated 16.605494499206543  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.32470703125GB

Max Memory Allocated 16.605494499206543  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.11376953125GB

Max Memory Allocated 16.65443515777588  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.10205078125GB

Max Memory Allocated 16.65443515777588  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.10595703125GB

Max Memory Allocated 16.65443515777588  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.06689453125GB

Max Memory Allocated 16.65443515777588  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.06689453125GB

Max Memory Allocated 16.65443515777588  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.65443515777588  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.11572265625GB

Max Memory Allocated 16.654659748077393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.10595703125GB

Max Memory Allocated 16.654659748077393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.10791015625GB

Max Memory Allocated 16.654659748077393  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.06884765625GB

Max Memory Allocated 16.654659748077393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.06884765625GB

Max Memory Allocated 16.654659748077393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.09228515625GB

Max Memory Allocated 16.654659748077393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.11572265625GB

Max Memory Allocated 16.654659748077393  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.10595703125GB

Max Memory Allocated 16.654659748077393  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.10791015625GB

Max Memory Allocated 16.654659748077393  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.06884765625GB

Max Memory Allocated 16.654659748077393  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.06884765625GB

Max Memory Allocated 16.654659748077393  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.09228515625GB

Max Memory Allocated 16.654659748077393  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.11572265625GB

Max Memory Allocated 16.659947395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.10595703125GB

Max Memory Allocated 16.659947395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.10791015625GB

Max Memory Allocated 16.659947395324707  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.06884765625GB

Max Memory Allocated 16.659947395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.06884765625GB

Max Memory Allocated 16.659947395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.659947395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.11572265625GB

Max Memory Allocated 16.659947395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.10595703125GB

Max Memory Allocated 16.659947395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.10791015625GB

Max Memory Allocated 16.659947395324707  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.06884765625GB

Max Memory Allocated 16.659947395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.06884765625GB

Max Memory Allocated 16.659947395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.09228515625GB

Max Memory Allocated 16.659947395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86376953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85400390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81689453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81689453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86376953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85400390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81689453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81689453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86376953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84228515625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84228515625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84228515625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84228515625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes

avg iteration(step) data from cpu to GPU time:18.36463998 ms
avg iteration GPU training time:313.90235485 ms
avg iteration (step) total cpu time:343.98605607 ms
Epoch Time(s): 8.6672
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

Epoch 00001 | Step 00000 | Loss 3.3141 | Train Acc 0.2547 | Speed (samples/sec) 33305.8381 | GPU 17108.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81689453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81689453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86376953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86376953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85400390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81689453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81689453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84228515625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84228515625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84228515625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81689453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81689453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84228515625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85400390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84228515625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84228515625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85400390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84228515625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84228515625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84228515625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86572265625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81689453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81689453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.86376953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85595703125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.85791015625GB

Max Memory Allocated 16.70785903930664  GigaBytes

avg iteration(step) data from cpu to GPU time:18.72516649 ms
avg iteration GPU training time:328.90252963 ms
avg iteration (step) total cpu time:358.96955837 ms
Epoch Time(s): 7.7176
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.81884765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.70785903930664  GigaBytes

Epoch 00002 | Step 00000 | Loss 3.3357 | Train Acc 0.2590 | Speed (samples/sec) 33098.7635 | GPU 17108.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.70785903930664  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.70785903930664  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

avg iteration(step) data from cpu to GPU time:18.52629818 ms
avg iteration GPU training time:304.55235984 ms
avg iteration (step) total cpu time:334.95714448 ms
Epoch Time(s): 7.5368
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

Epoch 00003 | Step 00000 | Loss 2.9639 | Train Acc 0.2979 | Speed (samples/sec) 33424.1427 | GPU 17142.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

avg iteration(step) data from cpu to GPU time:17.87892983 ms
avg iteration GPU training time:302.57398016 ms
avg iteration (step) total cpu time:336.01719683 ms
Epoch Time(s): 7.9775
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

Epoch 00004 | Step 00000 | Loss 2.8801 | Train Acc 0.3226 | Speed (samples/sec) 33713.7002 | GPU 17142.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

avg iteration(step) data from cpu to GPU time:17.31189260 ms
avg iteration GPU training time:296.08915017 ms
avg iteration (step) total cpu time:325.32197779 ms
Epoch Time(s): 7.4132
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

Epoch 00005 | Step 00000 | Loss 2.3617 | Train Acc 0.3935 | Speed (samples/sec) 33892.2124 | GPU 17142.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

avg iteration(step) data from cpu to GPU time:18.09975277 ms
avg iteration GPU training time:300.64394864 ms
avg iteration (step) total cpu time:330.74758270 ms
Epoch Time(s): 7.3559
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

Epoch 00006 | Step 00000 | Loss 2.1624 | Train Acc 0.4351 | Speed (samples/sec) 34044.6363 | GPU 17142.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

avg iteration(step) data from cpu to GPU time:18.37978762 ms
avg iteration GPU training time:299.76853804 ms
avg iteration (step) total cpu time:331.61700856 ms
Epoch Time(s): 7.3476
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

Epoch 00007 | Step 00000 | Loss 1.8859 | Train Acc 0.4845 | Speed (samples/sec) 34162.2436 | GPU 17142.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

avg iteration(step) data from cpu to GPU time:18.44100657 ms
avg iteration GPU training time:300.08675593 ms
avg iteration (step) total cpu time:329.75123145 ms
Epoch Time(s): 7.2881
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

Epoch 00008 | Step 00000 | Loss 1.7100 | Train Acc 0.5300 | Speed (samples/sec) 34288.5737 | GPU 17142.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

avg iteration(step) data from cpu to GPU time:17.87893521 ms
avg iteration GPU training time:299.16748879 ms
avg iteration (step) total cpu time:328.98649302 ms
Epoch Time(s): 7.2873
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

Epoch 00009 | Step 00000 | Loss 1.5776 | Train Acc 0.5711 | Speed (samples/sec) 34380.3442 | GPU 17142.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

[2021-06-17 19:40:28,937] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-17 19:40:28,937] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=2655.0601135408538
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

avg iteration(step) data from cpu to GPU time:19.32636521 ms
avg iteration GPU training time:299.35183716 ms
avg iteration (step) total cpu time:330.72621172 ms
Epoch Time(s): 7.3941
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes

Epoch 00010 | Step 00000 | Loss 1.4649 | Train Acc 0.6081 | Speed (samples/sec) 34419.4867 | GPU 17142.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74102544784546  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74102544784546  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16259765625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16259765625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16259765625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.60971052 ms
avg iteration GPU training time:326.97132457 ms
avg iteration (step) total cpu time:356.22059215 ms
Epoch Time(s): 7.6141
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00011 | Step 00000 | Loss 1.3611 | Train Acc 0.6400 | Speed (samples/sec) 34381.2775 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16259765625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16259765625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16259765625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.35375092 ms
avg iteration GPU training time:298.55634655 ms
avg iteration (step) total cpu time:326.95453817 ms
Epoch Time(s): 7.3732
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00012 | Step 00000 | Loss 1.2531 | Train Acc 0.6613 | Speed (samples/sec) 34430.8306 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16259765625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16259765625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16259765625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.39999719 ms
avg iteration GPU training time:302.98429732 ms
avg iteration (step) total cpu time:334.82813835 ms
Epoch Time(s): 7.4452
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00013 | Step 00000 | Loss 1.1797 | Train Acc 0.6791 | Speed (samples/sec) 34444.6610 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12548828125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16259765625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16259765625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.14892578125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.89423110 ms
avg iteration GPU training time:301.72145219 ms
avg iteration (step) total cpu time:333.14611695 ms
Epoch Time(s): 7.4236
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00014 | Step 00000 | Loss 1.1481 | Train Acc 0.6995 | Speed (samples/sec) 34446.8011 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.90930904 ms
avg iteration GPU training time:297.09067050 ms
avg iteration (step) total cpu time:326.49497552 ms
Epoch Time(s): 7.3549
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00015 | Step 00000 | Loss 1.0534 | Train Acc 0.7250 | Speed (samples/sec) 34507.9219 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.56953309 ms
avg iteration GPU training time:298.80859098 ms
avg iteration (step) total cpu time:327.70111344 ms
Epoch Time(s): 7.4118
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00016 | Step 00000 | Loss 1.0008 | Train Acc 0.7391 | Speed (samples/sec) 34548.1012 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.12854975 ms
avg iteration GPU training time:296.53729803 ms
avg iteration (step) total cpu time:325.92396303 ms
Epoch Time(s): 7.4145
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.9743 | Train Acc 0.7486 | Speed (samples/sec) 34597.7674 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.47950849 ms
avg iteration GPU training time:304.06807362 ms
avg iteration (step) total cpu time:333.66337689 ms
Epoch Time(s): 7.4367
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.9248 | Train Acc 0.7642 | Speed (samples/sec) 34594.1563 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.96971928 ms
avg iteration GPU training time:298.28012085 ms
avg iteration (step) total cpu time:333.03256468 ms
Epoch Time(s): 7.3513
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.8882 | Train Acc 0.7724 | Speed (samples/sec) 34597.6043 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

[2021-06-17 19:41:43,081] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 19:41:43,081] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=2618.4390385361817
-----------------------------------------after batch engine step
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.33527842 ms
avg iteration GPU training time:295.05415206 ms
avg iteration (step) total cpu time:324.86807216 ms
Epoch Time(s): 7.3178
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.8457 | Train Acc 0.7853 | Speed (samples/sec) 34631.4879 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.53551674 ms
avg iteration GPU training time:299.67051281 ms
avg iteration (step) total cpu time:330.58348569 ms
Epoch Time(s): 7.3688
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.8087 | Train Acc 0.8041 | Speed (samples/sec) 34651.8724 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.09388560 ms
avg iteration GPU training time:298.10601252 ms
avg iteration (step) total cpu time:328.67555185 ms
Epoch Time(s): 7.3310
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.7726 | Train Acc 0.8097 | Speed (samples/sec) 34659.6613 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.10226926 ms
avg iteration GPU training time:298.22854059 ms
avg iteration (step) total cpu time:330.06908677 ms
Epoch Time(s): 7.4089
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.7319 | Train Acc 0.8259 | Speed (samples/sec) 34659.9772 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.87025434 ms
avg iteration GPU training time:300.60497492 ms
avg iteration (step) total cpu time:331.21477474 ms
Epoch Time(s): 7.4196
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.6983 | Train Acc 0.8296 | Speed (samples/sec) 34671.3903 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.95770194 ms
avg iteration GPU training time:299.40752896 ms
avg iteration (step) total cpu time:329.09672911 ms
Epoch Time(s): 7.3160
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.6967 | Train Acc 0.8357 | Speed (samples/sec) 34674.4338 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:19.05779804 ms
avg iteration GPU training time:295.99054233 ms
avg iteration (step) total cpu time:326.23707164 ms
Epoch Time(s): 7.2952
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.6470 | Train Acc 0.8491 | Speed (samples/sec) 34694.6141 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.50475051 ms
avg iteration GPU training time:298.00511586 ms
avg iteration (step) total cpu time:329.08909971 ms
Epoch Time(s): 7.3559
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.6255 | Train Acc 0.8595 | Speed (samples/sec) 34719.3401 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.72281612 ms
avg iteration GPU training time:298.32917924 ms
avg iteration (step) total cpu time:328.99934595 ms
Epoch Time(s): 7.4460
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.6073 | Train Acc 0.8562 | Speed (samples/sec) 34721.7019 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.19243050 ms
avg iteration GPU training time:302.28574163 ms
avg iteration (step) total cpu time:336.59761602 ms
Epoch Time(s): 7.4289
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.5766 | Train Acc 0.8657 | Speed (samples/sec) 34720.8919 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

[2021-06-17 19:42:56,976] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 19:42:56,976] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=2628.660719765531
-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.74140514 ms
avg iteration GPU training time:302.79272184 ms
avg iteration (step) total cpu time:333.38787339 ms
Epoch Time(s): 7.5238
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.5803 | Train Acc 0.8703 | Speed (samples/sec) 34707.5957 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.38254287 ms
avg iteration GPU training time:303.01493697 ms
avg iteration (step) total cpu time:334.31371776 ms
Epoch Time(s): 7.4298
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.5675 | Train Acc 0.8694 | Speed (samples/sec) 34696.1767 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:19.46388054 ms
avg iteration GPU training time:298.22353849 ms
avg iteration (step) total cpu time:329.92356474 ms
Epoch Time(s): 7.3162
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.5447 | Train Acc 0.8746 | Speed (samples/sec) 34710.4122 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.01116822 ms
avg iteration GPU training time:299.05315330 ms
avg iteration (step) total cpu time:328.94357768 ms
Epoch Time(s): 7.2956
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.5382 | Train Acc 0.8736 | Speed (samples/sec) 34721.5633 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.38233878 ms
avg iteration GPU training time:299.22520308 ms
avg iteration (step) total cpu time:329.58496701 ms
Epoch Time(s): 7.3671
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.5432 | Train Acc 0.8721 | Speed (samples/sec) 34727.9475 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.06287124 ms
avg iteration GPU training time:300.77438909 ms
avg iteration (step) total cpu time:329.66745983 ms
Epoch Time(s): 7.6300
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.5216 | Train Acc 0.8752 | Speed (samples/sec) 34734.2981 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.63527289 ms
avg iteration GPU training time:300.32168302 ms
avg iteration (step) total cpu time:330.65108819 ms
Epoch Time(s): 7.3923
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.5209 | Train Acc 0.8740 | Speed (samples/sec) 34743.6094 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:19.18490479 ms
avg iteration GPU training time:297.60867864 ms
avg iteration (step) total cpu time:329.41913605 ms
Epoch Time(s): 7.4413
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.5042 | Train Acc 0.8826 | Speed (samples/sec) 34742.7385 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.35730310 ms
avg iteration GPU training time:297.39326061 ms
avg iteration (step) total cpu time:326.31531629 ms
Epoch Time(s): 7.3925
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.4889 | Train Acc 0.8821 | Speed (samples/sec) 34746.5506 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.83625603 ms
avg iteration GPU training time:297.82639660 ms
avg iteration (step) total cpu time:328.27767459 ms
Epoch Time(s): 7.3137
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.5051 | Train Acc 0.8771 | Speed (samples/sec) 34759.4437 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

[2021-06-17 19:44:10,874] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 19:44:10,874] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=2626.6052826494224
-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.14117501 ms
avg iteration GPU training time:299.28335849 ms
avg iteration (step) total cpu time:329.87375693 ms
Epoch Time(s): 7.3184
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.4730 | Train Acc 0.8856 | Speed (samples/sec) 34765.6870 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:19.65128760 ms
avg iteration GPU training time:304.50284646 ms
avg iteration (step) total cpu time:336.27776666 ms
Epoch Time(s): 7.4975
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.4877 | Train Acc 0.8805 | Speed (samples/sec) 34751.1424 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.38899474 ms
avg iteration GPU training time:297.13416915 ms
avg iteration (step) total cpu time:326.36885210 ms
Epoch Time(s): 7.2767
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.4714 | Train Acc 0.8867 | Speed (samples/sec) 34765.0699 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.45286664 ms
avg iteration GPU training time:303.66840154 ms
avg iteration (step) total cpu time:334.39629728 ms
Epoch Time(s): 8.0618
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.4594 | Train Acc 0.8885 | Speed (samples/sec) 34746.2611 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:19.40562040 ms
avg iteration GPU training time:296.34546453 ms
avg iteration (step) total cpu time:329.30231094 ms
Epoch Time(s): 7.6617
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.4476 | Train Acc 0.8899 | Speed (samples/sec) 34739.3688 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.30548928 ms
avg iteration GPU training time:314.83587924 ms
avg iteration (step) total cpu time:345.30117295 ms
Epoch Time(s): 7.7387
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.4577 | Train Acc 0.8874 | Speed (samples/sec) 34701.0538 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16455078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15283203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12939453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.16650390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.12744140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.15087890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.52514024 ms
avg iteration GPU training time:296.71927712 ms
avg iteration (step) total cpu time:328.71441408 ms
Epoch Time(s): 7.5974
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.4506 | Train Acc 0.8940 | Speed (samples/sec) 34705.8969 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.17728597 ms
avg iteration GPU training time:298.18975553 ms
avg iteration (step) total cpu time:328.61098376 ms
Epoch Time(s): 7.4445
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.4282 | Train Acc 0.8932 | Speed (samples/sec) 34705.1680 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:19.63702427 ms
avg iteration GPU training time:296.56965498 ms
avg iteration (step) total cpu time:327.75558125 ms
Epoch Time(s): 7.4894
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.4304 | Train Acc 0.8925 | Speed (samples/sec) 34717.0600 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.71371078 ms
avg iteration GPU training time:296.41158780 ms
avg iteration (step) total cpu time:326.77004554 ms
Epoch Time(s): 7.4928
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.4216 | Train Acc 0.8959 | Speed (samples/sec) 34717.6623 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

[2021-06-17 19:45:26,735] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 19:45:26,735] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=2620.9816012387
-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.30973088 ms
avg iteration GPU training time:299.12151545 ms
avg iteration (step) total cpu time:329.22456481 ms
Epoch Time(s): 7.5993
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.4257 | Train Acc 0.8951 | Speed (samples/sec) 34713.5890 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.52832569 ms
avg iteration GPU training time:294.29404241 ms
avg iteration (step) total cpu time:323.87200269 ms
Epoch Time(s): 7.4085
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.4217 | Train Acc 0.8958 | Speed (samples/sec) 34723.2391 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.13308803 ms
avg iteration GPU training time:318.08674760 ms
avg iteration (step) total cpu time:347.90041230 ms
Epoch Time(s): 7.6986
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.4121 | Train Acc 0.8989 | Speed (samples/sec) 34697.5211 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:19.15307635 ms
avg iteration GPU training time:302.05703458 ms
avg iteration (step) total cpu time:333.37753469 ms
Epoch Time(s): 7.6620
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.3986 | Train Acc 0.8979 | Speed (samples/sec) 34686.4398 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.62254247 ms
avg iteration GPU training time:303.49325839 ms
avg iteration (step) total cpu time:334.90423723 ms
Epoch Time(s): 7.5494
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.4081 | Train Acc 0.8956 | Speed (samples/sec) 34682.9310 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:21.10277211 ms
avg iteration GPU training time:297.92745139 ms
avg iteration (step) total cpu time:332.85444433 ms
Epoch Time(s): 7.6389
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.4164 | Train Acc 0.8958 | Speed (samples/sec) 34676.0743 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:19.87171208 ms
avg iteration GPU training time:303.96601729 ms
avg iteration (step) total cpu time:336.07365868 ms
Epoch Time(s): 7.7453
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.3758 | Train Acc 0.9052 | Speed (samples/sec) 34659.4067 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.96394747 ms
avg iteration GPU training time:298.42657748 ms
avg iteration (step) total cpu time:330.33074032 ms
Epoch Time(s): 7.5209
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.3882 | Train Acc 0.9015 | Speed (samples/sec) 34664.6141 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.63758226 ms
avg iteration GPU training time:297.69008290 ms
avg iteration (step) total cpu time:329.50910655 ms
Epoch Time(s): 7.5785
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.3934 | Train Acc 0.8989 | Speed (samples/sec) 34662.5909 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.10235630 ms
avg iteration GPU training time:296.98367587 ms
avg iteration (step) total cpu time:327.54237002 ms
Epoch Time(s): 7.4511
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.4116 | Train Acc 0.8939 | Speed (samples/sec) 34666.5176 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

[2021-06-17 19:46:42,880] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 19:46:42,881] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=2617.6375993139795
-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.97339058 ms
avg iteration GPU training time:323.06251942 ms
avg iteration (step) total cpu time:353.67304629 ms
Epoch Time(s): 7.8914
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.4344 | Train Acc 0.8906 | Speed (samples/sec) 34632.8283 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:19.52544299 ms
avg iteration GPU training time:294.70532504 ms
avg iteration (step) total cpu time:326.14254951 ms
Epoch Time(s): 7.5696
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.4342 | Train Acc 0.8918 | Speed (samples/sec) 34637.8219 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.98731370 ms
avg iteration GPU training time:314.36495694 ms
avg iteration (step) total cpu time:344.41668337 ms
Epoch Time(s): 7.7715
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.4010 | Train Acc 0.9002 | Speed (samples/sec) 34617.4204 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.09285823 ms
avg iteration GPU training time:296.30323375 ms
avg iteration (step) total cpu time:330.35536246 ms
Epoch Time(s): 7.4582
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.4049 | Train Acc 0.8957 | Speed (samples/sec) 34625.6149 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.63280314 ms
avg iteration GPU training time:296.22645985 ms
avg iteration (step) total cpu time:325.53475553 ms
Epoch Time(s): 7.4552
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.3956 | Train Acc 0.8985 | Speed (samples/sec) 34634.0539 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.02591705 ms
avg iteration GPU training time:299.85515525 ms
avg iteration (step) total cpu time:329.69431444 ms
Epoch Time(s): 7.5083
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.3845 | Train Acc 0.9010 | Speed (samples/sec) 34639.3126 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.90227500 ms
avg iteration GPU training time:315.53790561 ms
avg iteration (step) total cpu time:346.75234014 ms
Epoch Time(s): 7.8240
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.3936 | Train Acc 0.9019 | Speed (samples/sec) 34617.2289 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.09151979 ms
avg iteration GPU training time:324.68651234 ms
avg iteration (step) total cpu time:354.85532067 ms
Epoch Time(s): 7.8894
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.3699 | Train Acc 0.9069 | Speed (samples/sec) 34585.6036 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.78947206 ms
avg iteration GPU training time:296.33783791 ms
avg iteration (step) total cpu time:327.46546919 ms
Epoch Time(s): 7.4342
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.3745 | Train Acc 0.9051 | Speed (samples/sec) 34589.0015 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.80030840 ms
avg iteration GPU training time:295.81326571 ms
avg iteration (step) total cpu time:326.49020715 ms
Epoch Time(s): 7.4543
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.3700 | Train Acc 0.9069 | Speed (samples/sec) 34594.3992 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

[2021-06-17 19:47:58,738] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 19:47:58,738] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=2618.7792272357688
-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.74218178 ms
avg iteration GPU training time:300.84688776 ms
avg iteration (step) total cpu time:331.88325709 ms
Epoch Time(s): 7.4921
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.3737 | Train Acc 0.9023 | Speed (samples/sec) 34598.2864 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.92667320 ms
avg iteration GPU training time:333.30778642 ms
avg iteration (step) total cpu time:363.06506937 ms
Epoch Time(s): 7.9750
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.3652 | Train Acc 0.9053 | Speed (samples/sec) 34558.3499 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.71802157 ms
avg iteration GPU training time:306.74981412 ms
avg iteration (step) total cpu time:337.84385161 ms
Epoch Time(s): 7.5483
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.3636 | Train Acc 0.9063 | Speed (samples/sec) 34554.5822 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.44438969 ms
avg iteration GPU training time:301.26314475 ms
avg iteration (step) total cpu time:331.78121393 ms
Epoch Time(s): 7.5654
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.3561 | Train Acc 0.9067 | Speed (samples/sec) 34549.7979 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:19.69581396 ms
avg iteration GPU training time:300.13012695 ms
avg iteration (step) total cpu time:331.85213262 ms
Epoch Time(s): 7.5606
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.3450 | Train Acc 0.9098 | Speed (samples/sec) 34552.6192 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.00091917 ms
avg iteration GPU training time:320.29351529 ms
avg iteration (step) total cpu time:350.03605756 ms
Epoch Time(s): 7.8757
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.3591 | Train Acc 0.9109 | Speed (samples/sec) 34533.0526 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05322265625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.52109684 ms
avg iteration GPU training time:330.26517833 ms
avg iteration (step) total cpu time:361.01573164 ms
Epoch Time(s): 7.9475
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.3566 | Train Acc 0.9050 | Speed (samples/sec) 34501.5031 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.31818164 ms
avg iteration GPU training time:327.27363170 ms
avg iteration (step) total cpu time:356.91996054 ms
Epoch Time(s): 7.9450
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.3422 | Train Acc 0.9115 | Speed (samples/sec) 34472.5204 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.46561727 ms
avg iteration GPU training time:330.00410323 ms
avg iteration (step) total cpu time:360.23345861 ms
Epoch Time(s): 7.9940
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.3556 | Train Acc 0.9067 | Speed (samples/sec) 34443.3583 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:19.65582258 ms
avg iteration GPU training time:300.83994640 ms
avg iteration (step) total cpu time:332.66425133 ms
Epoch Time(s): 8.0398
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.3481 | Train Acc 0.9082 | Speed (samples/sec) 34448.3168 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

[2021-06-17 19:49:16,823] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 19:49:16,823] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=2613.2135145156717
-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.86164076 ms
avg iteration GPU training time:296.24627963 ms
avg iteration (step) total cpu time:327.37432827 ms
Epoch Time(s): 7.6329
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.3442 | Train Acc 0.9124 | Speed (samples/sec) 34447.5878 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.40788078 ms
avg iteration GPU training time:302.88603904 ms
avg iteration (step) total cpu time:332.35441555 ms
Epoch Time(s): 7.5382
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.3572 | Train Acc 0.9047 | Speed (samples/sec) 34449.5946 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05322265625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.19460089 ms
avg iteration GPU training time:322.49071988 ms
avg iteration (step) total cpu time:352.02659260 ms
Epoch Time(s): 7.8052
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.3539 | Train Acc 0.9061 | Speed (samples/sec) 34438.0286 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:19.48667058 ms
avg iteration GPU training time:298.68592696 ms
avg iteration (step) total cpu time:330.43900403 ms
Epoch Time(s): 7.3985
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.3769 | Train Acc 0.9002 | Speed (samples/sec) 34439.7140 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.61469685 ms
avg iteration GPU training time:321.53446544 ms
avg iteration (step) total cpu time:351.90179131 ms
Epoch Time(s): 7.7826
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.3749 | Train Acc 0.9019 | Speed (samples/sec) 34420.2255 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.39126968 ms
avg iteration GPU training time:304.59148892 ms
avg iteration (step) total cpu time:335.15596390 ms
Epoch Time(s): 7.4522
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.3458 | Train Acc 0.9065 | Speed (samples/sec) 34421.6994 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.54773816 ms
avg iteration GPU training time:304.10669778 ms
avg iteration (step) total cpu time:333.57945356 ms
Epoch Time(s): 7.3742
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.3732 | Train Acc 0.8997 | Speed (samples/sec) 34424.7619 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.97964512 ms
avg iteration GPU training time:308.94233842 ms
avg iteration (step) total cpu time:339.50482715 ms
Epoch Time(s): 7.4965
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.3573 | Train Acc 0.9047 | Speed (samples/sec) 34421.0708 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.38139326 ms
avg iteration GPU training time:296.21607555 ms
avg iteration (step) total cpu time:327.06473090 ms
Epoch Time(s): 7.4041
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.3485 | Train Acc 0.9055 | Speed (samples/sec) 34427.0541 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.28819760 ms
avg iteration GPU training time:296.77582619 ms
avg iteration (step) total cpu time:327.21194354 ms
Epoch Time(s): 7.3694
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.3373 | Train Acc 0.9106 | Speed (samples/sec) 34435.7002 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

[2021-06-17 19:50:31,990] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 19:50:31,991] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=2613.663867357817
-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.76072693 ms
avg iteration GPU training time:304.69222190 ms
avg iteration (step) total cpu time:335.48493819 ms
Epoch Time(s): 7.5457
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.3382 | Train Acc 0.9150 | Speed (samples/sec) 34429.8222 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.46849442 ms
avg iteration GPU training time:299.06027222 ms
avg iteration (step) total cpu time:328.11776074 ms
Epoch Time(s): 7.3951
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.3459 | Train Acc 0.9076 | Speed (samples/sec) 34436.1007 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05322265625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.93247119 ms
avg iteration GPU training time:302.19885531 ms
avg iteration (step) total cpu time:337.56364476 ms
Epoch Time(s): 7.5304
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.3484 | Train Acc 0.9072 | Speed (samples/sec) 34435.6404 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.74912262 ms
avg iteration GPU training time:299.64860396 ms
avg iteration (step) total cpu time:330.77827367 ms
Epoch Time(s): 7.4179
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.3262 | Train Acc 0.9152 | Speed (samples/sec) 34436.3116 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.81752760 ms
avg iteration GPU training time:298.11990356 ms
avg iteration (step) total cpu time:328.82865992 ms
Epoch Time(s): 7.2941
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.3362 | Train Acc 0.9130 | Speed (samples/sec) 34444.2735 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.35411462 ms
avg iteration GPU training time:308.80236816 ms
avg iteration (step) total cpu time:339.78746154 ms
Epoch Time(s): 7.5113
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.3195 | Train Acc 0.9173 | Speed (samples/sec) 34440.7756 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.27611039 ms
avg iteration GPU training time:299.31640070 ms
avg iteration (step) total cpu time:329.33670824 ms
Epoch Time(s): 7.4791
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.3314 | Train Acc 0.9102 | Speed (samples/sec) 34443.1893 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.66624537 ms
avg iteration GPU training time:296.82094227 ms
avg iteration (step) total cpu time:330.58821071 ms
Epoch Time(s): 7.3754
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.3241 | Train Acc 0.9150 | Speed (samples/sec) 34449.9854 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.18499791 ms
avg iteration GPU training time:299.36048473 ms
avg iteration (step) total cpu time:329.68111472 ms
Epoch Time(s): 7.3965
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.3241 | Train Acc 0.9128 | Speed (samples/sec) 34457.3732 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:18.09227337 ms
avg iteration GPU training time:302.12912820 ms
avg iteration (step) total cpu time:332.92679353 ms
Epoch Time(s): 7.4486
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.3298 | Train Acc 0.9147 | Speed (samples/sec) 34458.6601 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.04931640625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

[2021-06-17 19:51:46,236] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 19:51:46,236] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=2610.4004146511697
-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:17.91037958 ms
avg iteration GPU training time:302.70666226 ms
avg iteration (step) total cpu time:332.48810335 ms
Epoch Time(s): 7.3965
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.3309 | Train Acc 0.9104 | Speed (samples/sec) 34462.9698 | GPU 17172.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.03955078125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00439453125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02783203125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04150390625GB

Max Memory Allocated 16.770262718200684  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 20.00244140625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 20.02587890625GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 20.05126953125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 20.04345703125GB

Max Memory Allocated 16.770262718200684  GigaBytes

avg iteration(step) data from cpu to GPU time:19.62539621 ms
avg iteration GPU training time:297.01876831 ms
avg iteration (step) total cpu time:329.02997190 ms
Epoch Time(s): 7.4127
Eval Acc 0.9046
Test Acc: 0.7520
Avg epoch time(time.time()): 7514.336658020814 ms
total avg iteration(step) data from cpu to GPU time:18.36438683 ms
total avg iteration GPU training time:303.34552430 ms
total avg iteration (step) total cpu time:334.13684186 ms
