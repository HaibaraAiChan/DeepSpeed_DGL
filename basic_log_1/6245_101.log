[2021-06-17 21:45:33,557] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-17 21:45:37,201] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 ds_mini_batch_train.py --aggre lstm --batch-size 6245 --log-every 120 --deepspeed_config ds_config.json
[2021-06-17 21:45:38,174] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-17 21:45:38,174] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-17 21:45:38,174] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-17 21:45:38,174] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-17 21:45:38,174] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623966343.6256316
before load_ogb step Time(s): 0.0017
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20668.84765625, 'VmSize': 20541.86328125, 'VmHWM': 1165.67578125, 'VmRSS': 1165.67578125}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.5826
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2815
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0013
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0961
-------------------------------------------------end of load ogb****************** step Time(s): 0.0021
finish constructing ogbn-products
load ogb-products time total: 1.9638519287109375
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 1.9646
after inductive else step Time(s): 0.0000
after label step Time(s): 3.7258
after train_g.create_formats_() step Time(s): 1.6925
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 6245
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-17 21:45:51,041] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.4.1+unknown, git-hash=unknown, git-branch=unknown
[2021-06-17 21:45:51,041] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-17 21:45:51,045] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-17 21:45:53,389] [INFO] [engine.py:173:__init__] DeepSpeed Flops Profiler Enabled: False
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/cc/.cache/torch_extensions/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 1.2554988861083984 seconds
[2021-06-17 21:45:55,873] [INFO] [engine.py:693:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-17 21:45:55,873] [INFO] [engine.py:697:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-17 21:45:55,874] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-17 21:45:55,874] [INFO] [engine.py:505:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-17 21:45:55,874] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f4cc12a7198>
[2021-06-17 21:45:55,874] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:45:55,874] [INFO] [config.py:900:print] DeepSpeedEngine configuration:
[2021-06-17 21:45:55,874] [INFO] [config.py:904:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-17 21:45:55,874] [INFO] [config.py:904:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-17 21:45:55,874] [INFO] [config.py:904:print]   allreduce_always_fp32 ........ False
[2021-06-17 21:45:55,874] [INFO] [config.py:904:print]   amp_enabled .................. False
[2021-06-17 21:45:55,874] [INFO] [config.py:904:print]   amp_params ................... False
[2021-06-17 21:45:55,874] [INFO] [config.py:904:print]   checkpoint_tag_validation_enabled  True
[2021-06-17 21:45:55,874] [INFO] [config.py:904:print]   checkpoint_tag_validation_fail  False
[2021-06-17 21:45:55,874] [INFO] [config.py:904:print]   disable_allgather ............ False
[2021-06-17 21:45:55,874] [INFO] [config.py:904:print]   dump_state ................... False
[2021-06-17 21:45:55,874] [INFO] [config.py:904:print]   dynamic_loss_scale_args ...... None
[2021-06-17 21:45:55,874] [INFO] [config.py:904:print]   eigenvalue_enabled ........... False
[2021-06-17 21:45:55,874] [INFO] [config.py:904:print]   eigenvalue_gas_boundary_resolution  1
[2021-06-17 21:45:55,874] [INFO] [config.py:904:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2021-06-17 21:45:55,874] [INFO] [config.py:904:print]   eigenvalue_layer_num ......... 0
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   eigenvalue_max_iter .......... 100
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   eigenvalue_stability ......... 1e-06
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   eigenvalue_tol ............... 0.01
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   eigenvalue_verbose ........... False
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   elasticity_enabled ........... False
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   fp16_enabled ................. False
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   fp16_mixed_quantize .......... False
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   global_rank .................. 0
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   gradient_accumulation_steps .. 1
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   gradient_clipping ............ 0.0
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   gradient_predivide_factor .... 1.0
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   initial_dynamic_scale ........ 4294967296
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   loss_scale ................... 0
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   memory_breakdown ............. False
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   optimizer_legacy_fusion ...... False
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   optimizer_name ............... adam
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   pld_enabled .................. False
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   pld_params ................... False
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   prescale_gradients ........... False
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   quantize_change_rate ......... 0.001
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   quantize_groups .............. 1
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   quantize_offset .............. 1000
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   quantize_period .............. 1000
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   quantize_rounding ............ 0
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   quantize_start_bits .......... 16
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   quantize_target_bits ......... 8
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   quantize_training_enabled .... False
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   quantize_type ................ 0
[2021-06-17 21:45:55,875] [INFO] [config.py:904:print]   quantize_verbose ............. False
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   scheduler_name ............... WarmupLR
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   sparse_attention ............. None
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   sparse_gradients_enabled ..... False
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   steps_per_print .............. 10
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   tensorboard_enabled .......... False
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   tensorboard_output_path ...... 
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   train_batch_size ............. 1500
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   train_micro_batch_size_per_gpu  1500
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   use_quantizer_kernel ......... False
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   wall_clock_breakdown ......... False
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   world_size ................... 1
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   zero_allow_untested_optimizer  False
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": true, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true, 
    "legacy_stage1": false
}
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   zero_enabled ................. False
[2021-06-17 21:45:55,876] [INFO] [config.py:904:print]   zero_optimization_stage ...... 0
[2021-06-17 21:45:55,878] [INFO] [config.py:912:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Emitting ninja build file /home/cc/.cache/torch_extensions/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 1.348154067993164 seconds
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.58837890625GB

Max Memory Allocated 1.1886367797851562  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.66259765625GB

Max Memory Allocated 1.1886367797851562  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 11.62158203125GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 11.62158203125GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 11.63330078125GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 11.63330078125GB

Max Memory Allocated 9.886034488677979  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7272 | Train Acc 0.0288 | Speed (samples/sec) nan | GPU 10123.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 11.60986328125GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 11.60986328125GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 11.62353515625GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.12744140625GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.12744140625GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.12744140625GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.12744140625GB

Max Memory Allocated 9.886034488677979  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.10400390625GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.10400390625GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.11572265625GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.12939453125GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.12548828125GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.12744140625GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.12744140625GB

Max Memory Allocated 9.886034488677979  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.10400390625GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.10400390625GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.11572265625GB

Max Memory Allocated 9.886034488677979  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.13525390625GB

Max Memory Allocated 9.889754295349121  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.13330078125GB

Max Memory Allocated 9.889754295349121  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.13330078125GB

Max Memory Allocated 9.889754295349121  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.13330078125GB

Max Memory Allocated 9.889754295349121  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.10986328125GB

Max Memory Allocated 9.889754295349121  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.10986328125GB

Max Memory Allocated 9.889754295349121  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.12158203125GB

Max Memory Allocated 9.889754295349121  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.13330078125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.13134765625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.13134765625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.13134765625GB

Max Memory Allocated 9.890069961547852  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.11767578125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.12939453125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.12744140625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.12744140625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.12744140625GB

Max Memory Allocated 9.890069961547852  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.10400390625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.10400390625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.11767578125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.13330078125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.13134765625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.13134765625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.13134765625GB

Max Memory Allocated 9.890069961547852  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.10791015625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.10791015625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.11962890625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.13330078125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.12939453125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.12939453125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.12939453125GB

Max Memory Allocated 9.890069961547852  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.11767578125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.13134765625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.12939453125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.13134765625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.13134765625GB

Max Memory Allocated 9.890069961547852  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.10791015625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.10791015625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.11962890625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.13330078125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.12939453125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.13134765625GB

Max Memory Allocated 9.890069961547852  GigaBytes

[2021-06-17 21:46:01,956] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-17 21:46:01,990] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=6229.326257241834
-----------------------------------------after batch engine step
 Nvidia-smi: 12.13134765625GB

Max Memory Allocated 9.890069961547852  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.10791015625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.10791015625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.11962890625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.13134765625GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.12939453125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.12939453125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.12939453125GB

Max Memory Allocated 9.890069961547852  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.11767578125GB

Max Memory Allocated 9.890069961547852  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10595703125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10595703125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10791015625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10595703125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11572265625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11572265625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11572265625GB

Max Memory Allocated 9.89038610458374  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10595703125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11572265625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11572265625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11572265625GB

Max Memory Allocated 9.89038610458374  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10595703125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10791015625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10595703125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes

[2021-06-17 21:46:04,517] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:04,546] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=6339.217070121198
-----------------------------------------after batch engine step
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10791015625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.89038610458374  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10595703125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11376953125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11572265625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11572265625GB

Max Memory Allocated 9.89038610458374  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10595703125GB

Max Memory Allocated 9.89038610458374  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11572265625GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.891383647918701  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10595703125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11572265625GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11572265625GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11572265625GB

Max Memory Allocated 9.891383647918701  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10595703125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.891383647918701  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10791015625GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.891383647918701  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10595703125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.891383647918701  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10595703125GB

Max Memory Allocated 9.891383647918701  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.894017219543457  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894017219543457  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes

[2021-06-17 21:46:06,998] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:07,032] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=6415.195498370316
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.894017219543457  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.894017219543457  GigaBytes

avg iteration(step) data from cpu to GPU time:9.90291325 ms
avg iteration GPU training time:232.15888355 ms
avg iteration (step) total cpu time:252.44774642 ms
Epoch Time(s): 10.4512
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07080078125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08447265625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894017219543457  GigaBytes

Epoch 00001 | Step 00000 | Loss 0.6003 | Train Acc 0.8586 | Speed (samples/sec) 23627.4031 | GPU 10131.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.894017219543457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.894017219543457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894017219543457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.894017219543457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894158363342285  GigaBytes

[2021-06-17 21:46:11,254] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:11,289] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=6328.3616729902105
-----------------------------------------after batch engine step
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894158363342285  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.894158363342285  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894158363342285  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894158363342285  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.894158363342285  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.894158363342285  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

[2021-06-17 21:46:13,734] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:13,768] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=6375.165778332159
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.89478588104248  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

[2021-06-17 21:46:16,142] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:16,177] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=6440.313065643957
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.89478588104248  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08447265625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.89478588104248  GigaBytes

avg iteration(step) data from cpu to GPU time:9.69584945 ms
avg iteration GPU training time:228.06903811 ms
avg iteration (step) total cpu time:246.99389493 ms
Epoch Time(s): 9.7711
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08447265625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.89478588104248  GigaBytes

Epoch 00002 | Step 00000 | Loss 0.4206 | Train Acc 0.8919 | Speed (samples/sec) 23681.1374 | GPU 10132.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07275390625GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.89478588104248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

[2021-06-17 21:46:20,302] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:20,336] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=6368.210922446318
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

[2021-06-17 21:46:22,894] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:22,928] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=6355.837373186599
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.899620056152344  GigaBytes

[2021-06-17 21:46:25,376] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:25,409] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=6380.0179719715925
-----------------------------------------after batch engine step
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.899620056152344  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.899620056152344  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

avg iteration(step) data from cpu to GPU time:9.51253102 ms
avg iteration GPU training time:233.07922872 ms
avg iteration (step) total cpu time:252.10562459 ms
Epoch Time(s): 9.6529
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.3917 | Train Acc 0.9001 | Speed (samples/sec) 23582.8690 | GPU 10143.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:46:29,372] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:29,402] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=6375.942508144581
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:46:31,987] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:32,020] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=6360.2870261975095
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:46:34,622] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:34,656] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=6343.496106755929
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

avg iteration(step) data from cpu to GPU time:10.16281114 ms
avg iteration GPU training time:237.37996024 ms
avg iteration (step) total cpu time:257.03829306 ms
Epoch Time(s): 9.7406
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.4029 | Train Acc 0.8953 | Speed (samples/sec) 23466.9759 | GPU 10143.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:46:38,575] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:38,609] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=6353.457505614596
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:46:41,267] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:41,301] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=6332.493402280043
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:46:43,963] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:43,997] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=6310.340589600544
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:46:46,500] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:46,513] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=6318.373912445057
-----------------------------------------after batch engine step
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

avg iteration(step) data from cpu to GPU time:10.31172620 ms
avg iteration GPU training time:243.33560689 ms
avg iteration (step) total cpu time:263.25729158 ms
Epoch Time(s): 9.8958
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.3547 | Train Acc 0.9034 | Speed (samples/sec) 23315.1289 | GPU 10143.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:46:50,503] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:50,536] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=6317.541240595656
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:46:53,140] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:53,173] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=6307.710544835127
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:46:55,795] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:55,828] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=6296.731254074358
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09619140625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

avg iteration(step) data from cpu to GPU time:9.45138253 ms
avg iteration GPU training time:244.16074569 ms
avg iteration (step) total cpu time:263.02704105 ms
Epoch Time(s): 9.8398
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.3445 | Train Acc 0.9044 | Speed (samples/sec) 23251.7896 | GPU 10143.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:46:59,921] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:46:59,955] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=6285.249157738321
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:47:02,358] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:02,392] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=6303.798412998527
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:47:04,802] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:04,837] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=6320.189028910065
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

avg iteration(step) data from cpu to GPU time:9.14215704 ms
avg iteration GPU training time:223.72870438 ms
avg iteration (step) total cpu time:242.61124046 ms
Epoch Time(s): 9.4014
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.3334 | Train Acc 0.9110 | Speed (samples/sec) 23385.4998 | GPU 10143.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:47:08,890] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:08,924] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=6309.688592387669
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:47:11,473] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:11,507] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=6307.50069163329
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:47:14,092] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:14,126] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=6303.721084025791
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

avg iteration(step) data from cpu to GPU time:9.46314072 ms
avg iteration GPU training time:239.62176740 ms
avg iteration (step) total cpu time:258.35096395 ms
Epoch Time(s): 9.8625
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.3144 | Train Acc 0.9139 | Speed (samples/sec) 23317.7062 | GPU 10143.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:47:18,034] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:18,068] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=6309.851663277393
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:47:20,478] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:20,512] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=6323.265161802173
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

[2021-06-17 21:47:23,042] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:23,075] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=6324.2820952183665
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.905794143676758  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.905794143676758  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

avg iteration(step) data from cpu to GPU time:9.67328476 ms
avg iteration GPU training time:233.32807018 ms
avg iteration (step) total cpu time:252.19794556 ms
Epoch Time(s): 9.5201
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.3141 | Train Acc 0.9196 | Speed (samples/sec) 23370.5248 | GPU 10145.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes

[2021-06-17 21:47:27,152] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:27,186] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=6316.416350011126
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

[2021-06-17 21:47:29,949] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:29,983] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=6297.398017673837
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

[2021-06-17 21:47:32,720] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:32,754] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=6282.3449272830885
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

[2021-06-17 21:47:35,292] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:35,305] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=6284.906751651482
-----------------------------------------after batch engine step
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

avg iteration(step) data from cpu to GPU time:10.34593550 ms
avg iteration GPU training time:249.16638523 ms
avg iteration (step) total cpu time:269.44598445 ms
Epoch Time(s): 10.1754
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.3141 | Train Acc 0.9158 | Speed (samples/sec) 23238.6608 | GPU 10145.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09814453125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

[2021-06-17 21:47:39,412] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:39,445] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=6279.257737793041
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

[2021-06-17 21:47:42,115] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:42,149] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=6270.524432887598
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10791015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

[2021-06-17 21:47:44,752] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:44,785] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=6267.240427528102
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

avg iteration(step) data from cpu to GPU time:9.30042429 ms
avg iteration GPU training time:242.92696183 ms
avg iteration (step) total cpu time:262.34100483 ms
Epoch Time(s): 9.9891
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07470703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08642578125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.3132 | Train Acc 0.9127 | Speed (samples/sec) 23189.2667 | GPU 10145.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10009765625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

[2021-06-17 21:47:49,017] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:49,050] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=6253.724658857418
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

[2021-06-17 21:47:51,596] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:51,629] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=6254.743730682997
-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07666015625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.08837890625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08251953125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09423828125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10595703125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.08056640625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09228515625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.10400390625GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.10205078125GB

Max Memory Allocated 9.907367706298828  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.07861328125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.09033203125GB

Max Memory Allocated 9.907367706298828  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

[2021-06-17 21:47:54,193] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:54,227] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=6254.4316179864445
-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58837890625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60205078125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

avg iteration(step) data from cpu to GPU time:9.16221043 ms
avg iteration GPU training time:241.64133708 ms
avg iteration (step) total cpu time:260.21571513 ms
Epoch Time(s): 9.8714
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.3218 | Train Acc 0.9151 | Speed (samples/sec) 23157.1498 | GPU 10147.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

[2021-06-17 21:47:58,255] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:47:58,289] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=6251.06719430667
-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60205078125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60205078125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58837890625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

[2021-06-17 21:48:00,823] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:00,857] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=6252.719569617633
-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.909751415252686  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.909751415252686  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

[2021-06-17 21:48:03,412] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:03,446] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=6254.97906243175
-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60205078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59033203125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58837890625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58837890625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58837890625GB

Max Memory Allocated 9.912016868591309  GigaBytes

avg iteration(step) data from cpu to GPU time:9.92866362 ms
avg iteration GPU training time:233.39118618 ms
avg iteration (step) total cpu time:253.35869966 ms
Epoch Time(s): 9.6861
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.3153 | Train Acc 0.9188 | Speed (samples/sec) 23164.3538 | GPU 10149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

[2021-06-17 21:48:07,382] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:07,416] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=6256.7657216961925
-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60205078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60205078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58837890625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60205078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

[2021-06-17 21:48:10,013] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:10,047] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=6255.138476015729
-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

[2021-06-17 21:48:12,630] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:12,664] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=6254.937447396161
-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59033203125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

avg iteration(step) data from cpu to GPU time:9.96147195 ms
avg iteration GPU training time:238.23090391 ms
avg iteration (step) total cpu time:257.62325746 ms
Epoch Time(s): 9.7914
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.3231 | Train Acc 0.9127 | Speed (samples/sec) 23145.0082 | GPU 10149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

[2021-06-17 21:48:16,618] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:16,652] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=6254.77923112913
-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60205078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58837890625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60205078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60205078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60205078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

[2021-06-17 21:48:19,242] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:19,276] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=6252.675459673344
-----------------------------------------after batch engine step
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

[2021-06-17 21:48:21,818] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:21,851] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=6253.673655581871
-----------------------------------------after batch engine step
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58837890625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60205078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58837890625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60205078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59033203125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

[2021-06-17 21:48:24,221] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:24,234] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=6264.8293611763065
-----------------------------------------after batch engine step
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

avg iteration(step) data from cpu to GPU time:9.16507850 ms
avg iteration GPU training time:230.85626899 ms
avg iteration (step) total cpu time:249.51889780 ms
Epoch Time(s): 9.6035
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.3112 | Train Acc 0.9151 | Speed (samples/sec) 23178.0342 | GPU 10149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

[2021-06-17 21:48:28,305] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:28,339] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=6261.67229158858
-----------------------------------------after batch engine step
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

[2021-06-17 21:48:30,887] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:30,921] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=6262.622671436398
-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

[2021-06-17 21:48:33,430] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:33,464] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=6265.100006889914
-----------------------------------------after batch engine step
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57275390625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.57861328125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

avg iteration(step) data from cpu to GPU time:9.93195023 ms
avg iteration GPU training time:235.61308119 ms
avg iteration (step) total cpu time:255.25123102 ms
Epoch Time(s): 9.6469
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58251953125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59228515625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59423828125GB

Max Memory Allocated 9.912016868591309  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.2953 | Train Acc 0.9188 | Speed (samples/sec) 23188.5735 | GPU 10149.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57080078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58447265625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57666015625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58837890625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60009765625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59619140625GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.60205078125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.59814453125GB

Max Memory Allocated 9.912016868591309  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.57470703125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.58642578125GB

Max Memory Allocated 9.912016868591309  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:48:37,340] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:37,374] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=6269.724927637635
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:48:39,934] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:39,968] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=6269.887432858737
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:48:42,582] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:42,616] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=6269.072625766242
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.48941856 ms
avg iteration GPU training time:237.90592957 ms
avg iteration (step) total cpu time:258.65485933 ms
Epoch Time(s): 9.6807
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.3074 | Train Acc 0.9159 | Speed (samples/sec) 23187.5239 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:48:46,635] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:46,669] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=6268.131721393064
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:48:49,204] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:49,238] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=6269.49018945381
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:48:51,837] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:51,871] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=6267.546776624153
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.89301219 ms
avg iteration GPU training time:237.13900813 ms
avg iteration (step) total cpu time:256.30880285 ms
Epoch Time(s): 9.7843
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.3016 | Train Acc 0.9166 | Speed (samples/sec) 23183.0219 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:48:55,899] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:55,934] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=6265.822099012556
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:48:58,551] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:48:58,585] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=6263.280112474026
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:01,068] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:01,102] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=6266.654603594589
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.51351470 ms
avg iteration GPU training time:238.51085578 ms
avg iteration (step) total cpu time:257.38739084 ms
Epoch Time(s): 9.7795
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.2891 | Train Acc 0.9241 | Speed (samples/sec) 23176.3461 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:05,098] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:05,132] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=6266.863662259698
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:07,758] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:07,792] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=6263.980176041612
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:10,351] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:10,385] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=6263.911486573454
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08251953125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:12,916] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:12,929] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=6265.127538017665
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.22538076 ms
avg iteration GPU training time:241.45745397 ms
avg iteration (step) total cpu time:260.06016908 ms
Epoch Time(s): 9.7828
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.2851 | Train Acc 0.9246 | Speed (samples/sec) 23165.9508 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:17,037] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:17,071] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=6260.084696515235
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:19,672] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:19,706] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=6258.726266828141
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:22,277] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:22,311] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=6258.438427591346
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.86294160 ms
avg iteration GPU training time:243.05143173 ms
avg iteration (step) total cpu time:262.28223907 ms
Epoch Time(s): 9.8437
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.2798 | Train Acc 0.9251 | Speed (samples/sec) 23149.9523 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:26,428] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:26,462] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=6254.408564356518
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:29,017] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:29,051] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=6254.602825596458
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:31,614] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:31,648] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=6254.432537136722
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.13051611 ms
avg iteration GPU training time:239.26961998 ms
avg iteration (step) total cpu time:257.86019255 ms
Epoch Time(s): 9.8786
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.3193 | Train Acc 0.9102 | Speed (samples/sec) 23136.6696 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:35,666] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:35,700] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=6254.640189575316
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:38,254] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:38,288] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=6254.845838483833
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:40,848] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:40,882] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=6255.232874398466
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.99349682 ms
avg iteration GPU training time:237.29766281 ms
avg iteration (step) total cpu time:256.45081202 ms
Epoch Time(s): 9.7474
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.2888 | Train Acc 0.9207 | Speed (samples/sec) 23141.7311 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:44,976] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:45,010] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=6252.997262308222
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:47,782] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:47,816] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=6246.159626979855
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:50,480] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:50,514] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=6243.261300881205
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.59353355 ms
avg iteration GPU training time:246.89066852 ms
avg iteration (step) total cpu time:266.15950796 ms
Epoch Time(s): 10.1257
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.2952 | Train Acc 0.9203 | Speed (samples/sec) 23106.0102 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:54,576] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:54,610] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=6243.2082992919895
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:57,345] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:49:57,380] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=6237.2499526805195
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:49:59,975] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:00,009] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=6236.225046979234
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:02,531] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:02,543] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=6238.261623934627
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.27519168 ms
avg iteration GPU training time:242.27687638 ms
avg iteration (step) total cpu time:260.66784505 ms
Epoch Time(s): 10.0161
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.3136 | Train Acc 0.9153 | Speed (samples/sec) 23084.1519 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:06,586] [INFO] [logging.py:60:log_dist] [Rank 0] step=810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:06,619] [INFO] [timer.py:160:stop] 0/810, SamplesPerSec=6237.427694653285
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:09,172] [INFO] [logging.py:60:log_dist] [Rank 0] step=820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:09,204] [INFO] [timer.py:160:stop] 0/820, SamplesPerSec=6238.047862708938
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:11,808] [INFO] [logging.py:60:log_dist] [Rank 0] step=830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:11,842] [INFO] [timer.py:160:stop] 0/830, SamplesPerSec=6237.109003427814
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.62020984 ms
avg iteration GPU training time:239.19771322 ms
avg iteration (step) total cpu time:258.24817905 ms
Epoch Time(s): 9.7819
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.2867 | Train Acc 0.9207 | Speed (samples/sec) 23085.2688 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:15,969] [INFO] [logging.py:60:log_dist] [Rank 0] step=840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:16,002] [INFO] [timer.py:160:stop] 0/840, SamplesPerSec=6234.31085598921
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08251953125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08251953125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:18,687] [INFO] [logging.py:60:log_dist] [Rank 0] step=850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:18,721] [INFO] [timer.py:160:stop] 0/850, SamplesPerSec=6230.916954604738
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:21,389] [INFO] [logging.py:60:log_dist] [Rank 0] step=860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:21,422] [INFO] [timer.py:160:stop] 0/860, SamplesPerSec=6228.294797130536
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.82731371 ms
avg iteration GPU training time:245.91209977 ms
avg iteration (step) total cpu time:265.40330604 ms
Epoch Time(s): 10.0800
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.2959 | Train Acc 0.9220 | Speed (samples/sec) 23056.6060 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:25,575] [INFO] [logging.py:60:log_dist] [Rank 0] step=870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:25,609] [INFO] [timer.py:160:stop] 0/870, SamplesPerSec=6224.642714564866
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:28,131] [INFO] [logging.py:60:log_dist] [Rank 0] step=880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:28,165] [INFO] [timer.py:160:stop] 0/880, SamplesPerSec=6226.090783159339
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:30,672] [INFO] [logging.py:60:log_dist] [Rank 0] step=890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:30,706] [INFO] [timer.py:160:stop] 0/890, SamplesPerSec=6228.0899956342155
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.89504830 ms
avg iteration GPU training time:236.51019739 ms
avg iteration (step) total cpu time:256.40500033 ms
Epoch Time(s): 9.8440
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.2982 | Train Acc 0.9172 | Speed (samples/sec) 23052.5181 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:34,790] [INFO] [logging.py:60:log_dist] [Rank 0] step=900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:34,824] [INFO] [timer.py:160:stop] 0/900, SamplesPerSec=6226.871450977044
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:37,355] [INFO] [logging.py:60:log_dist] [Rank 0] step=910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:37,389] [INFO] [timer.py:160:stop] 0/910, SamplesPerSec=6228.436867837555
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:39,948] [INFO] [logging.py:60:log_dist] [Rank 0] step=920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:39,982] [INFO] [timer.py:160:stop] 0/920, SamplesPerSec=6229.0077074864475
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.81258067 ms
avg iteration GPU training time:235.93144000 ms
avg iteration (step) total cpu time:255.16263644 ms
Epoch Time(s): 9.7027
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.2754 | Train Acc 0.9238 | Speed (samples/sec) 23059.0410 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:43,914] [INFO] [logging.py:60:log_dist] [Rank 0] step=930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:43,947] [INFO] [timer.py:160:stop] 0/930, SamplesPerSec=6230.939823276376
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:46,518] [INFO] [logging.py:60:log_dist] [Rank 0] step=940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:46,552] [INFO] [timer.py:160:stop] 0/940, SamplesPerSec=6231.245691683038
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:49,110] [INFO] [logging.py:60:log_dist] [Rank 0] step=950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:49,144] [INFO] [timer.py:160:stop] 0/950, SamplesPerSec=6231.894816487184
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:51,858] [INFO] [logging.py:60:log_dist] [Rank 0] step=960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:51,871] [INFO] [timer.py:160:stop] 0/960, SamplesPerSec=6228.232014087087
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.76036971 ms
avg iteration GPU training time:245.25766669 ms
avg iteration (step) total cpu time:264.54867257 ms
Epoch Time(s): 9.9249
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.3050 | Train Acc 0.9172 | Speed (samples/sec) 23046.4030 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:55,958] [INFO] [logging.py:60:log_dist] [Rank 0] step=970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:55,992] [INFO] [timer.py:160:stop] 0/970, SamplesPerSec=6225.630555878973
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:50:58,442] [INFO] [logging.py:60:log_dist] [Rank 0] step=980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:50:58,476] [INFO] [timer.py:160:stop] 0/980, SamplesPerSec=6229.001540230854
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:01,024] [INFO] [logging.py:60:log_dist] [Rank 0] step=990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:01,058] [INFO] [timer.py:160:stop] 0/990, SamplesPerSec=6229.929880889621
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.17260800 ms
avg iteration GPU training time:236.14220683 ms
avg iteration (step) total cpu time:255.70038513 ms
Epoch Time(s): 9.6437
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.3114 | Train Acc 0.9172 | Speed (samples/sec) 23056.8283 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:05,121] [INFO] [logging.py:60:log_dist] [Rank 0] step=1000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:05,153] [INFO] [timer.py:160:stop] 0/1000, SamplesPerSec=6228.318023679652
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:07,755] [INFO] [logging.py:60:log_dist] [Rank 0] step=1010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:07,789] [INFO] [timer.py:160:stop] 0/1010, SamplesPerSec=6227.552911056758
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:10,411] [INFO] [logging.py:60:log_dist] [Rank 0] step=1020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:10,445] [INFO] [timer.py:160:stop] 0/1020, SamplesPerSec=6226.250448456697
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.38195313 ms
avg iteration GPU training time:244.75980745 ms
avg iteration (step) total cpu time:263.25712381 ms
Epoch Time(s): 9.9026
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.3174 | Train Acc 0.9163 | Speed (samples/sec) 23044.1760 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:14,426] [INFO] [logging.py:60:log_dist] [Rank 0] step=1030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:14,459] [INFO] [timer.py:160:stop] 0/1030, SamplesPerSec=6227.25694262007
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:16,873] [INFO] [logging.py:60:log_dist] [Rank 0] step=1040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:16,907] [INFO] [timer.py:160:stop] 0/1040, SamplesPerSec=6230.926647544825
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:19,645] [INFO] [logging.py:60:log_dist] [Rank 0] step=1050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:19,679] [INFO] [timer.py:160:stop] 0/1050, SamplesPerSec=6226.957424550147
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.25181998 ms
avg iteration GPU training time:243.92711272 ms
avg iteration (step) total cpu time:262.48926587 ms
Epoch Time(s): 9.8859
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.2920 | Train Acc 0.9212 | Speed (samples/sec) 23039.9708 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:23,876] [INFO] [logging.py:60:log_dist] [Rank 0] step=1060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:23,910] [INFO] [timer.py:160:stop] 0/1060, SamplesPerSec=6222.923147358656
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:26,504] [INFO] [logging.py:60:log_dist] [Rank 0] step=1070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:26,538] [INFO] [timer.py:160:stop] 0/1070, SamplesPerSec=6222.689679782984
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:29,201] [INFO] [logging.py:60:log_dist] [Rank 0] step=1080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:29,235] [INFO] [timer.py:160:stop] 0/1080, SamplesPerSec=6220.6269946724005
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.45454822 ms
avg iteration GPU training time:248.86098848 ms
avg iteration (step) total cpu time:267.58306115 ms
Epoch Time(s): 10.1179
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.3301 | Train Acc 0.9087 | Speed (samples/sec) 23014.5260 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:33,431] [INFO] [logging.py:60:log_dist] [Rank 0] step=1090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:33,465] [INFO] [timer.py:160:stop] 0/1090, SamplesPerSec=6216.628245658023
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:35,951] [INFO] [logging.py:60:log_dist] [Rank 0] step=1100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:35,984] [INFO] [timer.py:160:stop] 0/1100, SamplesPerSec=6218.645526891492
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:38,389] [INFO] [logging.py:60:log_dist] [Rank 0] step=1110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:38,423] [INFO] [timer.py:160:stop] 0/1110, SamplesPerSec=6222.445357625385
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:40,884] [INFO] [logging.py:60:log_dist] [Rank 0] step=1120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:40,896] [INFO] [timer.py:160:stop] 0/1120, SamplesPerSec=6225.117082104236
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.02075497 ms
avg iteration GPU training time:226.49386766 ms
avg iteration (step) total cpu time:244.50339211 ms
Epoch Time(s): 9.4804
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.2885 | Train Acc 0.9195 | Speed (samples/sec) 23044.2930 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:45,268] [INFO] [logging.py:60:log_dist] [Rank 0] step=1130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:45,297] [INFO] [timer.py:160:stop] 0/1130, SamplesPerSec=6217.785369323625
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:48,081] [INFO] [logging.py:60:log_dist] [Rank 0] step=1140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:48,115] [INFO] [timer.py:160:stop] 0/1140, SamplesPerSec=6213.168925002374
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:50,538] [INFO] [logging.py:60:log_dist] [Rank 0] step=1150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:50,572] [INFO] [timer.py:160:stop] 0/1150, SamplesPerSec=6216.590328306091
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.64075025 ms
avg iteration GPU training time:248.38878038 ms
avg iteration (step) total cpu time:267.40481235 ms
Epoch Time(s): 10.1277
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.2891 | Train Acc 0.9227 | Speed (samples/sec) 23024.3067 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:54,652] [INFO] [logging.py:60:log_dist] [Rank 0] step=1160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:54,685] [INFO] [timer.py:160:stop] 0/1160, SamplesPerSec=6214.937358490865
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:57,092] [INFO] [logging.py:60:log_dist] [Rank 0] step=1170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:57,126] [INFO] [timer.py:160:stop] 0/1170, SamplesPerSec=6218.7827352556715
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:51:59,556] [INFO] [logging.py:60:log_dist] [Rank 0] step=1180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:51:59,590] [INFO] [timer.py:160:stop] 0/1180, SamplesPerSec=6221.911247253607
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.58074190 ms
avg iteration GPU training time:226.79528752 ms
avg iteration (step) total cpu time:245.80914003 ms
Epoch Time(s): 9.5614
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.2714 | Train Acc 0.9263 | Speed (samples/sec) 23046.5818 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:03,732] [INFO] [logging.py:60:log_dist] [Rank 0] step=1190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:03,765] [INFO] [timer.py:160:stop] 0/1190, SamplesPerSec=6219.350188871752
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:06,575] [INFO] [logging.py:60:log_dist] [Rank 0] step=1200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:06,609] [INFO] [timer.py:160:stop] 0/1200, SamplesPerSec=6214.2776849223255
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:09,311] [INFO] [logging.py:60:log_dist] [Rank 0] step=1210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:09,345] [INFO] [timer.py:160:stop] 0/1210, SamplesPerSec=6211.6599264589595
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.52871231 ms
avg iteration GPU training time:253.28163486 ms
avg iteration (step) total cpu time:271.99579168 ms
Epoch Time(s): 10.2763
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.2989 | Train Acc 0.9233 | Speed (samples/sec) 23014.0344 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:13,471] [INFO] [logging.py:60:log_dist] [Rank 0] step=1220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:13,505] [INFO] [timer.py:160:stop] 0/1220, SamplesPerSec=6210.7089765759065
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:16,052] [INFO] [logging.py:60:log_dist] [Rank 0] step=1230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:16,086] [INFO] [timer.py:160:stop] 0/1230, SamplesPerSec=6211.42354759711
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:18,454] [INFO] [logging.py:60:log_dist] [Rank 0] step=1240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:18,488] [INFO] [timer.py:160:stop] 0/1240, SamplesPerSec=6215.773966287152
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.66735647 ms
avg iteration GPU training time:225.00072055 ms
avg iteration (step) total cpu time:243.58440329 ms
Epoch Time(s): 9.5061
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.2928 | Train Acc 0.9195 | Speed (samples/sec) 23042.6031 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:22,393] [INFO] [logging.py:60:log_dist] [Rank 0] step=1250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:22,427] [INFO] [timer.py:160:stop] 0/1250, SamplesPerSec=6218.562656309681
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:25,284] [INFO] [logging.py:60:log_dist] [Rank 0] step=1260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:25,318] [INFO] [timer.py:160:stop] 0/1260, SamplesPerSec=6212.87318469488
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:28,136] [INFO] [logging.py:60:log_dist] [Rank 0] step=1270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:28,170] [INFO] [timer.py:160:stop] 0/1270, SamplesPerSec=6208.126327663235
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:30,657] [INFO] [logging.py:60:log_dist] [Rank 0] step=1280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:30,669] [INFO] [timer.py:160:stop] 0/1280, SamplesPerSec=6210.250295775415
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.84907959 ms
avg iteration GPU training time:254.58734131 ms
avg iteration (step) total cpu time:273.82844466 ms
Epoch Time(s): 10.2806
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.2970 | Train Acc 0.9182 | Speed (samples/sec) 23011.5446 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:34,573] [INFO] [logging.py:60:log_dist] [Rank 0] step=1290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:34,607] [INFO] [timer.py:160:stop] 0/1290, SamplesPerSec=6212.497858132529
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:37,182] [INFO] [logging.py:60:log_dist] [Rank 0] step=1300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:37,216] [INFO] [timer.py:160:stop] 0/1300, SamplesPerSec=6212.546923632353
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:39,689] [INFO] [logging.py:60:log_dist] [Rank 0] step=1310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:39,722] [INFO] [timer.py:160:stop] 0/1310, SamplesPerSec=6214.439792005768
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.15334871 ms
avg iteration GPU training time:234.16882381 ms
avg iteration (step) total cpu time:252.80638977 ms
Epoch Time(s): 9.5283
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.3229 | Train Acc 0.9126 | Speed (samples/sec) 23027.1131 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08251953125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08251953125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:44,077] [INFO] [logging.py:60:log_dist] [Rank 0] step=1320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:44,111] [INFO] [timer.py:160:stop] 0/1320, SamplesPerSec=6209.8854745343615
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:46,679] [INFO] [logging.py:60:log_dist] [Rank 0] step=1330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:46,713] [INFO] [timer.py:160:stop] 0/1330, SamplesPerSec=6210.125618262262
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:49,144] [INFO] [logging.py:60:log_dist] [Rank 0] step=1340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:49,179] [INFO] [timer.py:160:stop] 0/1340, SamplesPerSec=6212.97739363525
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.17162199 ms
avg iteration GPU training time:235.21053795 ms
avg iteration (step) total cpu time:254.06259961 ms
Epoch Time(s): 9.8839
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.2914 | Train Acc 0.9199 | Speed (samples/sec) 23030.7066 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:53,190] [INFO] [logging.py:60:log_dist] [Rank 0] step=1350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:53,224] [INFO] [timer.py:160:stop] 0/1350, SamplesPerSec=6214.636390884255
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:55,589] [INFO] [logging.py:60:log_dist] [Rank 0] step=1360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:55,623] [INFO] [timer.py:160:stop] 0/1360, SamplesPerSec=6218.492458942586
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:52:58,098] [INFO] [logging.py:60:log_dist] [Rank 0] step=1370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:52:58,132] [INFO] [timer.py:160:stop] 0/1370, SamplesPerSec=6220.311662793007
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.27081599 ms
avg iteration GPU training time:227.31850688 ms
avg iteration (step) total cpu time:246.16418061 ms
Epoch Time(s): 9.5424
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.2979 | Train Acc 0.9182 | Speed (samples/sec) 23054.2311 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:02,268] [INFO] [logging.py:60:log_dist] [Rank 0] step=1380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:02,302] [INFO] [timer.py:160:stop] 0/1380, SamplesPerSec=6220.006889194853
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:04,756] [INFO] [logging.py:60:log_dist] [Rank 0] step=1390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:04,789] [INFO] [timer.py:160:stop] 0/1390, SamplesPerSec=6222.344850591348
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:07,398] [INFO] [logging.py:60:log_dist] [Rank 0] step=1400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:07,431] [INFO] [timer.py:160:stop] 0/1400, SamplesPerSec=6222.107786957324
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.13386186 ms
avg iteration GPU training time:234.52376133 ms
avg iteration (step) total cpu time:254.09757649 ms
Epoch Time(s): 9.7939
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.3053 | Train Acc 0.9183 | Speed (samples/sec) 23060.3313 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:11,502] [INFO] [logging.py:60:log_dist] [Rank 0] step=1410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:11,536] [INFO] [timer.py:160:stop] 0/1410, SamplesPerSec=6222.612528463039
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:14,292] [INFO] [logging.py:60:log_dist] [Rank 0] step=1420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:14,326] [INFO] [timer.py:160:stop] 0/1420, SamplesPerSec=6219.282312098653
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:16,743] [INFO] [logging.py:60:log_dist] [Rank 0] step=1430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:16,777] [INFO] [timer.py:160:stop] 0/1430, SamplesPerSec=6222.185842910962
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:19,249] [INFO] [logging.py:60:log_dist] [Rank 0] step=1440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:19,262] [INFO] [timer.py:160:stop] 0/1440, SamplesPerSec=6224.092212822546
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.35824235 ms
avg iteration GPU training time:227.23917361 ms
avg iteration (step) total cpu time:245.94236303 ms
Epoch Time(s): 9.8301
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.3043 | Train Acc 0.9180 | Speed (samples/sec) 23072.5572 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:23,428] [INFO] [logging.py:60:log_dist] [Rank 0] step=1450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:23,462] [INFO] [timer.py:160:stop] 0/1450, SamplesPerSec=6220.675470446989
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:26,036] [INFO] [logging.py:60:log_dist] [Rank 0] step=1460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:26,069] [INFO] [timer.py:160:stop] 0/1460, SamplesPerSec=6221.032200229381
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:28,716] [INFO] [logging.py:60:log_dist] [Rank 0] step=1470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:28,750] [INFO] [timer.py:160:stop] 0/1470, SamplesPerSec=6219.812190814169
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.34701738 ms
avg iteration GPU training time:242.53989721 ms
avg iteration (step) total cpu time:262.31469048 ms
Epoch Time(s): 9.9109
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.3130 | Train Acc 0.9155 | Speed (samples/sec) 23061.6925 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:32,790] [INFO] [logging.py:60:log_dist] [Rank 0] step=1480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:32,823] [INFO] [timer.py:160:stop] 0/1480, SamplesPerSec=6219.006559623082
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:35,493] [INFO] [logging.py:60:log_dist] [Rank 0] step=1490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:35,526] [INFO] [timer.py:160:stop] 0/1490, SamplesPerSec=6217.543014433727
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:38,077] [INFO] [logging.py:60:log_dist] [Rank 0] step=1500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:38,111] [INFO] [timer.py:160:stop] 0/1500, SamplesPerSec=6218.085377812367
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.88161905 ms
avg iteration GPU training time:242.67742016 ms
avg iteration (step) total cpu time:262.22901874 ms
Epoch Time(s): 9.9612
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.2989 | Train Acc 0.9187 | Speed (samples/sec) 23050.9978 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:42,283] [INFO] [logging.py:60:log_dist] [Rank 0] step=1510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:42,317] [INFO] [timer.py:160:stop] 0/1510, SamplesPerSec=6215.792851828652
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:44,892] [INFO] [logging.py:60:log_dist] [Rank 0] step=1520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:44,926] [INFO] [timer.py:160:stop] 0/1520, SamplesPerSec=6215.8285828031085
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:47,347] [INFO] [logging.py:60:log_dist] [Rank 0] step=1530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:47,381] [INFO] [timer.py:160:stop] 0/1530, SamplesPerSec=6218.468878468624
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.57797450 ms
avg iteration GPU training time:230.19477731 ms
avg iteration (step) total cpu time:248.86502160 ms
Epoch Time(s): 9.6712
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.3035 | Train Acc 0.9177 | Speed (samples/sec) 23062.8433 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:51,327] [INFO] [logging.py:60:log_dist] [Rank 0] step=1540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:51,361] [INFO] [timer.py:160:stop] 0/1540, SamplesPerSec=6219.80142473975
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:53,789] [INFO] [logging.py:60:log_dist] [Rank 0] step=1550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:53,823] [INFO] [timer.py:160:stop] 0/1550, SamplesPerSec=6222.305449457935
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:53:56,198] [INFO] [logging.py:60:log_dist] [Rank 0] step=1560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:53:56,233] [INFO] [timer.py:160:stop] 0/1560, SamplesPerSec=6225.6553345165175
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.65031700 ms
avg iteration GPU training time:219.32817699 ms
avg iteration (step) total cpu time:238.12576577 ms
Epoch Time(s): 9.2943
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.3050 | Train Acc 0.9204 | Speed (samples/sec) 23092.7228 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:00,129] [INFO] [logging.py:60:log_dist] [Rank 0] step=1570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:00,162] [INFO] [timer.py:160:stop] 0/1570, SamplesPerSec=6228.080372826806
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:02,801] [INFO] [logging.py:60:log_dist] [Rank 0] step=1580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:02,835] [INFO] [timer.py:160:stop] 0/1580, SamplesPerSec=6227.0148020845645
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:05,406] [INFO] [logging.py:60:log_dist] [Rank 0] step=1590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:05,440] [INFO] [timer.py:160:stop] 0/1590, SamplesPerSec=6227.10377631655
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08251953125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:07,955] [INFO] [logging.py:60:log_dist] [Rank 0] step=1600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:07,968] [INFO] [timer.py:160:stop] 0/1600, SamplesPerSec=6228.2359634612585
-----------------------------------------after batch engine step
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.68428675 ms
avg iteration GPU training time:238.43680827 ms
avg iteration (step) total cpu time:257.51552758 ms
Epoch Time(s): 9.9262
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.3153 | Train Acc 0.9142 | Speed (samples/sec) 23089.2372 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:11,923] [INFO] [logging.py:60:log_dist] [Rank 0] step=1610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:11,957] [INFO] [timer.py:160:stop] 0/1610, SamplesPerSec=6229.588051122198
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:14,453] [INFO] [logging.py:60:log_dist] [Rank 0] step=1620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:14,487] [INFO] [timer.py:160:stop] 0/1620, SamplesPerSec=6230.828872089208
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:17,037] [INFO] [logging.py:60:log_dist] [Rank 0] step=1630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:17,071] [INFO] [timer.py:160:stop] 0/1630, SamplesPerSec=6231.145837922983
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.74080589 ms
avg iteration GPU training time:232.62857395 ms
avg iteration (step) total cpu time:251.99737372 ms
Epoch Time(s): 9.5345
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.3176 | Train Acc 0.9097 | Speed (samples/sec) 23101.1930 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:21,139] [INFO] [logging.py:60:log_dist] [Rank 0] step=1640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:21,174] [INFO] [timer.py:160:stop] 0/1640, SamplesPerSec=6230.867726934032
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:23,635] [INFO] [logging.py:60:log_dist] [Rank 0] step=1650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:23,669] [INFO] [timer.py:160:stop] 0/1650, SamplesPerSec=6232.599591676919
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:26,203] [INFO] [logging.py:60:log_dist] [Rank 0] step=1660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:26,236] [INFO] [timer.py:160:stop] 0/1660, SamplesPerSec=6233.196623234953
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.59108741 ms
avg iteration GPU training time:232.11534119 ms
avg iteration (step) total cpu time:251.01905399 ms
Epoch Time(s): 9.6816
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.2978 | Train Acc 0.9182 | Speed (samples/sec) 23107.9134 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:30,150] [INFO] [logging.py:60:log_dist] [Rank 0] step=1670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:30,184] [INFO] [timer.py:160:stop] 0/1670, SamplesPerSec=6234.103070259946
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:32,707] [INFO] [logging.py:60:log_dist] [Rank 0] step=1680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:32,741] [INFO] [timer.py:160:stop] 0/1680, SamplesPerSec=6234.835158234509
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:35,305] [INFO] [logging.py:60:log_dist] [Rank 0] step=1690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:35,339] [INFO] [timer.py:160:stop] 0/1690, SamplesPerSec=6235.13224417083
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.35635206 ms
avg iteration GPU training time:236.04003850 ms
avg iteration (step) total cpu time:255.83925954 ms
Epoch Time(s): 9.6287
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.3222 | Train Acc 0.9132 | Speed (samples/sec) 23111.4687 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:39,414] [INFO] [logging.py:60:log_dist] [Rank 0] step=1700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:39,448] [INFO] [timer.py:160:stop] 0/1700, SamplesPerSec=6234.382067969293
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:42,094] [INFO] [logging.py:60:log_dist] [Rank 0] step=1710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:42,127] [INFO] [timer.py:160:stop] 0/1710, SamplesPerSec=6233.505764757923
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:44,557] [INFO] [logging.py:60:log_dist] [Rank 0] step=1720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:44,591] [INFO] [timer.py:160:stop] 0/1720, SamplesPerSec=6235.699248356184
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.70806161 ms
avg iteration GPU training time:231.80047777 ms
avg iteration (step) total cpu time:251.30033493 ms
Epoch Time(s): 9.6470
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.3328 | Train Acc 0.9139 | Speed (samples/sec) 23117.1612 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:48,794] [INFO] [logging.py:60:log_dist] [Rank 0] step=1730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:48,828] [INFO] [timer.py:160:stop] 0/1730, SamplesPerSec=6237.470820000207
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:51,434] [INFO] [logging.py:60:log_dist] [Rank 0] step=1740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:51,467] [INFO] [timer.py:160:stop] 0/1740, SamplesPerSec=6236.885960780904
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:54,032] [INFO] [logging.py:60:log_dist] [Rank 0] step=1750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:54,066] [INFO] [timer.py:160:stop] 0/1750, SamplesPerSec=6236.932783558681
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:54:56,559] [INFO] [logging.py:60:log_dist] [Rank 0] step=1760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:54:56,572] [INFO] [timer.py:160:stop] 0/1760, SamplesPerSec=6238.185750859396
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.37303707 ms
avg iteration GPU training time:238.10041527 ms
avg iteration (step) total cpu time:256.62465449 ms
Epoch Time(s): 10.0654
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.3360 | Train Acc 0.9106 | Speed (samples/sec) 23117.1372 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:00,654] [INFO] [logging.py:60:log_dist] [Rank 0] step=1770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:00,688] [INFO] [timer.py:160:stop] 0/1770, SamplesPerSec=6236.735321705444
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:03,421] [INFO] [logging.py:60:log_dist] [Rank 0] step=1780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:03,455] [INFO] [timer.py:160:stop] 0/1780, SamplesPerSec=6234.648856680291
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:06,009] [INFO] [logging.py:60:log_dist] [Rank 0] step=1790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:06,044] [INFO] [timer.py:160:stop] 0/1790, SamplesPerSec=6234.819026013923
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.93358695 ms
avg iteration GPU training time:247.55098301 ms
avg iteration (step) total cpu time:267.39254704 ms
Epoch Time(s): 10.0134
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.3049 | Train Acc 0.9190 | Speed (samples/sec) 23104.8132 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:10,139] [INFO] [logging.py:60:log_dist] [Rank 0] step=1800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:10,173] [INFO] [timer.py:160:stop] 0/1800, SamplesPerSec=6234.414436624496
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:12,719] [INFO] [logging.py:60:log_dist] [Rank 0] step=1810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:12,753] [INFO] [timer.py:160:stop] 0/1810, SamplesPerSec=6234.901211247016
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:15,366] [INFO] [logging.py:60:log_dist] [Rank 0] step=1820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:15,400] [INFO] [timer.py:160:stop] 0/1820, SamplesPerSec=6234.279267869757
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.03495229 ms
avg iteration GPU training time:237.02602471 ms
avg iteration (step) total cpu time:256.70564616 ms
Epoch Time(s): 9.7509
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.2915 | Train Acc 0.9195 | Speed (samples/sec) 23105.5293 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:19,448] [INFO] [logging.py:60:log_dist] [Rank 0] step=1830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:19,482] [INFO] [timer.py:160:stop] 0/1830, SamplesPerSec=6233.672745419376
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:21,882] [INFO] [logging.py:60:log_dist] [Rank 0] step=1840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:21,916] [INFO] [timer.py:160:stop] 0/1840, SamplesPerSec=6235.977557800902
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:24,402] [INFO] [logging.py:60:log_dist] [Rank 0] step=1850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:24,436] [INFO] [timer.py:160:stop] 0/1850, SamplesPerSec=6237.154766959861
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.63890604 ms
avg iteration GPU training time:230.45745058 ms
avg iteration (step) total cpu time:249.26526458 ms
Epoch Time(s): 9.6158
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.2944 | Train Acc 0.9145 | Speed (samples/sec) 23114.4241 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:28,557] [INFO] [logging.py:60:log_dist] [Rank 0] step=1860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:28,591] [INFO] [timer.py:160:stop] 0/1860, SamplesPerSec=6235.961118070744
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:31,184] [INFO] [logging.py:60:log_dist] [Rank 0] step=1870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:31,218] [INFO] [timer.py:160:stop] 0/1870, SamplesPerSec=6235.78897826238
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:33,777] [INFO] [logging.py:60:log_dist] [Rank 0] step=1880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:33,811] [INFO] [timer.py:160:stop] 0/1880, SamplesPerSec=6236.103534796571
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.08269038 ms
avg iteration GPU training time:237.49665606 ms
avg iteration (step) total cpu time:257.00655690 ms
Epoch Time(s): 9.8992
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.2943 | Train Acc 0.9207 | Speed (samples/sec) 23109.9366 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:37,795] [INFO] [logging.py:60:log_dist] [Rank 0] step=1890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:37,829] [INFO] [timer.py:160:stop] 0/1890, SamplesPerSec=6236.335828676421
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:40,602] [INFO] [logging.py:60:log_dist] [Rank 0] step=1900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:40,636] [INFO] [timer.py:160:stop] 0/1900, SamplesPerSec=6233.4595637959155
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:43,136] [INFO] [logging.py:60:log_dist] [Rank 0] step=1910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:43,169] [INFO] [timer.py:160:stop] 0/1910, SamplesPerSec=6234.349321009806
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:45,755] [INFO] [logging.py:60:log_dist] [Rank 0] step=1920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:45,768] [INFO] [timer.py:160:stop] 0/1920, SamplesPerSec=6234.213152548718
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.03977240 ms
avg iteration GPU training time:244.17334719 ms
avg iteration (step) total cpu time:262.28900309 ms
Epoch Time(s): 9.9165
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.3128 | Train Acc 0.9132 | Speed (samples/sec) 23102.4715 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:50,059] [INFO] [logging.py:60:log_dist] [Rank 0] step=1930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:50,092] [INFO] [timer.py:160:stop] 0/1930, SamplesPerSec=6230.773565507562
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:52,732] [INFO] [logging.py:60:log_dist] [Rank 0] step=1940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:52,766] [INFO] [timer.py:160:stop] 0/1940, SamplesPerSec=6229.995423527898
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:55,352] [INFO] [logging.py:60:log_dist] [Rank 0] step=1950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:55,386] [INFO] [timer.py:160:stop] 0/1950, SamplesPerSec=6229.8680236196315
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.03103765 ms
avg iteration GPU training time:246.43021308 ms
avg iteration (step) total cpu time:266.70867425 ms
Epoch Time(s): 10.0960
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.3091 | Train Acc 0.9185 | Speed (samples/sec) 23088.7158 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:55:59,344] [INFO] [logging.py:60:log_dist] [Rank 0] step=1960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:55:59,378] [INFO] [timer.py:160:stop] 0/1960, SamplesPerSec=6230.671941612167
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:01,920] [INFO] [logging.py:60:log_dist] [Rank 0] step=1970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:01,954] [INFO] [timer.py:160:stop] 0/1970, SamplesPerSec=6231.312505241018
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:04,863] [INFO] [logging.py:60:log_dist] [Rank 0] step=1980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:04,896] [INFO] [timer.py:160:stop] 0/1980, SamplesPerSec=6226.988928064892
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.45446758 ms
avg iteration GPU training time:252.87333001 ms
avg iteration (step) total cpu time:272.78995514 ms
Epoch Time(s): 10.1233
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.3013 | Train Acc 0.9183 | Speed (samples/sec) 23073.0303 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:09,070] [INFO] [logging.py:60:log_dist] [Rank 0] step=1990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:09,104] [INFO] [timer.py:160:stop] 0/1990, SamplesPerSec=6225.167525927572
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:11,694] [INFO] [logging.py:60:log_dist] [Rank 0] step=2000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:11,725] [INFO] [timer.py:160:stop] 0/2000, SamplesPerSec=6224.95213203986
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:14,291] [INFO] [logging.py:60:log_dist] [Rank 0] step=2010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:14,325] [INFO] [timer.py:160:stop] 0/2010, SamplesPerSec=6225.257651807261
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.86343122 ms
avg iteration GPU training time:238.19546961 ms
avg iteration (step) total cpu time:257.50369496 ms
Epoch Time(s): 9.8096
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.3267 | Train Acc 0.9121 | Speed (samples/sec) 23073.1122 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:18,397] [INFO] [logging.py:60:log_dist] [Rank 0] step=2020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:18,431] [INFO] [timer.py:160:stop] 0/2020, SamplesPerSec=6224.354601228117
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:21,115] [INFO] [logging.py:60:log_dist] [Rank 0] step=2030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:21,149] [INFO] [timer.py:160:stop] 0/2030, SamplesPerSec=6223.012971246639
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:23,694] [INFO] [logging.py:60:log_dist] [Rank 0] step=2040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:23,728] [INFO] [timer.py:160:stop] 0/2040, SamplesPerSec=6223.472263933396
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.60402362 ms
avg iteration GPU training time:241.82096354 ms
avg iteration (step) total cpu time:260.87802428 ms
Epoch Time(s): 9.9825
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.3161 | Train Acc 0.9119 | Speed (samples/sec) 23065.1887 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:27,763] [INFO] [logging.py:60:log_dist] [Rank 0] step=2050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:27,797] [INFO] [timer.py:160:stop] 0/2050, SamplesPerSec=6223.045411531407
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:30,550] [INFO] [logging.py:60:log_dist] [Rank 0] step=2060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:30,585] [INFO] [timer.py:160:stop] 0/2060, SamplesPerSec=6220.6804888476045
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:33,371] [INFO] [logging.py:60:log_dist] [Rank 0] step=2070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:33,405] [INFO] [timer.py:160:stop] 0/2070, SamplesPerSec=6218.055448551829
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:35,937] [INFO] [logging.py:60:log_dist] [Rank 0] step=2080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:35,949] [INFO] [timer.py:160:stop] 0/2080, SamplesPerSec=6218.666192012064
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.20653038 ms
avg iteration GPU training time:252.42221239 ms
avg iteration (step) total cpu time:270.95200397 ms
Epoch Time(s): 10.1857
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.3172 | Train Acc 0.9143 | Speed (samples/sec) 23048.5850 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:40,155] [INFO] [logging.py:60:log_dist] [Rank 0] step=2090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:40,185] [INFO] [timer.py:160:stop] 0/2090, SamplesPerSec=6217.363653519689
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:42,787] [INFO] [logging.py:60:log_dist] [Rank 0] step=2100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:42,817] [INFO] [timer.py:160:stop] 0/2100, SamplesPerSec=6217.043422002497
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:45,508] [INFO] [logging.py:60:log_dist] [Rank 0] step=2110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:45,538] [INFO] [timer.py:160:stop] 0/2110, SamplesPerSec=6215.590979205917
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.31227025 ms
avg iteration GPU training time:245.22604427 ms
avg iteration (step) total cpu time:263.62013817 ms
Epoch Time(s): 10.0184
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.3273 | Train Acc 0.9131 | Speed (samples/sec) 23040.4430 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:49,528] [INFO] [logging.py:60:log_dist] [Rank 0] step=2120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:49,562] [INFO] [timer.py:160:stop] 0/2120, SamplesPerSec=6215.793438510162
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:52,238] [INFO] [logging.py:60:log_dist] [Rank 0] step=2130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:52,272] [INFO] [timer.py:160:stop] 0/2130, SamplesPerSec=6214.787412350233
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:54,927] [INFO] [logging.py:60:log_dist] [Rank 0] step=2140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:54,961] [INFO] [timer.py:160:stop] 0/2140, SamplesPerSec=6213.933723962296
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.34060692 ms
avg iteration GPU training time:245.13869618 ms
avg iteration (step) total cpu time:265.17608431 ms
Epoch Time(s): 9.9426
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.3209 | Train Acc 0.9134 | Speed (samples/sec) 23032.4838 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:56:58,932] [INFO] [logging.py:60:log_dist] [Rank 0] step=2150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:56:58,966] [INFO] [timer.py:160:stop] 0/2150, SamplesPerSec=6213.819774915354
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:01,524] [INFO] [logging.py:60:log_dist] [Rank 0] step=2160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:01,558] [INFO] [timer.py:160:stop] 0/2160, SamplesPerSec=6214.016309651118
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:04,104] [INFO] [logging.py:60:log_dist] [Rank 0] step=2170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:04,138] [INFO] [timer.py:160:stop] 0/2170, SamplesPerSec=6214.374636913962
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.12398338 ms
avg iteration GPU training time:237.35263062 ms
avg iteration (step) total cpu time:255.91772574 ms
Epoch Time(s): 9.7011
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.3011 | Train Acc 0.9190 | Speed (samples/sec) 23035.5045 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:08,463] [INFO] [logging.py:60:log_dist] [Rank 0] step=2180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:08,497] [INFO] [timer.py:160:stop] 0/2180, SamplesPerSec=6214.787499434808
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:11,084] [INFO] [logging.py:60:log_dist] [Rank 0] step=2190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:11,117] [INFO] [timer.py:160:stop] 0/2190, SamplesPerSec=6214.983889795244
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:13,765] [INFO] [logging.py:60:log_dist] [Rank 0] step=2200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:13,799] [INFO] [timer.py:160:stop] 0/2200, SamplesPerSec=6214.294599572146
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.47558758 ms
avg iteration GPU training time:241.02788515 ms
avg iteration (step) total cpu time:261.09251270 ms
Epoch Time(s): 10.1573
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.3011 | Train Acc 0.9145 | Speed (samples/sec) 23033.5759 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:17,765] [INFO] [logging.py:60:log_dist] [Rank 0] step=2210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:17,799] [INFO] [timer.py:160:stop] 0/2210, SamplesPerSec=6214.429230458764
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:20,443] [INFO] [logging.py:60:log_dist] [Rank 0] step=2220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:20,477] [INFO] [timer.py:160:stop] 0/2220, SamplesPerSec=6213.669298423381
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:22,867] [INFO] [logging.py:60:log_dist] [Rank 0] step=2230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:22,901] [INFO] [timer.py:160:stop] 0/2230, SamplesPerSec=6215.817077853523
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:25,303] [INFO] [logging.py:60:log_dist] [Rank 0] step=2240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:25,316] [INFO] [timer.py:160:stop] 0/2240, SamplesPerSec=6218.010101064464
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.56145647 ms
avg iteration GPU training time:227.96885851 ms
avg iteration (step) total cpu time:246.88241217 ms
Epoch Time(s): 9.5574
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.3269 | Train Acc 0.9103 | Speed (samples/sec) 23044.6176 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:29,438] [INFO] [logging.py:60:log_dist] [Rank 0] step=2250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:29,472] [INFO] [timer.py:160:stop] 0/2250, SamplesPerSec=6217.008594247565
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:32,128] [INFO] [logging.py:60:log_dist] [Rank 0] step=2260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:32,162] [INFO] [timer.py:160:stop] 0/2260, SamplesPerSec=6216.137590764192
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:34,517] [INFO] [logging.py:60:log_dist] [Rank 0] step=2270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:34,552] [INFO] [timer.py:160:stop] 0/2270, SamplesPerSec=6218.543034547529
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.47667789 ms
avg iteration GPU training time:232.63589986 ms
avg iteration (step) total cpu time:251.38133544 ms
Epoch Time(s): 9.6519
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.3261 | Train Acc 0.9103 | Speed (samples/sec) 23051.0020 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:38,560] [INFO] [logging.py:60:log_dist] [Rank 0] step=2280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:38,593] [INFO] [timer.py:160:stop] 0/2280, SamplesPerSec=6218.7091203062655
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:40,977] [INFO] [logging.py:60:log_dist] [Rank 0] step=2290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:41,011] [INFO] [timer.py:160:stop] 0/2290, SamplesPerSec=6220.8452841708795
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:43,442] [INFO] [logging.py:60:log_dist] [Rank 0] step=2300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:43,476] [INFO] [timer.py:160:stop] 0/2300, SamplesPerSec=6222.390624008173
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.24194128 ms
avg iteration GPU training time:223.43536716 ms
avg iteration (step) total cpu time:241.84507794 ms
Epoch Time(s): 9.3614
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.3428 | Train Acc 0.9100 | Speed (samples/sec) 23067.4584 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:47,894] [INFO] [logging.py:60:log_dist] [Rank 0] step=2310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:47,927] [INFO] [timer.py:160:stop] 0/2310, SamplesPerSec=6221.479854124052
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:50,641] [INFO] [logging.py:60:log_dist] [Rank 0] step=2320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:50,675] [INFO] [timer.py:160:stop] 0/2320, SamplesPerSec=6220.002253636274
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:53,071] [INFO] [logging.py:60:log_dist] [Rank 0] step=2330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:53,105] [INFO] [timer.py:160:stop] 0/2330, SamplesPerSec=6222.153538955025
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.36755791 ms
avg iteration GPU training time:234.14655784 ms
avg iteration (step) total cpu time:254.70598539 ms
Epoch Time(s): 10.1600
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.3256 | Train Acc 0.9089 | Speed (samples/sec) 23064.8972 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:57,019] [INFO] [logging.py:60:log_dist] [Rank 0] step=2340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:57,052] [INFO] [timer.py:160:stop] 0/2340, SamplesPerSec=6223.611882467367
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:57:59,539] [INFO] [logging.py:60:log_dist] [Rank 0] step=2350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:57:59,573] [INFO] [timer.py:160:stop] 0/2350, SamplesPerSec=6224.659190183285
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:01,960] [INFO] [logging.py:60:log_dist] [Rank 0] step=2360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:01,993] [INFO] [timer.py:160:stop] 0/2360, SamplesPerSec=6226.730904149767
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.36641421 ms
avg iteration GPU training time:223.78766604 ms
avg iteration (step) total cpu time:242.84021060 ms
Epoch Time(s): 9.3565
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.3219 | Train Acc 0.9086 | Speed (samples/sec) 23083.3387 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:06,076] [INFO] [logging.py:60:log_dist] [Rank 0] step=2370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:06,109] [INFO] [timer.py:160:stop] 0/2370, SamplesPerSec=6228.703375924138
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:08,519] [INFO] [logging.py:60:log_dist] [Rank 0] step=2380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:08,553] [INFO] [timer.py:160:stop] 0/2380, SamplesPerSec=6230.459816734463
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:11,102] [INFO] [logging.py:60:log_dist] [Rank 0] step=2390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:11,136] [INFO] [timer.py:160:stop] 0/2390, SamplesPerSec=6230.76990319179
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:13,477] [INFO] [logging.py:60:log_dist] [Rank 0] step=2400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:13,489] [INFO] [timer.py:160:stop] 0/2400, SamplesPerSec=6233.328158804646
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.47503161 ms
avg iteration GPU training time:226.79742714 ms
avg iteration (step) total cpu time:245.56455789 ms
Epoch Time(s): 9.6149
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.3347 | Train Acc 0.9073 | Speed (samples/sec) 23099.2268 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:17,379] [INFO] [logging.py:60:log_dist] [Rank 0] step=2410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:17,413] [INFO] [timer.py:160:stop] 0/2410, SamplesPerSec=6234.217330975539
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:19,796] [INFO] [logging.py:60:log_dist] [Rank 0] step=2420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:19,829] [INFO] [timer.py:160:stop] 0/2420, SamplesPerSec=6236.1637632344045
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:22,200] [INFO] [logging.py:60:log_dist] [Rank 0] step=2430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:22,234] [INFO] [timer.py:160:stop] 0/2430, SamplesPerSec=6238.117212574813
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.03519763 ms
avg iteration GPU training time:220.92862447 ms
avg iteration (step) total cpu time:238.96823106 ms
Epoch Time(s): 9.1827
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.3332 | Train Acc 0.9100 | Speed (samples/sec) 23121.0653 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:26,201] [INFO] [logging.py:60:log_dist] [Rank 0] step=2440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:26,234] [INFO] [timer.py:160:stop] 0/2440, SamplesPerSec=6238.674058933679
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:28,656] [INFO] [logging.py:60:log_dist] [Rank 0] step=2450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:28,690] [INFO] [timer.py:160:stop] 0/2450, SamplesPerSec=6240.204873636702
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:31,105] [INFO] [logging.py:60:log_dist] [Rank 0] step=2460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:31,138] [INFO] [timer.py:160:stop] 0/2460, SamplesPerSec=6241.74306599523
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.39988020 ms
avg iteration GPU training time:228.16427725 ms
avg iteration (step) total cpu time:246.81657332 ms
Epoch Time(s): 9.4590
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.3317 | Train Acc 0.9124 | Speed (samples/sec) 23133.3709 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:35,235] [INFO] [logging.py:60:log_dist] [Rank 0] step=2470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:35,269] [INFO] [timer.py:160:stop] 0/2470, SamplesPerSec=6240.7838543474
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:37,798] [INFO] [logging.py:60:log_dist] [Rank 0] step=2480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:37,832] [INFO] [timer.py:160:stop] 0/2480, SamplesPerSec=6241.12184096346
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:40,195] [INFO] [logging.py:60:log_dist] [Rank 0] step=2490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:40,229] [INFO] [timer.py:160:stop] 0/2490, SamplesPerSec=6243.19001343489
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:8.98742635 ms
avg iteration GPU training time:226.64186040 ms
avg iteration (step) total cpu time:244.79464248 ms
Epoch Time(s): 9.4763
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.3470 | Train Acc 0.9030 | Speed (samples/sec) 23143.9926 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:44,174] [INFO] [logging.py:60:log_dist] [Rank 0] step=2500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:44,208] [INFO] [timer.py:160:stop] 0/2500, SamplesPerSec=6243.424230176701
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:46,730] [INFO] [logging.py:60:log_dist] [Rank 0] step=2510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:46,763] [INFO] [timer.py:160:stop] 0/2510, SamplesPerSec=6243.8621137360615
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:49,327] [INFO] [logging.py:60:log_dist] [Rank 0] step=2520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:49,361] [INFO] [timer.py:160:stop] 0/2520, SamplesPerSec=6243.918061265361
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.57273822 ms
avg iteration GPU training time:235.06136633 ms
avg iteration (step) total cpu time:253.93246721 ms
Epoch Time(s): 9.7789
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.3208 | Train Acc 0.9097 | Speed (samples/sec) 23144.2233 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:53,317] [INFO] [logging.py:60:log_dist] [Rank 0] step=2530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:53,350] [INFO] [timer.py:160:stop] 0/2530, SamplesPerSec=6244.299014322953
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:55,912] [INFO] [logging.py:60:log_dist] [Rank 0] step=2540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:55,945] [INFO] [timer.py:160:stop] 0/2540, SamplesPerSec=6244.2832277529
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:58:58,528] [INFO] [logging.py:60:log_dist] [Rank 0] step=2550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:58:58,562] [INFO] [timer.py:160:stop] 0/2550, SamplesPerSec=6244.031974316812
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08251953125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:01,069] [INFO] [logging.py:60:log_dist] [Rank 0] step=2560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:01,082] [INFO] [timer.py:160:stop] 0/2560, SamplesPerSec=6244.770135089132
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.38544120 ms
avg iteration GPU training time:238.91080729 ms
avg iteration (step) total cpu time:257.28650446 ms
Epoch Time(s): 9.7056
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.3221 | Train Acc 0.9111 | Speed (samples/sec) 23143.8675 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:05,179] [INFO] [logging.py:60:log_dist] [Rank 0] step=2570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:05,213] [INFO] [timer.py:160:stop] 0/2570, SamplesPerSec=6243.935862336784
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:07,597] [INFO] [logging.py:60:log_dist] [Rank 0] step=2580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:07,631] [INFO] [timer.py:160:stop] 0/2580, SamplesPerSec=6245.7618199759245
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:10,026] [INFO] [logging.py:60:log_dist] [Rank 0] step=2590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:10,059] [INFO] [timer.py:160:stop] 0/2590, SamplesPerSec=6247.391935274266
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08251953125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.44740151 ms
avg iteration GPU training time:226.18913326 ms
avg iteration (step) total cpu time:244.88148866 ms
Epoch Time(s): 9.4575
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.3840 | Train Acc 0.9082 | Speed (samples/sec) 23155.1804 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:14,189] [INFO] [logging.py:60:log_dist] [Rank 0] step=2600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:14,223] [INFO] [timer.py:160:stop] 0/2600, SamplesPerSec=6245.850494578732
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:16,683] [INFO] [logging.py:60:log_dist] [Rank 0] step=2610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:16,717] [INFO] [timer.py:160:stop] 0/2610, SamplesPerSec=6246.88094983271
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:19,127] [INFO] [logging.py:60:log_dist] [Rank 0] step=2620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:19,161] [INFO] [timer.py:160:stop] 0/2620, SamplesPerSec=6248.380651879749
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.38080595 ms
avg iteration GPU training time:228.02835987 ms
avg iteration (step) total cpu time:246.78379518 ms
Epoch Time(s): 9.5399
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.3692 | Train Acc 0.8978 | Speed (samples/sec) 23163.5710 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:23,086] [INFO] [logging.py:60:log_dist] [Rank 0] step=2630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:23,120] [INFO] [timer.py:160:stop] 0/2630, SamplesPerSec=6249.494296096138
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:25,495] [INFO] [logging.py:60:log_dist] [Rank 0] step=2640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:25,528] [INFO] [timer.py:160:stop] 0/2640, SamplesPerSec=6251.271099490782
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:28,171] [INFO] [logging.py:60:log_dist] [Rank 0] step=2650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:28,204] [INFO] [timer.py:160:stop] 0/2650, SamplesPerSec=6250.7262183895045
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08251953125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.23604381 ms
avg iteration GPU training time:228.98987495 ms
avg iteration (step) total cpu time:248.16462729 ms
Epoch Time(s): 9.5439
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.3626 | Train Acc 0.9020 | Speed (samples/sec) 23173.4027 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:32,070] [INFO] [logging.py:60:log_dist] [Rank 0] step=2660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:32,103] [INFO] [timer.py:160:stop] 0/2660, SamplesPerSec=6252.660177266976
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:34,515] [INFO] [logging.py:60:log_dist] [Rank 0] step=2670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:34,549] [INFO] [timer.py:160:stop] 0/2670, SamplesPerSec=6254.199398966521
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:37,064] [INFO] [logging.py:60:log_dist] [Rank 0] step=2680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:37,098] [INFO] [timer.py:160:stop] 0/2680, SamplesPerSec=6254.686378066211
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.54579906 ms
avg iteration GPU training time:225.48121643 ms
avg iteration (step) total cpu time:244.13516786 ms
Epoch Time(s): 9.3606
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.3675 | Train Acc 0.9002 | Speed (samples/sec) 23188.3506 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:40,966] [INFO] [logging.py:60:log_dist] [Rank 0] step=2690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:41,000] [INFO] [timer.py:160:stop] 0/2690, SamplesPerSec=6255.849043130929
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:43,703] [INFO] [logging.py:60:log_dist] [Rank 0] step=2700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:43,737] [INFO] [timer.py:160:stop] 0/2700, SamplesPerSec=6254.578018121974
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:46,376] [INFO] [logging.py:60:log_dist] [Rank 0] step=2710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:46,409] [INFO] [timer.py:160:stop] 0/2710, SamplesPerSec=6253.981321757052
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:48,790] [INFO] [logging.py:60:log_dist] [Rank 0] step=2720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:48,802] [INFO] [timer.py:160:stop] 0/2720, SamplesPerSec=6255.8778902707945
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.15280591 ms
avg iteration GPU training time:237.81134090 ms
avg iteration (step) total cpu time:257.77349649 ms
Epoch Time(s): 9.8158
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.3516 | Train Acc 0.9057 | Speed (samples/sec) 23185.3579 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:52,729] [INFO] [logging.py:60:log_dist] [Rank 0] step=2730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:52,765] [INFO] [timer.py:160:stop] 0/2730, SamplesPerSec=6256.333033498275
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:55,360] [INFO] [logging.py:60:log_dist] [Rank 0] step=2740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:55,394] [INFO] [timer.py:160:stop] 0/2740, SamplesPerSec=6256.141545615879
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 21:59:57,935] [INFO] [logging.py:60:log_dist] [Rank 0] step=2750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:59:57,969] [INFO] [timer.py:160:stop] 0/2750, SamplesPerSec=6256.261458084046
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.71662931 ms
avg iteration GPU training time:238.63602250 ms
avg iteration (step) total cpu time:257.85605113 ms
Epoch Time(s): 9.6239
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.3645 | Train Acc 0.8996 | Speed (samples/sec) 23186.1237 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:01,900] [INFO] [logging.py:60:log_dist] [Rank 0] step=2760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:01,935] [INFO] [timer.py:160:stop] 0/2760, SamplesPerSec=6256.892567015634
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:04,424] [INFO] [logging.py:60:log_dist] [Rank 0] step=2770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:04,458] [INFO] [timer.py:160:stop] 0/2770, SamplesPerSec=6257.580841571751
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:06,976] [INFO] [logging.py:60:log_dist] [Rank 0] step=2780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:07,010] [INFO] [timer.py:160:stop] 0/2780, SamplesPerSec=6257.979521994425
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.54476093 ms
avg iteration GPU training time:231.69971155 ms
avg iteration (step) total cpu time:250.73291637 ms
Epoch Time(s): 9.5717
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.3833 | Train Acc 0.8934 | Speed (samples/sec) 23193.1376 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:11,055] [INFO] [logging.py:60:log_dist] [Rank 0] step=2790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:11,088] [INFO] [timer.py:160:stop] 0/2790, SamplesPerSec=6257.717578521918
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:13,709] [INFO] [logging.py:60:log_dist] [Rank 0] step=2800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:13,743] [INFO] [timer.py:160:stop] 0/2800, SamplesPerSec=6257.14530154571
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:16,364] [INFO] [logging.py:60:log_dist] [Rank 0] step=2810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:16,398] [INFO] [timer.py:160:stop] 0/2810, SamplesPerSec=6256.56805746305
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.23587075 ms
avg iteration GPU training time:243.35388692 ms
avg iteration (step) total cpu time:262.11476326 ms
Epoch Time(s): 9.9285
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.3714 | Train Acc 0.8967 | Speed (samples/sec) 23187.8910 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:20,468] [INFO] [logging.py:60:log_dist] [Rank 0] step=2820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:20,501] [INFO] [timer.py:160:stop] 0/2820, SamplesPerSec=6256.036452830121
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:23,078] [INFO] [logging.py:60:log_dist] [Rank 0] step=2830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:23,112] [INFO] [timer.py:160:stop] 0/2830, SamplesPerSec=6256.202388032861
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:25,713] [INFO] [logging.py:60:log_dist] [Rank 0] step=2840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:25,747] [INFO] [timer.py:160:stop] 0/2840, SamplesPerSec=6255.881177802454
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.81629156 ms
avg iteration GPU training time:237.97061496 ms
avg iteration (step) total cpu time:258.23026233 ms
Epoch Time(s): 9.8011
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.4227 | Train Acc 0.8849 | Speed (samples/sec) 23185.3157 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:29,703] [INFO] [logging.py:60:log_dist] [Rank 0] step=2850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:29,737] [INFO] [timer.py:160:stop] 0/2850, SamplesPerSec=6256.097881329501
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:32,295] [INFO] [logging.py:60:log_dist] [Rank 0] step=2860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:32,329] [INFO] [timer.py:160:stop] 0/2860, SamplesPerSec=6256.084598952322
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:34,789] [INFO] [logging.py:60:log_dist] [Rank 0] step=2870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:34,823] [INFO] [timer.py:160:stop] 0/2870, SamplesPerSec=6257.027459082296
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:37,416] [INFO] [logging.py:60:log_dist] [Rank 0] step=2880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:37,428] [INFO] [timer.py:160:stop] 0/2880, SamplesPerSec=6256.784305867578
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.22331617 ms
avg iteration GPU training time:234.66013421 ms
avg iteration (step) total cpu time:253.16390285 ms
Epoch Time(s): 9.7223
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.4269 | Train Acc 0.8873 | Speed (samples/sec) 23186.5164 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:41,536] [INFO] [logging.py:60:log_dist] [Rank 0] step=2890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:41,570] [INFO] [timer.py:160:stop] 0/2890, SamplesPerSec=6256.051139318633
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:44,100] [INFO] [logging.py:60:log_dist] [Rank 0] step=2900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:44,134] [INFO] [timer.py:160:stop] 0/2900, SamplesPerSec=6256.294506598055
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:46,717] [INFO] [logging.py:60:log_dist] [Rank 0] step=2910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:46,751] [INFO] [timer.py:160:stop] 0/2910, SamplesPerSec=6256.05289769102
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.17145952 ms
avg iteration GPU training time:236.34654971 ms
avg iteration (step) total cpu time:254.81721207 ms
Epoch Time(s): 9.7361
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.4455 | Train Acc 0.8721 | Speed (samples/sec) 23186.5591 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:50,852] [INFO] [logging.py:60:log_dist] [Rank 0] step=2920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:50,886] [INFO] [timer.py:160:stop] 0/2920, SamplesPerSec=6254.893235944776
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:53,433] [INFO] [logging.py:60:log_dist] [Rank 0] step=2930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:53,466] [INFO] [timer.py:160:stop] 0/2930, SamplesPerSec=6255.113992787609
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:00:56,010] [INFO] [logging.py:60:log_dist] [Rank 0] step=2940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:00:56,044] [INFO] [timer.py:160:stop] 0/2940, SamplesPerSec=6255.260010339158
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.05855537 ms
avg iteration GPU training time:237.30790767 ms
avg iteration (step) total cpu time:256.87652164 ms
Epoch Time(s): 9.8117
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.4826 | Train Acc 0.8629 | Speed (samples/sec) 23183.1732 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:00,152] [INFO] [logging.py:60:log_dist] [Rank 0] step=2950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:00,186] [INFO] [timer.py:160:stop] 0/2950, SamplesPerSec=6254.253495942436
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:02,670] [INFO] [logging.py:60:log_dist] [Rank 0] step=2960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:02,704] [INFO] [timer.py:160:stop] 0/2960, SamplesPerSec=6254.904093458053
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:05,349] [INFO] [logging.py:60:log_dist] [Rank 0] step=2970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:05,383] [INFO] [timer.py:160:stop] 0/2970, SamplesPerSec=6254.291218851717
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.44222936 ms
avg iteration GPU training time:238.52721885 ms
avg iteration (step) total cpu time:257.88554439 ms
Epoch Time(s): 9.8383
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.4625 | Train Acc 0.8716 | Speed (samples/sec) 23180.1814 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:09,386] [INFO] [logging.py:60:log_dist] [Rank 0] step=2980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:09,420] [INFO] [timer.py:160:stop] 0/2980, SamplesPerSec=6253.947009886043
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:11,960] [INFO] [logging.py:60:log_dist] [Rank 0] step=2990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:11,993] [INFO] [timer.py:160:stop] 0/2990, SamplesPerSec=6254.211717112902
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:14,548] [INFO] [logging.py:60:log_dist] [Rank 0] step=3000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:14,580] [INFO] [timer.py:160:stop] 0/3000, SamplesPerSec=6254.408773178976
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08251953125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.04526575 ms
avg iteration GPU training time:234.92504826 ms
avg iteration (step) total cpu time:254.19684693 ms
Epoch Time(s): 9.7787
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.5036 | Train Acc 0.8608 | Speed (samples/sec) 23179.9519 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:18,624] [INFO] [logging.py:60:log_dist] [Rank 0] step=3010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:18,658] [INFO] [timer.py:160:stop] 0/3010, SamplesPerSec=6254.473677652248
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:21,432] [INFO] [logging.py:60:log_dist] [Rank 0] step=3020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:21,466] [INFO] [timer.py:160:stop] 0/3020, SamplesPerSec=6252.7451264693445
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:24,036] [INFO] [logging.py:60:log_dist] [Rank 0] step=3030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:24,070] [INFO] [timer.py:160:stop] 0/3030, SamplesPerSec=6252.832111497003
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:26,591] [INFO] [logging.py:60:log_dist] [Rank 0] step=3040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:26,604] [INFO] [timer.py:160:stop] 0/3040, SamplesPerSec=6253.325368780164
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.98753896 ms
avg iteration GPU training time:242.03726196 ms
avg iteration (step) total cpu time:262.09649333 ms
Epoch Time(s): 9.9877
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.5197 | Train Acc 0.8520 | Speed (samples/sec) 23173.1667 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:30,737] [INFO] [logging.py:60:log_dist] [Rank 0] step=3050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:30,770] [INFO] [timer.py:160:stop] 0/3050, SamplesPerSec=6252.603012094789
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:33,364] [INFO] [logging.py:60:log_dist] [Rank 0] step=3060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:33,397] [INFO] [timer.py:160:stop] 0/3060, SamplesPerSec=6252.569574791423
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:35,952] [INFO] [logging.py:60:log_dist] [Rank 0] step=3070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:35,986] [INFO] [timer.py:160:stop] 0/3070, SamplesPerSec=6252.702216335935
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.92246630 ms
avg iteration GPU training time:238.09321877 ms
avg iteration (step) total cpu time:258.51223204 ms
Epoch Time(s): 9.8474
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07275390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.5291 | Train Acc 0.8500 | Speed (samples/sec) 23170.2152 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:40,196] [INFO] [logging.py:60:log_dist] [Rank 0] step=3080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:40,230] [INFO] [timer.py:160:stop] 0/3080, SamplesPerSec=6250.8512339708905
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:42,779] [INFO] [logging.py:60:log_dist] [Rank 0] step=3090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:42,813] [INFO] [timer.py:160:stop] 0/3090, SamplesPerSec=6250.998704403087
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:45,350] [INFO] [logging.py:60:log_dist] [Rank 0] step=3100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:45,384] [INFO] [timer.py:160:stop] 0/3100, SamplesPerSec=6251.200352120582
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.70011022 ms
avg iteration GPU training time:239.56511773 ms
avg iteration (step) total cpu time:258.83542167 ms
Epoch Time(s): 9.8810
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.5378 | Train Acc 0.8458 | Speed (samples/sec) 23165.3817 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:49,324] [INFO] [logging.py:60:log_dist] [Rank 0] step=3110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:49,357] [INFO] [timer.py:160:stop] 0/3110, SamplesPerSec=6251.427696124943
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:51,932] [INFO] [logging.py:60:log_dist] [Rank 0] step=3120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:51,966] [INFO] [timer.py:160:stop] 0/3120, SamplesPerSec=6251.452438566992
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:54,539] [INFO] [logging.py:60:log_dist] [Rank 0] step=3130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:54,573] [INFO] [timer.py:160:stop] 0/3130, SamplesPerSec=6251.538896876502
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:10.36058428 ms
avg iteration GPU training time:237.37359789 ms
avg iteration (step) total cpu time:257.36779637 ms
Epoch Time(s): 9.7307
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.5308 | Train Acc 0.8533 | Speed (samples/sec) 23165.2787 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:01:58,593] [INFO] [logging.py:60:log_dist] [Rank 0] step=3140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:01:58,626] [INFO] [timer.py:160:stop] 0/3140, SamplesPerSec=6251.1955416595065
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:02:01,068] [INFO] [logging.py:60:log_dist] [Rank 0] step=3150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:02:01,102] [INFO] [timer.py:160:stop] 0/3150, SamplesPerSec=6252.181535401161
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09619140625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:02:03,599] [INFO] [logging.py:60:log_dist] [Rank 0] step=3160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:02:03,633] [INFO] [timer.py:160:stop] 0/3160, SamplesPerSec=6252.722898178653
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09423828125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.26031768 ms
avg iteration GPU training time:226.46889129 ms
avg iteration (step) total cpu time:244.97002142 ms
Epoch Time(s): 9.4374
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.5403 | Train Acc 0.8434 | Speed (samples/sec) 23173.4316 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:02:07,476] [INFO] [logging.py:60:log_dist] [Rank 0] step=3170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:02:07,510] [INFO] [timer.py:160:stop] 0/3170, SamplesPerSec=6253.701929659371
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:02:09,958] [INFO] [logging.py:60:log_dist] [Rank 0] step=3180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:02:09,992] [INFO] [timer.py:160:stop] 0/3180, SamplesPerSec=6254.645167578312
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:02:12,364] [INFO] [logging.py:60:log_dist] [Rank 0] step=3190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:02:12,398] [INFO] [timer.py:160:stop] 0/3190, SamplesPerSec=6256.190659804746
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10791015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:02:14,792] [INFO] [logging.py:60:log_dist] [Rank 0] step=3200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:02:14,804] [INFO] [timer.py:160:stop] 0/3200, SamplesPerSec=6257.723378172317
-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.55569311 ms
avg iteration GPU training time:222.29394305 ms
avg iteration (step) total cpu time:241.04338222 ms
Epoch Time(s): 9.2899
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.5646 | Train Acc 0.8431 | Speed (samples/sec) 23186.8660 | GPU 10163.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:02:18,713] [INFO] [logging.py:60:log_dist] [Rank 0] step=3210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:02:18,747] [INFO] [timer.py:160:stop] 0/3210, SamplesPerSec=6258.515569440091
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:02:21,336] [INFO] [logging.py:60:log_dist] [Rank 0] step=3220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:02:21,370] [INFO] [timer.py:160:stop] 0/3220, SamplesPerSec=6258.347142111405
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07470703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08642578125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10595703125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.08056640625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09814453125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10009765625GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08837890625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

[2021-06-17 22:02:23,885] [INFO] [logging.py:60:log_dist] [Rank 0] step=3230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 22:02:23,917] [INFO] [timer.py:160:stop] 0/3230, SamplesPerSec=6258.696603435707
-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07861328125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.10400390625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.10205078125GB

Max Memory Allocated 9.925379753112793  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.07666015625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.08447265625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.09228515625GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.09033203125GB

Max Memory Allocated 9.925379753112793  GigaBytes

avg iteration(step) data from cpu to GPU time:9.81620389 ms
avg iteration GPU training time:233.94984888 ms
avg iteration (step) total cpu time:253.17585910 ms
Epoch Time(s): 9.5991
Eval Acc 0.8570
Test Acc: 0.6488
Avg epoch time(time.time()): 9769.400157034397 ms
total avg iteration(step) data from cpu to GPU time:9.65527319 ms
total avg iteration GPU training time:236.62610643 ms
total avg iteration (step) total cpu time:255.76607631 ms
