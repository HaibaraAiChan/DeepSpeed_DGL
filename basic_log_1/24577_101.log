[2021-06-17 21:19:22,673] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-17 21:19:26,340] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 ds_mini_batch_train.py --aggre lstm --batch-size 24577 --log-every 120 --deepspeed_config ds_config.json
[2021-06-17 21:19:27,247] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-17 21:19:27,247] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-17 21:19:27,247] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-17 21:19:27,247] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-17 21:19:27,247] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623964772.7907012
before load_ogb step Time(s): 0.0018
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20668.8515625, 'VmSize': 20541.86328125, 'VmHWM': 1165.1875, 'VmRSS': 1165.1875}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6084
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2824
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0014
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0943
-------------------------------------------------end of load ogb****************** step Time(s): 0.0071
finish constructing ogbn-products
load ogb-products time total: 1.993983507156372
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 1.9947
after inductive else step Time(s): 0.0000
after label step Time(s): 3.7458
after train_g.create_formats_() step Time(s): 1.6946
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 24577
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-17 21:19:40,259] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.4.1+unknown, git-hash=unknown, git-branch=unknown
[2021-06-17 21:19:40,259] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-17 21:19:40,262] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-17 21:19:42,603] [INFO] [engine.py:173:__init__] DeepSpeed Flops Profiler Enabled: False
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/cc/.cache/torch_extensions/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 1.3915801048278809 seconds
[2021-06-17 21:19:45,358] [INFO] [engine.py:693:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-17 21:19:45,359] [INFO] [engine.py:697:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-17 21:19:45,359] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-17 21:19:45,359] [INFO] [engine.py:505:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-17 21:19:45,359] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f5150971208>
[2021-06-17 21:19:45,359] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:19:45,359] [INFO] [config.py:900:print] DeepSpeedEngine configuration:
[2021-06-17 21:19:45,359] [INFO] [config.py:904:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-17 21:19:45,359] [INFO] [config.py:904:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-17 21:19:45,359] [INFO] [config.py:904:print]   allreduce_always_fp32 ........ False
[2021-06-17 21:19:45,359] [INFO] [config.py:904:print]   amp_enabled .................. False
[2021-06-17 21:19:45,359] [INFO] [config.py:904:print]   amp_params ................... False
[2021-06-17 21:19:45,359] [INFO] [config.py:904:print]   checkpoint_tag_validation_enabled  True
[2021-06-17 21:19:45,359] [INFO] [config.py:904:print]   checkpoint_tag_validation_fail  False
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   disable_allgather ............ False
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   dump_state ................... False
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   dynamic_loss_scale_args ...... None
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   eigenvalue_enabled ........... False
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   eigenvalue_gas_boundary_resolution  1
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   eigenvalue_layer_num ......... 0
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   eigenvalue_max_iter .......... 100
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   eigenvalue_stability ......... 1e-06
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   eigenvalue_tol ............... 0.01
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   eigenvalue_verbose ........... False
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   elasticity_enabled ........... False
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   fp16_enabled ................. False
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   fp16_mixed_quantize .......... False
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   global_rank .................. 0
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   gradient_accumulation_steps .. 1
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   gradient_clipping ............ 0.0
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   gradient_predivide_factor .... 1.0
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   initial_dynamic_scale ........ 4294967296
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   loss_scale ................... 0
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   memory_breakdown ............. False
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   optimizer_legacy_fusion ...... False
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   optimizer_name ............... adam
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   pld_enabled .................. False
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   pld_params ................... False
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   prescale_gradients ........... False
[2021-06-17 21:19:45,360] [INFO] [config.py:904:print]   quantize_change_rate ......... 0.001
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   quantize_groups .............. 1
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   quantize_offset .............. 1000
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   quantize_period .............. 1000
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   quantize_rounding ............ 0
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   quantize_start_bits .......... 16
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   quantize_target_bits ......... 8
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   quantize_training_enabled .... False
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   quantize_type ................ 0
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   quantize_verbose ............. False
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   scheduler_name ............... WarmupLR
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   sparse_attention ............. None
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   sparse_gradients_enabled ..... False
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   steps_per_print .............. 10
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   tensorboard_enabled .......... False
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   tensorboard_output_path ...... 
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   train_batch_size ............. 1500
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   train_micro_batch_size_per_gpu  1500
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   use_quantizer_kernel ......... False
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   wall_clock_breakdown ......... False
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   world_size ................... 1
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   zero_allow_untested_optimizer  False
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": true, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true, 
    "legacy_stage1": false
}
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   zero_enabled ................. False
[2021-06-17 21:19:45,361] [INFO] [config.py:904:print]   zero_optimization_stage ...... 0
[2021-06-17 21:19:45,363] [INFO] [config.py:912:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Emitting ninja build file /home/cc/.cache/torch_extensions/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 1.4140937328338623 seconds
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.78564453125GB

Max Memory Allocated 1.3897433280944824  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.88720703125GB

Max Memory Allocated 1.3897433280944824  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.19189453125GB

Max Memory Allocated 27.326406478881836  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.19189453125GB

Max Memory Allocated 27.326406478881836  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.21728515625GB

Max Memory Allocated 27.326406478881836  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.21728515625GB

Max Memory Allocated 27.326406478881836  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7976 | Train Acc 0.0336 | Speed (samples/sec) nan | GPU 27982.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.15478515625GB

Max Memory Allocated 27.326406478881836  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.15478515625GB

Max Memory Allocated 27.326406478881836  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.19384765625GB

Max Memory Allocated 27.326406478881836  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.88525390625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85986328125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.86962890625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.86962890625GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80712890625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80712890625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.88525390625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.85986328125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.86962890625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.86962890625GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80517578125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80517578125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.84423828125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.35009765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.34814453125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32275390625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33251953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33251953125GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.35009765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27197265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27197265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.35009765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.35009765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

avg iteration(step) data from cpu to GPU time:25.93357849 ms
avg iteration GPU training time:443.96440633 ms
avg iteration (step) total cpu time:485.63162486 ms
Epoch Time(s): 8.3448
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27197265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27197265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.35009765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32275390625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33251953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33251953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

Epoch 00001 | Step 00000 | Loss 1.7309 | Train Acc 0.5181 | Speed (samples/sec) 43602.8720 | GPU 28104.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.34814453125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33251953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

[2021-06-17 21:19:58,221] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-17 21:19:58,335] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=3425.752429325495
-----------------------------------------after batch engine step
 Nvidia-smi: 31.33251953125GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.35009765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.35009765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27197265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27197265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.35009765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32275390625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33251953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33251953125GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.34814453125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33251953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33251953125GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.35009765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.35009765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

avg iteration(step) data from cpu to GPU time:22.59292793 ms
avg iteration GPU training time:438.35858154 ms
avg iteration (step) total cpu time:485.20684242 ms
Epoch Time(s): 6.3865
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27197265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27197265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.35009765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

Epoch 00002 | Step 00000 | Loss 1.0175 | Train Acc 0.7365 | Speed (samples/sec) 44791.2715 | GPU 28104.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.34814453125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33251953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33251953125GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.35009765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.34814453125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33251953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

[2021-06-17 21:20:05,627] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:20:05,738] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=3432.122615708683
-----------------------------------------after batch engine step
 Nvidia-smi: 31.33251953125GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.35009765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.35009765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32666015625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.35009765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.32470703125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.27001953125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.74267578125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.71728515625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.72705078125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.72705078125GB

Max Memory Allocated 27.44609260559082  GigaBytes

avg iteration(step) data from cpu to GPU time:21.90410678 ms
avg iteration GPU training time:467.12918091 ms
avg iteration (step) total cpu time:506.07879957 ms
Epoch Time(s): 6.5003
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.70361328125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.74267578125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.71533203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.72509765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.72509765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.7136 | Train Acc 0.8287 | Speed (samples/sec) 44773.1841 | GPU 28104.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.70166015625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.74267578125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.71728515625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.72705078125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.72705078125GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.70361328125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.74267578125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.71533203125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.72509765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.72509765625GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.70166015625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.74072265625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.71728515625GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.72705078125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.72705078125GB

Max Memory Allocated 27.44609260559082  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.70361328125GB

Max Memory Allocated 27.44609260559082  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.74462890625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.71728515625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.72705078125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.72705078125GB

Max Memory Allocated 27.4468936920166  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.70166015625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.74072265625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.71728515625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.72509765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

[2021-06-17 21:20:12,981] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:20:13,095] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=3423.785346697958
-----------------------------------------after batch engine step
 Nvidia-smi: 29.72509765625GB

Max Memory Allocated 27.4468936920166  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.70166015625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.74072265625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.71533203125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.72509765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.72509765625GB

Max Memory Allocated 27.4468936920166  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.70166015625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.4468936920166  GigaBytes

avg iteration(step) data from cpu to GPU time:30.03593572 ms
avg iteration GPU training time:433.34002686 ms
avg iteration (step) total cpu time:477.55901019 ms
Epoch Time(s): 6.2476
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17236328125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.4468936920166  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.5643 | Train Acc 0.8676 | Speed (samples/sec) 45326.5303 | GPU 28105.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.4468936920166  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.4468936920166  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.4468936920166  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17236328125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.4468936920166  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.4468936920166  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.4468936920166  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

[2021-06-17 21:20:20,146] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:20:20,256] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=3424.7424918058414
-----------------------------------------after batch engine step
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

avg iteration(step) data from cpu to GPU time:22.72469330 ms
avg iteration GPU training time:431.03232829 ms
avg iteration (step) total cpu time:469.62324778 ms
Epoch Time(s): 6.2679
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.4468936920166  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.4802 | Train Acc 0.8855 | Speed (samples/sec) 45545.8142 | GPU 28113.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17236328125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

avg iteration(step) data from cpu to GPU time:24.74681600 ms
avg iteration GPU training time:432.22830200 ms
avg iteration (step) total cpu time:471.65282567 ms
Epoch Time(s): 6.3682
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.4406 | Train Acc 0.8908 | Speed (samples/sec) 45690.3085 | GPU 28113.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

[2021-06-17 21:20:29,964] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:20:30,078] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=3425.369103535804
-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17236328125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18408203125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17236328125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

avg iteration(step) data from cpu to GPU time:25.92750994 ms
avg iteration GPU training time:439.39384969 ms
avg iteration (step) total cpu time:481.08967145 ms
Epoch Time(s): 6.3194
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18408203125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.4150 | Train Acc 0.8950 | Speed (samples/sec) 45778.4504 | GPU 28113.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17236328125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

[2021-06-17 21:20:37,218] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:20:37,330] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=3434.199645200398
-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17236328125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17236328125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

avg iteration(step) data from cpu to GPU time:27.09611766 ms
avg iteration GPU training time:430.22701009 ms
avg iteration (step) total cpu time:470.90196609 ms
Epoch Time(s): 6.3062
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.20947265625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18408203125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.3933 | Train Acc 0.8993 | Speed (samples/sec) 45855.3081 | GPU 28113.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17236328125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18408203125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17236328125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18408203125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.19384765625GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13134765625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17041015625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.18603515625GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

[2021-06-17 21:20:44,662] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:20:44,775] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=3434.9706370028994
-----------------------------------------after batch engine step
 Nvidia-smi: 31.19580078125GB

Max Memory Allocated 27.454233646392822  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.13330078125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.17236328125GB

Max Memory Allocated 27.454233646392822  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.37548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.34814453125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.35791015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.35791015625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.29345703125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.29345703125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.33251953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52197265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.49853515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:24.17491213 ms
avg iteration GPU training time:619.90941366 ms
avg iteration (step) total cpu time:657.04695384 ms
Epoch Time(s): 7.0257
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44189453125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44189453125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52197265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.3831 | Train Acc 0.9004 | Speed (samples/sec) 45489.9612 | GPU 28125.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44189453125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44189453125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52197265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52197265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44189453125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44189453125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52197265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48291015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52392578125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44189453125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44189453125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48095703125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.64501953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59228515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59228515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.64501953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59033203125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59033203125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.64697265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

[2021-06-17 21:20:52,827] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:20:52,940] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=3371.6418121796105
-----------------------------------------after batch engine step
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:26.40140851 ms
avg iteration GPU training time:439.11466471 ms
avg iteration (step) total cpu time:480.36813736 ms
Epoch Time(s): 6.6513
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59033203125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59033203125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.64501953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.3637 | Train Acc 0.9060 | Speed (samples/sec) 45431.0716 | GPU 28125.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59033203125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59033203125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.62939453125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.64501953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59228515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59228515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14306640625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11767578125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11376953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11376953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:26.55973307 ms
avg iteration GPU training time:428.55032349 ms
avg iteration (step) total cpu time:470.50865491 ms
Epoch Time(s): 6.4183
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14306640625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.3574 | Train Acc 0.9063 | Speed (samples/sec) 45373.8968 | GPU 28125.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

[2021-06-17 21:21:02,836] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:21:02,950] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=3366.419645884655
-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14306640625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:21.60857582 ms
avg iteration GPU training time:438.30901082 ms
avg iteration (step) total cpu time:477.48430570 ms
Epoch Time(s): 6.4748
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11376953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.3617 | Train Acc 0.9050 | Speed (samples/sec) 45416.4511 | GPU 28125.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14306640625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

[2021-06-17 21:21:10,317] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:21:10,424] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=3371.403893902028
-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:21.85464541 ms
avg iteration GPU training time:436.84457397 ms
avg iteration (step) total cpu time:472.11790085 ms
Epoch Time(s): 6.5322
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11376953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.3369 | Train Acc 0.9111 | Speed (samples/sec) 45439.6045 | GPU 28125.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11376953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11376953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

[2021-06-17 21:21:18,201] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:21:18,313] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=3374.828950789502
-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:24.73924255 ms
avg iteration GPU training time:450.56382243 ms
avg iteration (step) total cpu time:490.29890696 ms
Epoch Time(s): 6.9338
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.3329 | Train Acc 0.9099 | Speed (samples/sec) 45387.2623 | GPU 28125.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11376953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

[2021-06-17 21:21:25,767] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:21:25,881] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=3375.373848147784
-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:24.91698138 ms
avg iteration GPU training time:455.01594035 ms
avg iteration (step) total cpu time:494.11249161 ms
Epoch Time(s): 6.6259
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.3219 | Train Acc 0.9152 | Speed (samples/sec) 45430.5988 | GPU 28125.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11376953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:23.20938619 ms
avg iteration GPU training time:440.42735799 ms
avg iteration (step) total cpu time:480.51468531 ms
Epoch Time(s): 6.5536
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14306640625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.3301 | Train Acc 0.9112 | Speed (samples/sec) 45483.5179 | GPU 28125.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11767578125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

[2021-06-17 21:21:36,040] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:21:36,151] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=3375.8969154364004
-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11376953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:24.71132851 ms
avg iteration GPU training time:431.00880941 ms
avg iteration (step) total cpu time:470.13680140 ms
Epoch Time(s): 6.5108
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.3104 | Train Acc 0.9165 | Speed (samples/sec) 45501.5998 | GPU 28125.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11767578125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11376953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

[2021-06-17 21:21:43,304] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:21:43,417] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=3380.0519901910316
-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:25.46508789 ms
avg iteration GPU training time:432.29419963 ms
avg iteration (step) total cpu time:471.30568822 ms
Epoch Time(s): 6.3299
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.3143 | Train Acc 0.9163 | Speed (samples/sec) 45542.0443 | GPU 28125.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11376953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11767578125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

[2021-06-17 21:21:50,629] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:21:50,744] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=3387.005440437953
-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11767578125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

avg iteration(step) data from cpu to GPU time:31.09042104 ms
avg iteration GPU training time:437.36285400 ms
avg iteration (step) total cpu time:486.29625638 ms
Epoch Time(s): 6.4108
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.13916015625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11376953125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12353515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.3148 | Train Acc 0.9159 | Speed (samples/sec) 45578.1959 | GPU 28125.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10009765625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.14111328125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.11572265625GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.12548828125GB

Max Memory Allocated 27.466110229492188  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.10205078125GB

Max Memory Allocated 27.466110229492188  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.38525390625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.35791015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.36767578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.36767578125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.30322265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.30322265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.34228515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.35986328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.36767578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.36767578125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.30322265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.30322265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.34228515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.38134765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.35595703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.36572265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.36572265625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.30322265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.30322265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.34228515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:21:58,598] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:21:58,713] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=3369.0928650876185
-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:28.28281593 ms
avg iteration GPU training time:415.73953247 ms
avg iteration (step) total cpu time:456.90433184 ms
Epoch Time(s): 6.9629
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50244140625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.2999 | Train Acc 0.9183 | Speed (samples/sec) 45499.9536 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50244140625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52783203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52783203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50244140625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:24.58881060 ms
avg iteration GPU training time:435.66466268 ms
avg iteration (step) total cpu time:473.54459763 ms
Epoch Time(s): 6.5666
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50244140625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.3110 | Train Acc 0.9169 | Speed (samples/sec) 45509.7451 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52783203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:22:08,654] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:22:08,766] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=3371.5634691057535
-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52783203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:27.14560000 ms
avg iteration GPU training time:431.49539185 ms
avg iteration (step) total cpu time:472.54133224 ms
Epoch Time(s): 6.3397
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50244140625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.3053 | Train Acc 0.9176 | Speed (samples/sec) 45591.6147 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50244140625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:22:17,009] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:22:17,121] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=3374.481880161166
-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:24.84465090 ms
avg iteration GPU training time:429.93774414 ms
avg iteration (step) total cpu time:473.43738874 ms
Epoch Time(s): 7.4745
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.3003 | Train Acc 0.9190 | Speed (samples/sec) 45394.9362 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:22:24,524] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:22:24,637] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=3378.569300795177
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65087890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:26.48708280 ms
avg iteration GPU training time:432.28591919 ms
avg iteration (step) total cpu time:476.16187731 ms
Epoch Time(s): 6.5219
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65087890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.2965 | Train Acc 0.9205 | Speed (samples/sec) 45416.0454 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65087890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:22:32,348] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:22:32,457] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=3382.7773714929663
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:25.23698107 ms
avg iteration GPU training time:435.96830241 ms
avg iteration (step) total cpu time:477.20289230 ms
Epoch Time(s): 6.8608
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.2932 | Train Acc 0.9196 | Speed (samples/sec) 45452.0115 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65087890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:26.46451124 ms
avg iteration GPU training time:419.07110596 ms
avg iteration (step) total cpu time:462.62311935 ms
Epoch Time(s): 6.4312
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65087890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.3003 | Train Acc 0.9187 | Speed (samples/sec) 45521.3606 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:22:42,393] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:22:42,506] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=3386.4872414250517
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65087890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65087890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:26.58045832 ms
avg iteration GPU training time:432.32029215 ms
avg iteration (step) total cpu time:474.51011340 ms
Epoch Time(s): 6.4640
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.2978 | Train Acc 0.9201 | Speed (samples/sec) 45530.9455 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:22:49,850] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:22:49,963] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=3388.554722571681
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65087890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:27.83783404 ms
avg iteration GPU training time:424.61304728 ms
avg iteration (step) total cpu time:466.62799517 ms
Epoch Time(s): 6.5074
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.2867 | Train Acc 0.9217 | Speed (samples/sec) 45583.0969 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65087890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:22:57,247] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:22:57,361] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=3390.548543059452
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:25.16196251 ms
avg iteration GPU training time:417.37516276 ms
avg iteration (step) total cpu time:457.49107997 ms
Epoch Time(s): 6.4201
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.2842 | Train Acc 0.9226 | Speed (samples/sec) 45620.4541 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67626953125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65087890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66064453125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.59814453125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63720703125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:23:04,565] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:23:04,675] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=3393.3201658810904
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:23.54565366 ms
avg iteration GPU training time:435.62894694 ms
avg iteration (step) total cpu time:475.66715876 ms
Epoch Time(s): 6.3768
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.2890 | Train Acc 0.9199 | Speed (samples/sec) 45648.9430 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:25.71032588 ms
avg iteration GPU training time:426.21405029 ms
avg iteration (step) total cpu time:467.22245216 ms
Epoch Time(s): 6.3249
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.2979 | Train Acc 0.9189 | Speed (samples/sec) 45688.3895 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:23:14,443] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:23:14,556] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=3397.1142859335655
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:22.56495984 ms
avg iteration GPU training time:438.84544881 ms
avg iteration (step) total cpu time:476.05625788 ms
Epoch Time(s): 6.3828
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.2717 | Train Acc 0.9255 | Speed (samples/sec) 45739.4454 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:23:21,837] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:23:21,950] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=3400.4198486516243
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:25.80647469 ms
avg iteration GPU training time:431.07178752 ms
avg iteration (step) total cpu time:471.67205811 ms
Epoch Time(s): 6.4613
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.2730 | Train Acc 0.9245 | Speed (samples/sec) 45764.3470 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:23:29,341] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:23:29,453] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=3402.063823363995
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:21.21143468 ms
avg iteration GPU training time:428.37801107 ms
avg iteration (step) total cpu time:462.87926038 ms
Epoch Time(s): 6.5314
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.2725 | Train Acc 0.9253 | Speed (samples/sec) 45778.3281 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:23:36,652] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:23:36,762] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=3405.017140134636
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:24.51043193 ms
avg iteration GPU training time:428.33238729 ms
avg iteration (step) total cpu time:466.27012889 ms
Epoch Time(s): 6.3919
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.2825 | Train Acc 0.9225 | Speed (samples/sec) 45804.5798 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:27.19085821 ms
avg iteration GPU training time:429.68110148 ms
avg iteration (step) total cpu time:473.75885646 ms
Epoch Time(s): 6.7730
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.2633 | Train Acc 0.9268 | Speed (samples/sec) 45760.6139 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:23:47,409] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:23:47,522] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=3403.768652983275
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:21.57194646 ms
avg iteration GPU training time:438.26487223 ms
avg iteration (step) total cpu time:474.40179189 ms
Epoch Time(s): 6.8877
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.2771 | Train Acc 0.9245 | Speed (samples/sec) 45759.4211 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:23:54,972] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:23:55,086] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=3406.129720356921
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:28.18781853 ms
avg iteration GPU training time:418.10713704 ms
avg iteration (step) total cpu time:460.89744568 ms
Epoch Time(s): 6.5437
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.2762 | Train Acc 0.9240 | Speed (samples/sec) 45804.7039 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:24:02,672] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:24:02,785] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=3410.1180328152846
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:25.37363180 ms
avg iteration GPU training time:423.64214071 ms
avg iteration (step) total cpu time:463.14183871 ms
Epoch Time(s): 6.7871
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.2808 | Train Acc 0.9244 | Speed (samples/sec) 45836.3225 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:24:10,061] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:24:10,173] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=3410.866685979561
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:23.33962631 ms
avg iteration GPU training time:442.74862671 ms
avg iteration (step) total cpu time:481.33476575 ms
Epoch Time(s): 6.4212
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.2746 | Train Acc 0.9242 | Speed (samples/sec) 45828.9142 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:23.31749344 ms
avg iteration GPU training time:424.21274821 ms
avg iteration (step) total cpu time:463.19635709 ms
Epoch Time(s): 6.3712
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.2781 | Train Acc 0.9224 | Speed (samples/sec) 45851.4011 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:24:20,352] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:24:20,466] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=3411.9437344220555
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:28.22247442 ms
avg iteration GPU training time:460.94411214 ms
avg iteration (step) total cpu time:505.42688370 ms
Epoch Time(s): 6.9087
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.2703 | Train Acc 0.9251 | Speed (samples/sec) 45835.5055 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:24:27,948] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:24:28,060] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=3409.028977451535
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:24.95697021 ms
avg iteration GPU training time:447.90739950 ms
avg iteration (step) total cpu time:488.46737544 ms
Epoch Time(s): 6.5890
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.2792 | Train Acc 0.9229 | Speed (samples/sec) 45807.9121 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:24:35,590] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:24:35,702] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=3408.7866519034715
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:22.61549886 ms
avg iteration GPU training time:428.81636556 ms
avg iteration (step) total cpu time:466.09338125 ms
Epoch Time(s): 6.5929
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.2754 | Train Acc 0.9241 | Speed (samples/sec) 45821.3383 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:24:42,908] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:24:43,021] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=3410.8664541259614
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:25.69133822 ms
avg iteration GPU training time:426.05312093 ms
avg iteration (step) total cpu time:467.83343951 ms
Epoch Time(s): 6.3925
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.2677 | Train Acc 0.9242 | Speed (samples/sec) 45845.0168 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:22.80100250 ms
avg iteration GPU training time:434.08964030 ms
avg iteration (step) total cpu time:472.77744611 ms
Epoch Time(s): 6.4489
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.2777 | Train Acc 0.9248 | Speed (samples/sec) 45853.5803 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:24:52,998] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:24:53,111] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=3410.9042007606636
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:25.75853920 ms
avg iteration GPU training time:431.87933350 ms
avg iteration (step) total cpu time:471.70178095 ms
Epoch Time(s): 6.4703
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.2659 | Train Acc 0.9273 | Speed (samples/sec) 45873.0038 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:25:00,444] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:25:00,557] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=3410.4286056996325
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:28.62425550 ms
avg iteration GPU training time:435.16304525 ms
avg iteration (step) total cpu time:478.10562452 ms
Epoch Time(s): 6.5467
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.2707 | Train Acc 0.9260 | Speed (samples/sec) 45859.0828 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:25:07,868] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:25:07,984] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=3411.870167373203
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:23.62943967 ms
avg iteration GPU training time:438.48739624 ms
avg iteration (step) total cpu time:477.66947746 ms
Epoch Time(s): 6.4784
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.2619 | Train Acc 0.9277 | Speed (samples/sec) 45867.8842 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:25:15,381] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:25:15,495] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=3412.9515455932465
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:23.97521083 ms
avg iteration GPU training time:429.02142334 ms
avg iteration (step) total cpu time:466.82310104 ms
Epoch Time(s): 6.5429
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.2717 | Train Acc 0.9262 | Speed (samples/sec) 45880.6745 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:25.10599454 ms
avg iteration GPU training time:430.58435059 ms
avg iteration (step) total cpu time:470.05112966 ms
Epoch Time(s): 6.6344
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.2654 | Train Acc 0.9260 | Speed (samples/sec) 45896.2066 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:25:25,682] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:25:25,795] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=3413.8760757557525
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:24.36995188 ms
avg iteration GPU training time:430.98675537 ms
avg iteration (step) total cpu time:471.82059288 ms
Epoch Time(s): 6.4972
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.2671 | Train Acc 0.9259 | Speed (samples/sec) 45910.9594 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:25:33,132] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:25:33,246] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=3414.7356281433294
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:24.96135457 ms
avg iteration GPU training time:437.48234049 ms
avg iteration (step) total cpu time:479.95360692 ms
Epoch Time(s): 6.5395
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.2586 | Train Acc 0.9288 | Speed (samples/sec) 45897.8521 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:25:40,522] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:25:40,636] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=3415.3281467785196
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:26.97406960 ms
avg iteration GPU training time:441.17830404 ms
avg iteration (step) total cpu time:485.92702548 ms
Epoch Time(s): 6.4323
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.2542 | Train Acc 0.9296 | Speed (samples/sec) 45888.6820 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:25:48,039] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:25:48,152] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=3413.728711444652
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:26.45789909 ms
avg iteration GPU training time:430.89945475 ms
avg iteration (step) total cpu time:473.19618861 ms
Epoch Time(s): 6.5289
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.2859 | Train Acc 0.9225 | Speed (samples/sec) 45873.4022 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:23.43779246 ms
avg iteration GPU training time:428.93291219 ms
avg iteration (step) total cpu time:468.44673157 ms
Epoch Time(s): 6.3706
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.2617 | Train Acc 0.9283 | Speed (samples/sec) 45888.1223 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:25:58,023] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:25:58,136] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=3414.3366456859235
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:24.85874112 ms
avg iteration GPU training time:430.92646281 ms
avg iteration (step) total cpu time:469.24527486 ms
Epoch Time(s): 6.4520
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.2501 | Train Acc 0.9301 | Speed (samples/sec) 45896.4628 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:26:05,443] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:26:05,558] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=3415.5252988509083
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:28.09222412 ms
avg iteration GPU training time:425.38791911 ms
avg iteration (step) total cpu time:467.49909719 ms
Epoch Time(s): 6.4872
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.2593 | Train Acc 0.9271 | Speed (samples/sec) 45924.4899 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:26:12,837] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:26:12,952] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=3417.4367012716125
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:30.14850171 ms
avg iteration GPU training time:432.15820312 ms
avg iteration (step) total cpu time:477.32369105 ms
Epoch Time(s): 6.4493
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.2569 | Train Acc 0.9274 | Speed (samples/sec) 45931.6486 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:26:20,222] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:26:20,338] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=3418.7992354339985
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:24.39508247 ms
avg iteration GPU training time:427.98940023 ms
avg iteration (step) total cpu time:467.37297376 ms
Epoch Time(s): 6.4636
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.2516 | Train Acc 0.9310 | Speed (samples/sec) 45943.7799 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:24.57113584 ms
avg iteration GPU training time:433.98225911 ms
avg iteration (step) total cpu time:472.70258268 ms
Epoch Time(s): 6.4473
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.2601 | Train Acc 0.9288 | Speed (samples/sec) 45949.9395 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:26:30,244] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:26:30,359] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=3420.159148642425
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:26.13708814 ms
avg iteration GPU training time:440.47202555 ms
avg iteration (step) total cpu time:483.67770513 ms
Epoch Time(s): 6.4660
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.2597 | Train Acc 0.9288 | Speed (samples/sec) 45943.7198 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:26:37,791] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:26:37,905] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=3420.0115381239443
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:21.87735494 ms
avg iteration GPU training time:435.03895060 ms
avg iteration (step) total cpu time:470.65130870 ms
Epoch Time(s): 6.4933
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.2614 | Train Acc 0.9277 | Speed (samples/sec) 45956.4616 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:26:45,171] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:26:45,280] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=3420.839187004917
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:24.61287498 ms
avg iteration GPU training time:437.89449056 ms
avg iteration (step) total cpu time:477.03830401 ms
Epoch Time(s): 6.4527
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.2600 | Train Acc 0.9286 | Speed (samples/sec) 45954.4821 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:26:52,475] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:26:52,587] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=3421.8373397879586
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:27.25270335 ms
avg iteration GPU training time:431.88845825 ms
avg iteration (step) total cpu time:473.71403376 ms
Epoch Time(s): 6.3862
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.2759 | Train Acc 0.9278 | Speed (samples/sec) 45967.6066 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:23.75112470 ms
avg iteration GPU training time:432.71652222 ms
avg iteration (step) total cpu time:470.86199125 ms
Epoch Time(s): 6.3699
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.2649 | Train Acc 0.9272 | Speed (samples/sec) 45976.3989 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:27:02,459] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:27:02,573] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=3422.5534967016365
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:22.46854464 ms
avg iteration GPU training time:428.50142415 ms
avg iteration (step) total cpu time:466.65676435 ms
Epoch Time(s): 6.5206
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.2563 | Train Acc 0.9281 | Speed (samples/sec) 45979.5902 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:27:10,701] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:27:10,816] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=3423.9384964788096
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:23.33881632 ms
avg iteration GPU training time:433.00249227 ms
avg iteration (step) total cpu time:470.04938126 ms
Epoch Time(s): 7.2081
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.2595 | Train Acc 0.9286 | Speed (samples/sec) 45990.0663 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:27:18,013] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:27:18,127] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=3425.8580121805517
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:22.57618141 ms
avg iteration GPU training time:423.65747070 ms
avg iteration (step) total cpu time:461.79461479 ms
Epoch Time(s): 6.3506
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.2608 | Train Acc 0.9267 | Speed (samples/sec) 46014.9897 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:27:25,468] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:27:25,582] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=3427.1622224805114
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:24.30841573 ms
avg iteration GPU training time:429.35796102 ms
avg iteration (step) total cpu time:467.06875165 ms
Epoch Time(s): 6.5215
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.2531 | Train Acc 0.9296 | Speed (samples/sec) 46027.2583 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:24.73159472 ms
avg iteration GPU training time:428.29108683 ms
avg iteration (step) total cpu time:471.36688232 ms
Epoch Time(s): 6.4366
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.2644 | Train Acc 0.9268 | Speed (samples/sec) 46035.8073 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:27:35,437] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:27:35,551] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=3428.500041819763
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:29.02626101 ms
avg iteration GPU training time:442.58699544 ms
avg iteration (step) total cpu time:485.61072350 ms
Epoch Time(s): 6.3674
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.2606 | Train Acc 0.9271 | Speed (samples/sec) 46039.7094 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:27:42,814] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:27:42,927] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=3429.229563085566
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:26.24433072 ms
avg iteration GPU training time:426.48578898 ms
avg iteration (step) total cpu time:466.64881706 ms
Epoch Time(s): 6.4244
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.2446 | Train Acc 0.9315 | Speed (samples/sec) 46054.0017 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:27:50,168] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:27:50,281] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=3429.8514870007357
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:22.88771184 ms
avg iteration GPU training time:420.80275472 ms
avg iteration (step) total cpu time:459.81319745 ms
Epoch Time(s): 6.4267
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.2512 | Train Acc 0.9292 | Speed (samples/sec) 46065.2334 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:27:57,598] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:27:57,712] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=3430.107328992252
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:23.66866175 ms
avg iteration GPU training time:431.96182251 ms
avg iteration (step) total cpu time:469.58009402 ms
Epoch Time(s): 6.5008
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.2693 | Train Acc 0.9262 | Speed (samples/sec) 46061.4247 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:26.24775441 ms
avg iteration GPU training time:436.87261963 ms
avg iteration (step) total cpu time:478.12477748 ms
Epoch Time(s): 6.4377
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.2576 | Train Acc 0.9275 | Speed (samples/sec) 46063.0953 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:28:07,690] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:28:07,802] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=3430.8406204790704
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:33.32835134 ms
avg iteration GPU training time:437.95308431 ms
avg iteration (step) total cpu time:487.47547468 ms
Epoch Time(s): 6.5239
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.2537 | Train Acc 0.9306 | Speed (samples/sec) 46062.7388 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:28:15,195] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:28:15,308] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=3431.26294144934
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:26.47930654 ms
avg iteration GPU training time:434.86486816 ms
avg iteration (step) total cpu time:476.37430827 ms
Epoch Time(s): 6.5140
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.2502 | Train Acc 0.9300 | Speed (samples/sec) 46059.5877 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:28:22,689] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:28:22,803] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=3431.4134851891827
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:27.10620880 ms
avg iteration GPU training time:420.66599528 ms
avg iteration (step) total cpu time:461.86669668 ms
Epoch Time(s): 6.5481
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.2532 | Train Acc 0.9284 | Speed (samples/sec) 46069.8577 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:28:30,191] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:28:30,304] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=3432.037999618331
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:25.71272532 ms
avg iteration GPU training time:423.45846558 ms
avg iteration (step) total cpu time:463.66484960 ms
Epoch Time(s): 6.5698
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.2507 | Train Acc 0.9296 | Speed (samples/sec) 46070.2337 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:32.24279531 ms
avg iteration GPU training time:431.76083374 ms
avg iteration (step) total cpu time:480.22174835 ms
Epoch Time(s): 6.4404
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.2505 | Train Acc 0.9291 | Speed (samples/sec) 46071.3391 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:28:40,462] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:28:40,576] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=3432.1620528334615
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:25.57138125 ms
avg iteration GPU training time:427.84462484 ms
avg iteration (step) total cpu time:466.93476041 ms
Epoch Time(s): 6.6107
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.2550 | Train Acc 0.9291 | Speed (samples/sec) 46086.8270 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:28:47,822] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:28:47,937] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=3431.9189497248994
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:23.56107775 ms
avg iteration GPU training time:429.62470500 ms
avg iteration (step) total cpu time:470.83973885 ms
Epoch Time(s): 6.4292
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.2580 | Train Acc 0.9289 | Speed (samples/sec) 46085.2841 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:28:55,161] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:28:55,274] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=3432.5115553911605
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:26.15372785 ms
avg iteration GPU training time:429.90902710 ms
avg iteration (step) total cpu time:473.51662318 ms
Epoch Time(s): 6.4352
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.2559 | Train Acc 0.9281 | Speed (samples/sec) 46092.4315 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:29:02,567] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:29:02,680] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=3433.1952598409216
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:27.58279483 ms
avg iteration GPU training time:423.71616618 ms
avg iteration (step) total cpu time:466.96162224 ms
Epoch Time(s): 6.4152
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.2551 | Train Acc 0.9283 | Speed (samples/sec) 46098.5158 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:26.45356814 ms
avg iteration GPU training time:446.03923543 ms
avg iteration (step) total cpu time:487.17045784 ms
Epoch Time(s): 6.4839
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.2510 | Train Acc 0.9296 | Speed (samples/sec) 46087.1823 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:29:12,640] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:29:12,754] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=3431.4006583737564
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:27.77602132 ms
avg iteration GPU training time:425.15200806 ms
avg iteration (step) total cpu time:472.26579984 ms
Epoch Time(s): 6.4682
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.2584 | Train Acc 0.9282 | Speed (samples/sec) 46088.5118 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:29:20,180] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:29:20,294] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=3430.601190977648
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:24.12149302 ms
avg iteration GPU training time:427.90181478 ms
avg iteration (step) total cpu time:465.66454569 ms
Epoch Time(s): 6.5637
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.2422 | Train Acc 0.9308 | Speed (samples/sec) 46085.2532 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

[2021-06-17 21:29:27,568] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:29:27,677] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=3431.9117283147707
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

avg iteration(step) data from cpu to GPU time:24.18336042 ms
avg iteration GPU training time:427.72510783 ms
avg iteration (step) total cpu time:466.16268158 ms
Epoch Time(s): 6.4113
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.2512 | Train Acc 0.9307 | Speed (samples/sec) 46101.5117 | GPU 28161.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65283203125GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66259765625GB

Max Memory Allocated 27.50135087966919  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60009765625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.63916015625GB

Max Memory Allocated 27.50135087966919  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70361328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.67822265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.68798828125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.68798828125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.62548828125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.62548828125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

[2021-06-17 21:29:35,011] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:29:35,125] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=3431.488382827527
-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

avg iteration(step) data from cpu to GPU time:24.30681547 ms
avg iteration GPU training time:433.44233195 ms
avg iteration (step) total cpu time:472.69026438 ms
Epoch Time(s): 6.5624
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.2553 | Train Acc 0.9277 | Speed (samples/sec) 46094.7712 | GPU 28196.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

avg iteration(step) data from cpu to GPU time:23.02281634 ms
avg iteration GPU training time:433.70214844 ms
avg iteration (step) total cpu time:471.24481201 ms
Epoch Time(s): 6.2684
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71337890625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.2548 | Train Acc 0.9276 | Speed (samples/sec) 46111.5667 | GPU 28196.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

[2021-06-17 21:29:44,997] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:29:45,104] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=3432.8059356044973
-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

avg iteration(step) data from cpu to GPU time:24.24583499 ms
avg iteration GPU training time:425.12578328 ms
avg iteration (step) total cpu time:462.69567808 ms
Epoch Time(s): 6.5217
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.2563 | Train Acc 0.9281 | Speed (samples/sec) 46117.2456 | GPU 28196.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

[2021-06-17 21:29:52,296] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:29:52,410] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=3433.853354752697
-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68798828125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

avg iteration(step) data from cpu to GPU time:24.65587234 ms
avg iteration GPU training time:430.72628784 ms
avg iteration (step) total cpu time:473.82386525 ms
Epoch Time(s): 6.3878
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.2519 | Train Acc 0.9292 | Speed (samples/sec) 46122.4444 | GPU 28196.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68798828125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

[2021-06-17 21:29:59,636] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:29:59,748] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=3434.81054561701
-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68798828125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

avg iteration(step) data from cpu to GPU time:26.06307157 ms
avg iteration GPU training time:437.26681519 ms
avg iteration (step) total cpu time:479.24129168 ms
Epoch Time(s): 6.3604
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.2529 | Train Acc 0.9291 | Speed (samples/sec) 46128.3565 | GPU 28196.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68798828125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

[2021-06-17 21:30:07,035] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:30:07,149] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=3434.8614577011717
-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

avg iteration(step) data from cpu to GPU time:22.97118950 ms
avg iteration GPU training time:432.71337891 ms
avg iteration (step) total cpu time:469.21102206 ms
Epoch Time(s): 6.4541
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.2515 | Train Acc 0.9297 | Speed (samples/sec) 46131.3996 | GPU 28196.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

avg iteration(step) data from cpu to GPU time:28.16355260 ms
avg iteration GPU training time:430.89334106 ms
avg iteration (step) total cpu time:473.63138199 ms
Epoch Time(s): 6.3898
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71337890625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.2583 | Train Acc 0.9288 | Speed (samples/sec) 46137.3348 | GPU 28196.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

[2021-06-17 21:30:17,108] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:30:17,221] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=3434.768139757252
-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

avg iteration(step) data from cpu to GPU time:26.10252825 ms
avg iteration GPU training time:427.18377686 ms
avg iteration (step) total cpu time:469.73816554 ms
Epoch Time(s): 6.5767
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71337890625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.2567 | Train Acc 0.9289 | Speed (samples/sec) 46131.3143 | GPU 28196.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68798828125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

[2021-06-17 21:30:24,870] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:30:24,987] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=3434.936192286636
-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

avg iteration(step) data from cpu to GPU time:26.65867742 ms
avg iteration GPU training time:422.47617594 ms
avg iteration (step) total cpu time:462.48435974 ms
Epoch Time(s): 6.7338
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.2513 | Train Acc 0.9303 | Speed (samples/sec) 46132.3977 | GPU 28196.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68798828125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

[2021-06-17 21:30:32,319] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:30:32,428] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=3435.0772675999065
-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

avg iteration(step) data from cpu to GPU time:25.62759463 ms
avg iteration GPU training time:433.14533488 ms
avg iteration (step) total cpu time:478.79227002 ms
Epoch Time(s): 6.5524
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.2510 | Train Acc 0.9294 | Speed (samples/sec) 46122.0095 | GPU 28196.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68798828125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71337890625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

[2021-06-17 21:30:39,777] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:30:39,891] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=3435.7431783097395
-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

avg iteration(step) data from cpu to GPU time:24.54132271 ms
avg iteration GPU training time:426.82663981 ms
avg iteration (step) total cpu time:465.95764160 ms
Epoch Time(s): 6.4781
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.2611 | Train Acc 0.9291 | Speed (samples/sec) 46126.7335 | GPU 28196.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63330078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67236328125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68798828125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.71142578125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68798828125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69580078125GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.63134765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.67041015625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.70947265625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.68603515625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.69384765625GB

Max Memory Allocated 27.53588581085205  GigaBytes

avg iteration(step) data from cpu to GPU time:23.94722112 ms
avg iteration GPU training time:436.39017741 ms
avg iteration (step) total cpu time:479.93055979 ms
Epoch Time(s): 6.4426
Eval Acc 0.9184
Test Acc: 0.7593
Avg epoch time(time.time()): 6521.250603099664 ms
total avg iteration(step) data from cpu to GPU time:25.34664332 ms
total avg iteration GPU training time:434.49091352 ms
total avg iteration (step) total cpu time:475.19933902 ms
