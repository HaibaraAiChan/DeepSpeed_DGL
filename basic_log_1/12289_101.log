[2021-06-17 21:31:30,556] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-17 21:31:34,192] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 ds_mini_batch_train.py --aggre lstm --batch-size 12289 --log-every 120 --deepspeed_config ds_config.json
[2021-06-17 21:31:35,102] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-17 21:31:35,102] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-17 21:31:35,102] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-17 21:31:35,102] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-17 21:31:35,102] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623965500.5342693
before load_ogb step Time(s): 0.0017
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20668.84375, 'VmSize': 20541.88671875, 'VmHWM': 1165.12890625, 'VmRSS': 1165.12890625}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.5773
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2820
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0012
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.1090
-------------------------------------------------end of load ogb****************** step Time(s): 0.0020
finish constructing ogbn-products
load ogb-products time total: 1.9716672897338867
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 1.9724
after inductive else step Time(s): 0.0000
after label step Time(s): 3.7417
after train_g.create_formats_() step Time(s): 1.7343
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 12289
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-17 21:31:48,011] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.4.1+unknown, git-hash=unknown, git-branch=unknown
[2021-06-17 21:31:48,012] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-17 21:31:48,015] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-17 21:31:50,413] [INFO] [engine.py:173:__init__] DeepSpeed Flops Profiler Enabled: False
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/cc/.cache/torch_extensions/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 1.362867832183838 seconds
[2021-06-17 21:31:53,158] [INFO] [engine.py:693:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-17 21:31:53,158] [INFO] [engine.py:697:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-17 21:31:53,158] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-17 21:31:53,158] [INFO] [engine.py:505:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-17 21:31:53,158] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7fa24ce1d208>
[2021-06-17 21:31:53,158] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:31:53,159] [INFO] [config.py:900:print] DeepSpeedEngine configuration:
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   allreduce_always_fp32 ........ False
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   amp_enabled .................. False
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   amp_params ................... False
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   checkpoint_tag_validation_enabled  True
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   checkpoint_tag_validation_fail  False
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   disable_allgather ............ False
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   dump_state ................... False
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   dynamic_loss_scale_args ...... None
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   eigenvalue_enabled ........... False
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   eigenvalue_gas_boundary_resolution  1
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   eigenvalue_layer_num ......... 0
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   eigenvalue_max_iter .......... 100
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   eigenvalue_stability ......... 1e-06
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   eigenvalue_tol ............... 0.01
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   eigenvalue_verbose ........... False
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   elasticity_enabled ........... False
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   fp16_enabled ................. False
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   fp16_mixed_quantize .......... False
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   global_rank .................. 0
[2021-06-17 21:31:53,159] [INFO] [config.py:904:print]   gradient_accumulation_steps .. 1
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   gradient_clipping ............ 0.0
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   gradient_predivide_factor .... 1.0
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   initial_dynamic_scale ........ 4294967296
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   loss_scale ................... 0
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   memory_breakdown ............. False
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   optimizer_legacy_fusion ...... False
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   optimizer_name ............... adam
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   pld_enabled .................. False
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   pld_params ................... False
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   prescale_gradients ........... False
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   quantize_change_rate ......... 0.001
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   quantize_groups .............. 1
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   quantize_offset .............. 1000
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   quantize_period .............. 1000
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   quantize_rounding ............ 0
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   quantize_start_bits .......... 16
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   quantize_target_bits ......... 8
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   quantize_training_enabled .... False
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   quantize_type ................ 0
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   quantize_verbose ............. False
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   scheduler_name ............... WarmupLR
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   sparse_attention ............. None
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   sparse_gradients_enabled ..... False
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   steps_per_print .............. 10
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   tensorboard_enabled .......... False
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   tensorboard_output_path ...... 
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   train_batch_size ............. 1500
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   train_micro_batch_size_per_gpu  1500
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   use_quantizer_kernel ......... False
[2021-06-17 21:31:53,160] [INFO] [config.py:904:print]   wall_clock_breakdown ......... False
[2021-06-17 21:31:53,161] [INFO] [config.py:904:print]   world_size ................... 1
[2021-06-17 21:31:53,161] [INFO] [config.py:904:print]   zero_allow_untested_optimizer  False
[2021-06-17 21:31:53,161] [INFO] [config.py:904:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": true, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true, 
    "legacy_stage1": false
}
[2021-06-17 21:31:53,161] [INFO] [config.py:904:print]   zero_enabled ................. False
[2021-06-17 21:31:53,161] [INFO] [config.py:904:print]   zero_optimization_stage ...... 0
[2021-06-17 21:31:53,163] [INFO] [config.py:912:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Emitting ninja build file /home/cc/.cache/torch_extensions/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 1.442551851272583 seconds
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.68408203125GB

Max Memory Allocated 1.2875103950500488  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.76806640625GB

Max Memory Allocated 1.2875103950500488  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.45166015625GB

Max Memory Allocated 16.61677074432373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.45166015625GB

Max Memory Allocated 16.61677074432373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.46728515625GB

Max Memory Allocated 16.61677074432373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.46728515625GB

Max Memory Allocated 16.61677074432373  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7809 | Train Acc 0.0317 | Speed (samples/sec) nan | GPU 17015.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.42822265625GB

Max Memory Allocated 16.61677074432373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.42822265625GB

Max Memory Allocated 16.61677074432373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.45166015625GB

Max Memory Allocated 16.61677074432373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.34228515625GB

Max Memory Allocated 16.61677074432373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.33251953125GB

Max Memory Allocated 16.61677074432373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.33642578125GB

Max Memory Allocated 16.61677074432373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.33642578125GB

Max Memory Allocated 16.61677074432373  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.29736328125GB

Max Memory Allocated 16.61677074432373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.29736328125GB

Max Memory Allocated 16.61677074432373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.32080078125GB

Max Memory Allocated 16.61677074432373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09814453125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08642578125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.65563678741455  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07470703125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09814453125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.65563678741455  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07470703125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09814453125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.65563678741455  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07470703125GB

Max Memory Allocated 16.65563678741455  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09814453125GB

Max Memory Allocated 16.662502765655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.662502765655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.662502765655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.662502765655518  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.662502765655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.662502765655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07275390625GB

Max Memory Allocated 16.662502765655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09814453125GB

Max Memory Allocated 16.662502765655518  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.662502765655518  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.662502765655518  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.662502765655518  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.662502765655518  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.662502765655518  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07470703125GB

Max Memory Allocated 16.662502765655518  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

[2021-06-17 21:32:00,550] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-17 21:32:00,613] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=4847.812097905068
-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

avg iteration(step) data from cpu to GPU time:16.34124791 ms
avg iteration GPU training time:308.21194735 ms
avg iteration (step) total cpu time:337.26037632 ms
Epoch Time(s): 8.2291
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

Epoch 00001 | Step 00000 | Loss 1.0260 | Train Acc 0.7301 | Speed (samples/sec) 34204.9454 | GPU 17116.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

[2021-06-17 21:32:05,883] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:32:05,946] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=4810.764033957103
-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

[2021-06-17 21:32:09,360] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:32:09,422] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=4789.188356548625
-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

avg iteration(step) data from cpu to GPU time:16.42246957 ms
avg iteration GPU training time:315.98654175 ms
avg iteration (step) total cpu time:344.55557303 ms
Epoch Time(s): 7.5491
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

Epoch 00002 | Step 00000 | Loss 0.6055 | Train Acc 0.8546 | Speed (samples/sec) 33804.5000 | GPU 17116.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

[2021-06-17 21:32:14,772] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:32:14,835] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=4797.573826648399
-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.715280055999756  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.715280055999756  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

avg iteration(step) data from cpu to GPU time:16.90933254 ms
avg iteration GPU training time:321.70741688 ms
avg iteration (step) total cpu time:350.56539015 ms
Epoch Time(s): 7.5154
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.4597 | Train Acc 0.8892 | Speed (samples/sec) 33680.6454 | GPU 17145.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

[2021-06-17 21:32:20,183] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:32:20,237] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=4773.90379199449
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

[2021-06-17 21:32:23,677] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:32:23,740] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=4762.861379986304
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

avg iteration(step) data from cpu to GPU time:15.50439843 ms
avg iteration GPU training time:318.68807706 ms
avg iteration (step) total cpu time:346.29527005 ms
Epoch Time(s): 7.4781
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.4332 | Train Acc 0.8918 | Speed (samples/sec) 33667.1897 | GPU 17145.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

[2021-06-17 21:32:29,071] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:32:29,134] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=4759.834654829691
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

[2021-06-17 21:32:32,538] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:32:32,597] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=4754.689787741215
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

avg iteration(step) data from cpu to GPU time:15.89884498 ms
avg iteration GPU training time:317.60211737 ms
avg iteration (step) total cpu time:345.76015039 ms
Epoch Time(s): 7.4627
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.3790 | Train Acc 0.9043 | Speed (samples/sec) 33672.1270 | GPU 17145.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

[2021-06-17 21:32:37,854] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:32:37,917] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=4757.610120227573
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

avg iteration(step) data from cpu to GPU time:16.95198276 ms
avg iteration GPU training time:304.73930775 ms
avg iteration (step) total cpu time:334.07952569 ms
Epoch Time(s): 7.2785
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.3608 | Train Acc 0.9060 | Speed (samples/sec) 33837.0478 | GPU 17145.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

[2021-06-17 21:32:43,102] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:32:43,166] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=4773.018683341875
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

[2021-06-17 21:32:46,505] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:32:46,569] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=4778.9031180091915
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

avg iteration(step) data from cpu to GPU time:15.40471276 ms
avg iteration GPU training time:309.67097612 ms
avg iteration (step) total cpu time:338.45095201 ms
Epoch Time(s): 7.3864
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.3464 | Train Acc 0.9102 | Speed (samples/sec) 33902.0713 | GPU 17145.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

[2021-06-17 21:32:51,910] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:32:51,973] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=4773.574117709317
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

avg iteration(step) data from cpu to GPU time:15.45047587 ms
avg iteration GPU training time:311.47258689 ms
avg iteration (step) total cpu time:338.73399821 ms
Epoch Time(s): 7.4002
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.3341 | Train Acc 0.9100 | Speed (samples/sec) 33908.4052 | GPU 17145.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

[2021-06-17 21:32:57,166] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:32:57,229] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=4778.6955013313955
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

[2021-06-17 21:33:00,599] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:33:00,664] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=4781.218399431717
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72509765625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

avg iteration(step) data from cpu to GPU time:16.12276936 ms
avg iteration GPU training time:309.65457431 ms
avg iteration (step) total cpu time:337.99899708 ms
Epoch Time(s): 7.3239
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68798828125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.3372 | Train Acc 0.9125 | Speed (samples/sec) 33944.1007 | GPU 17145.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

[2021-06-17 21:33:05,908] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:33:05,971] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=4788.899746263304
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes

[2021-06-17 21:33:09,270] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:33:09,333] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=4794.781703374371
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes

avg iteration(step) data from cpu to GPU time:16.71473165 ms
avg iteration GPU training time:309.23593695 ms
avg iteration (step) total cpu time:338.41202476 ms
Epoch Time(s): 7.3799
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.3176 | Train Acc 0.9129 | Speed (samples/sec) 34012.0978 | GPU 17145.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.74368953704834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.74368953704834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

[2021-06-17 21:33:14,737] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:33:14,800] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=4792.6325457680105
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

avg iteration(step) data from cpu to GPU time:16.52214128 ms
avg iteration GPU training time:312.98033281 ms
avg iteration (step) total cpu time:342.42265875 ms
Epoch Time(s): 7.4392
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.3419 | Train Acc 0.9082 | Speed (samples/sec) 33989.2731 | GPU 17148.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

[2021-06-17 21:33:20,095] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:33:20,157] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=4785.553487503326
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

[2021-06-17 21:33:23,570] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:33:23,633] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=4784.2646335931195
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

avg iteration(step) data from cpu to GPU time:19.45700082 ms
avg iteration GPU training time:311.52791249 ms
avg iteration (step) total cpu time:343.84075078 ms
Epoch Time(s): 7.4870
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.3144 | Train Acc 0.9126 | Speed (samples/sec) 33945.8424 | GPU 17148.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

[2021-06-17 21:33:28,901] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:33:28,964] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=4782.905556976685
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

avg iteration(step) data from cpu to GPU time:18.13120885 ms
avg iteration GPU training time:317.64945568 ms
avg iteration (step) total cpu time:348.18335013 ms
Epoch Time(s): 7.4472
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.3033 | Train Acc 0.9170 | Speed (samples/sec) 33921.9190 | GPU 17148.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

[2021-06-17 21:33:34,284] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:33:34,347] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=4781.673509371922
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

[2021-06-17 21:33:37,705] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:33:37,769] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=4784.173750033094
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

avg iteration(step) data from cpu to GPU time:15.58544861 ms
avg iteration GPU training time:314.39115490 ms
avg iteration (step) total cpu time:342.13408557 ms
Epoch Time(s): 7.4121
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.3036 | Train Acc 0.9175 | Speed (samples/sec) 33929.6880 | GPU 17148.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

[2021-06-17 21:33:43,130] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:33:43,193] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=4782.316684446346
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

[2021-06-17 21:33:46,527] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:33:46,590] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=4782.810291386406
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

avg iteration(step) data from cpu to GPU time:15.18909949 ms
avg iteration GPU training time:313.36985363 ms
avg iteration (step) total cpu time:339.94566311 ms
Epoch Time(s): 7.4296
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.2937 | Train Acc 0.9203 | Speed (samples/sec) 33937.0411 | GPU 17148.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

[2021-06-17 21:33:52,015] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:33:52,077] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=4779.799691217459
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

avg iteration(step) data from cpu to GPU time:15.43742535 ms
avg iteration GPU training time:308.67442738 ms
avg iteration (step) total cpu time:336.12702110 ms
Epoch Time(s): 7.4645
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.2998 | Train Acc 0.9186 | Speed (samples/sec) 33949.9666 | GPU 17148.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.746830940246582  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.746830940246582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:33:57,238] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:33:57,301] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=4781.267157135111
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:34:00,718] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:34:00,781] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=4778.960831816335
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:16.53914469 ms
avg iteration GPU training time:322.68384621 ms
avg iteration (step) total cpu time:351.92628340 ms
Epoch Time(s): 7.4581
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.2956 | Train Acc 0.9219 | Speed (samples/sec) 33909.4020 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:34:06,095] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:34:06,157] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=4777.046470906111
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:16.26692382 ms
avg iteration GPU training time:312.83279974 ms
avg iteration (step) total cpu time:341.30939570 ms
Epoch Time(s): 7.4164
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.2998 | Train Acc 0.9211 | Speed (samples/sec) 33917.1205 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:34:11,558] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:34:11,620] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=4771.583240157502
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:34:14,918] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:34:14,981] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=4777.296846417555
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:17.01153738 ms
avg iteration GPU training time:304.73693015 ms
avg iteration (step) total cpu time:333.98509026 ms
Epoch Time(s): 7.3537
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.2943 | Train Acc 0.9199 | Speed (samples/sec) 33939.6921 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:34:20,333] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:34:20,395] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=4773.9526144992715
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:34:23,713] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:34:23,776] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=4776.288084366364
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:16.55009478 ms
avg iteration GPU training time:313.08407870 ms
avg iteration (step) total cpu time:341.97105061 ms
Epoch Time(s): 7.4881
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.2818 | Train Acc 0.9255 | Speed (samples/sec) 33929.6954 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:34:29,130] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:34:29,193] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=4774.436446996899
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:17.07435955 ms
avg iteration GPU training time:313.79972146 ms
avg iteration (step) total cpu time:343.48214756 ms
Epoch Time(s): 7.4497
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.2850 | Train Acc 0.9236 | Speed (samples/sec) 33920.1382 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:34:34,413] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:34:34,475] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=4777.267916885565
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:34:37,826] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:34:37,888] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=4779.025120968718
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:16.12561729 ms
avg iteration GPU training time:308.34534246 ms
avg iteration (step) total cpu time:336.88649264 ms
Epoch Time(s): 7.3325
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.2983 | Train Acc 0.9171 | Speed (samples/sec) 33946.8395 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:34:43,158] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:34:43,222] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=4780.1217945002845
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:16.15440880 ms
avg iteration GPU training time:309.74923151 ms
avg iteration (step) total cpu time:339.32662010 ms
Epoch Time(s): 7.3617
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.2767 | Train Acc 0.9236 | Speed (samples/sec) 33958.2955 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:34:48,466] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:34:48,528] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=4780.766755052004
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:34:51,876] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:34:51,941] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=4782.205620287306
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:15.74573976 ms
avg iteration GPU training time:309.52425038 ms
avg iteration (step) total cpu time:337.76554194 ms
Epoch Time(s): 7.3931
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.2831 | Train Acc 0.9228 | Speed (samples/sec) 33968.5684 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:34:57,374] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:34:57,433] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=4776.8076753541
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:35:00,817] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:35:00,881] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=4777.427638855862
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:18.68848289 ms
avg iteration GPU training time:314.37753851 ms
avg iteration (step) total cpu time:345.77805346 ms
Epoch Time(s): 7.6071
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.2892 | Train Acc 0.9213 | Speed (samples/sec) 33933.1399 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:35:06,205] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:35:06,268] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=4777.976815106538
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:16.74136153 ms
avg iteration GPU training time:315.04520208 ms
avg iteration (step) total cpu time:344.12865205 ms
Epoch Time(s): 7.4204
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.2707 | Train Acc 0.9255 | Speed (samples/sec) 33931.0097 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:35:11,556] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:35:11,620] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=4778.178411047555
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:35:14,953] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:35:15,017] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=4780.236288154102
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:17.78818633 ms
avg iteration GPU training time:309.82855225 ms
avg iteration (step) total cpu time:340.18874168 ms
Epoch Time(s): 7.3647
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.2841 | Train Acc 0.9235 | Speed (samples/sec) 33949.5074 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:35:20,450] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:35:20,513] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=4777.187236275634
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:16.27473727 ms
avg iteration GPU training time:311.91375732 ms
avg iteration (step) total cpu time:345.37904913 ms
Epoch Time(s): 7.5422
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.2753 | Train Acc 0.9229 | Speed (samples/sec) 33928.9606 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:35:25,787] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:35:25,850] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=4776.9004759404625
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:35:29,221] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:35:29,283] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=4778.291950944483
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:16.00145167 ms
avg iteration GPU training time:309.51793324 ms
avg iteration (step) total cpu time:337.90482174 ms
Epoch Time(s): 7.3801
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.2768 | Train Acc 0.9229 | Speed (samples/sec) 33939.1318 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:35:34,579] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:35:34,643] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=4778.636905218593
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:35:37,990] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:35:38,054] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=4779.117176979079
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:16.43352465 ms
avg iteration GPU training time:314.60693082 ms
avg iteration (step) total cpu time:343.06560863 ms
Epoch Time(s): 7.4247
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.2883 | Train Acc 0.9220 | Speed (samples/sec) 33937.9941 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:35:43,414] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:35:43,476] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=4777.698028198801
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:15.48945730 ms
avg iteration GPU training time:313.41255049 ms
avg iteration (step) total cpu time:341.56485037 ms
Epoch Time(s): 7.4451
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.2949 | Train Acc 0.9195 | Speed (samples/sec) 33933.5592 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:35:48,789] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:35:48,852] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=4775.6525903714355
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:35:52,251] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:35:52,315] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=4775.651581454328
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:17.36975999 ms
avg iteration GPU training time:311.43896484 ms
avg iteration (step) total cpu time:341.08601917 ms
Epoch Time(s): 7.4839
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.2901 | Train Acc 0.9213 | Speed (samples/sec) 33922.8866 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:35:57,696] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:35:57,759] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=4773.5526159736755
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

avg iteration(step) data from cpu to GPU time:15.99091781 ms
avg iteration GPU training time:315.91465621 ms
avg iteration (step) total cpu time:344.32610598 ms
Epoch Time(s): 7.5205
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.2755 | Train Acc 0.9251 | Speed (samples/sec) 33911.0344 | GPU 17150.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

[2021-06-17 21:36:03,039] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:36:03,101] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=4772.708974205069
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.748912811279297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.748912811279297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:36:06,592] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:36:06,655] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=4770.592878927169
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

avg iteration(step) data from cpu to GPU time:16.46797371 ms
avg iteration GPU training time:313.70249245 ms
avg iteration (step) total cpu time:342.92234074 ms
Epoch Time(s): 7.5174
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.2899 | Train Acc 0.9211 | Speed (samples/sec) 33896.4484 | GPU 17154.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:36:11,939] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:36:12,002] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=4770.89997318557
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:36:15,365] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:36:15,428] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=4771.375047875894
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

avg iteration(step) data from cpu to GPU time:17.60772974 ms
avg iteration GPU training time:311.63439941 ms
avg iteration (step) total cpu time:341.66962450 ms
Epoch Time(s): 7.4085
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.2704 | Train Acc 0.9260 | Speed (samples/sec) 33895.7003 | GPU 17154.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:36:20,775] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:36:20,837] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=4769.9295275308195
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

avg iteration(step) data from cpu to GPU time:15.89533381 ms
avg iteration GPU training time:313.82037076 ms
avg iteration (step) total cpu time:343.93165328 ms
Epoch Time(s): 7.4486
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.2664 | Train Acc 0.9312 | Speed (samples/sec) 33887.6238 | GPU 17154.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:36:26,156] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:36:26,218] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=4769.577358516006
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:36:29,599] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:36:29,662] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=4770.231975889565
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

avg iteration(step) data from cpu to GPU time:16.81206408 ms
avg iteration GPU training time:311.82710682 ms
avg iteration (step) total cpu time:341.14696763 ms
Epoch Time(s): 7.4758
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.2674 | Train Acc 0.9281 | Speed (samples/sec) 33889.6240 | GPU 17154.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:36:35,103] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:36:35,166] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=4768.1003359528695
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

avg iteration(step) data from cpu to GPU time:15.78683896 ms
avg iteration GPU training time:308.23395053 ms
avg iteration (step) total cpu time:336.28968759 ms
Epoch Time(s): 7.5188
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.2782 | Train Acc 0.9255 | Speed (samples/sec) 33889.9649 | GPU 17154.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:36:40,425] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:36:40,483] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=4768.255405379193
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:36:43,979] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:36:44,041] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=4766.24230499457
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

avg iteration(step) data from cpu to GPU time:15.48847129 ms
avg iteration GPU training time:315.35785744 ms
avg iteration (step) total cpu time:343.53277900 ms
Epoch Time(s): 7.5319
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.2812 | Train Acc 0.9233 | Speed (samples/sec) 33872.1789 | GPU 17154.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:36:49,326] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:36:49,391] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=4766.204495017698
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:36:52,672] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:36:52,735] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=4768.058046312226
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

avg iteration(step) data from cpu to GPU time:15.13265454 ms
avg iteration GPU training time:308.04785156 ms
avg iteration (step) total cpu time:334.81151407 ms
Epoch Time(s): 7.3496
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.2768 | Train Acc 0.9238 | Speed (samples/sec) 33887.1393 | GPU 17154.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:36:58,078] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:36:58,143] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=4769.375325890443
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

avg iteration(step) data from cpu to GPU time:15.84281895 ms
avg iteration GPU training time:304.78641579 ms
avg iteration (step) total cpu time:332.81885494 ms
Epoch Time(s): 7.3953
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.2786 | Train Acc 0.9247 | Speed (samples/sec) 33898.7911 | GPU 17154.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:37:03,451] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:37:03,514] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=4768.5122924030475
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:37:06,852] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:37:06,914] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=4769.889465644212
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

avg iteration(step) data from cpu to GPU time:15.92581263 ms
avg iteration GPU training time:311.37932517 ms
avg iteration (step) total cpu time:339.51026743 ms
Epoch Time(s): 7.4462
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.2730 | Train Acc 0.9251 | Speed (samples/sec) 33898.8180 | GPU 17154.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:37:12,355] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:37:12,414] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=4766.392287033744
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

avg iteration(step) data from cpu to GPU time:16.35072015 ms
avg iteration GPU training time:336.08682251 ms
avg iteration (step) total cpu time:364.59580335 ms
Epoch Time(s): 7.7228
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.2752 | Train Acc 0.9232 | Speed (samples/sec) 33859.7313 | GPU 17154.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:37:17,920] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:37:17,983] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=4761.004371160829
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:37:21,438] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:37:21,501] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=4760.746653620025
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

avg iteration(step) data from cpu to GPU time:17.28531777 ms
avg iteration GPU training time:308.96258822 ms
avg iteration (step) total cpu time:338.65473487 ms
Epoch Time(s): 7.5375
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.2777 | Train Acc 0.9259 | Speed (samples/sec) 33848.7602 | GPU 17154.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:37:27,011] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:37:27,073] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=4758.102227461068
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:37:30,441] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:37:30,504] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=4758.593995392559
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

avg iteration(step) data from cpu to GPU time:17.28423873 ms
avg iteration GPU training time:312.48236084 ms
avg iteration (step) total cpu time:342.04452688 ms
Epoch Time(s): 7.6847
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.2712 | Train Acc 0.9238 | Speed (samples/sec) 33834.9066 | GPU 17154.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes

[2021-06-17 21:37:35,832] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:37:35,896] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=4759.514831545233
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.752641677856445  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.752641677856445  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.50269084 ms
avg iteration GPU training time:313.24243441 ms
avg iteration (step) total cpu time:341.75166217 ms
Epoch Time(s): 7.3777
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.2793 | Train Acc 0.9224 | Speed (samples/sec) 33840.0078 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:37:41,333] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:37:41,394] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=4759.841863455466
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:37:44,760] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:37:44,822] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=4760.459552837059
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:15.32967845 ms
avg iteration GPU training time:313.14826827 ms
avg iteration (step) total cpu time:342.29898453 ms
Epoch Time(s): 7.5968
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.2712 | Train Acc 0.9245 | Speed (samples/sec) 33844.9654 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:37:50,137] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:37:50,200] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=4761.0879922150525
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.50408155 ms
avg iteration GPU training time:303.04250266 ms
avg iteration (step) total cpu time:332.03577995 ms
Epoch Time(s): 7.3304
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.2735 | Train Acc 0.9239 | Speed (samples/sec) 33856.7067 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:37:55,532] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:37:55,595] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=4763.101142837729
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:37:59,120] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:37:59,183] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=4761.156451044636
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:15.86451218 ms
avg iteration GPU training time:312.39763017 ms
avg iteration (step) total cpu time:340.85765752 ms
Epoch Time(s): 7.7124
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.2604 | Train Acc 0.9278 | Speed (samples/sec) 33840.4449 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:38:04,937] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:38:04,999] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=4760.966131687701
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:38:08,434] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:38:08,497] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=4760.351805926225
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:18.52786628 ms
avg iteration GPU training time:317.89058339 ms
avg iteration (step) total cpu time:348.38975560 ms
Epoch Time(s): 7.9355
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.2742 | Train Acc 0.9230 | Speed (samples/sec) 33832.7951 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:38:14,032] [INFO] [logging.py:60:log_dist] [Rank 0] step=810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:38:14,095] [INFO] [timer.py:160:stop] 0/810, SamplesPerSec=4758.453088919617
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:18.07031276 ms
avg iteration GPU training time:317.53151911 ms
avg iteration (step) total cpu time:349.06918352 ms
Epoch Time(s): 7.6908
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.2798 | Train Acc 0.9250 | Speed (samples/sec) 33817.1953 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:38:19,487] [INFO] [logging.py:60:log_dist] [Rank 0] step=820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:38:19,549] [INFO] [timer.py:160:stop] 0/820, SamplesPerSec=4758.863634803633
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:38:23,009] [INFO] [logging.py:60:log_dist] [Rank 0] step=830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:38:23,073] [INFO] [timer.py:160:stop] 0/830, SamplesPerSec=4757.455729109015
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.38831399 ms
avg iteration GPU training time:321.14089966 ms
avg iteration (step) total cpu time:349.44224358 ms
Epoch Time(s): 7.5789
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.2689 | Train Acc 0.9258 | Speed (samples/sec) 33814.4554 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:38:28,630] [INFO] [logging.py:60:log_dist] [Rank 0] step=840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:38:28,690] [INFO] [timer.py:160:stop] 0/840, SamplesPerSec=4756.410929954619
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:17.50394483 ms
avg iteration GPU training time:311.57119474 ms
avg iteration (step) total cpu time:341.12800251 ms
Epoch Time(s): 7.6879
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.2652 | Train Acc 0.9261 | Speed (samples/sec) 33811.4559 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:38:34,148] [INFO] [logging.py:60:log_dist] [Rank 0] step=850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:38:34,210] [INFO] [timer.py:160:stop] 0/850, SamplesPerSec=4756.2100345854615
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:38:37,608] [INFO] [logging.py:60:log_dist] [Rank 0] step=860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:38:37,665] [INFO] [timer.py:160:stop] 0/860, SamplesPerSec=4756.299761575162
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.21389666 ms
avg iteration GPU training time:309.84171087 ms
avg iteration (step) total cpu time:337.87543123 ms
Epoch Time(s): 7.5922
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.2697 | Train Acc 0.9260 | Speed (samples/sec) 33811.5122 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:38:43,143] [INFO] [logging.py:60:log_dist] [Rank 0] step=870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:38:43,206] [INFO] [timer.py:160:stop] 0/870, SamplesPerSec=4756.238308413477
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:38:46,606] [INFO] [logging.py:60:log_dist] [Rank 0] step=880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:38:46,669] [INFO] [timer.py:160:stop] 0/880, SamplesPerSec=4757.147421482679
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:17.77170320 ms
avg iteration GPU training time:310.49519209 ms
avg iteration (step) total cpu time:345.55014697 ms
Epoch Time(s): 7.6325
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.2836 | Train Acc 0.9235 | Speed (samples/sec) 33807.2783 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:38:52,168] [INFO] [logging.py:60:log_dist] [Rank 0] step=890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:38:52,234] [INFO] [timer.py:160:stop] 0/890, SamplesPerSec=4755.750453667562
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:15.87431301 ms
avg iteration GPU training time:320.83804599 ms
avg iteration (step) total cpu time:349.58512133 ms
Epoch Time(s): 7.6420
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.2614 | Train Acc 0.9271 | Speed (samples/sec) 33799.9252 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:38:57,671] [INFO] [logging.py:60:log_dist] [Rank 0] step=900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:38:57,733] [INFO] [timer.py:160:stop] 0/900, SamplesPerSec=4755.433795277944
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:39:01,147] [INFO] [logging.py:60:log_dist] [Rank 0] step=910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:39:01,210] [INFO] [timer.py:160:stop] 0/910, SamplesPerSec=4755.117471263424
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:15.87921177 ms
avg iteration GPU training time:319.16270308 ms
avg iteration (step) total cpu time:346.83830088 ms
Epoch Time(s): 7.6632
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.2580 | Train Acc 0.9277 | Speed (samples/sec) 33796.6329 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:39:06,707] [INFO] [logging.py:60:log_dist] [Rank 0] step=920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:39:06,770] [INFO] [timer.py:160:stop] 0/920, SamplesPerSec=4755.6919298183575
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:17.27718111 ms
avg iteration GPU training time:320.75125122 ms
avg iteration (step) total cpu time:350.34342246 ms
Epoch Time(s): 7.6198
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.2550 | Train Acc 0.9289 | Speed (samples/sec) 33790.9740 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:39:12,338] [INFO] [logging.py:60:log_dist] [Rank 0] step=930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:39:12,400] [INFO] [timer.py:160:stop] 0/930, SamplesPerSec=4754.288139291166
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:39:15,806] [INFO] [logging.py:60:log_dist] [Rank 0] step=940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:39:15,870] [INFO] [timer.py:160:stop] 0/940, SamplesPerSec=4754.10963376801
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:15.94307475 ms
avg iteration GPU training time:315.40668279 ms
avg iteration (step) total cpu time:343.40240739 ms
Epoch Time(s): 7.6622
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.2587 | Train Acc 0.9282 | Speed (samples/sec) 33791.2869 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:39:21,382] [INFO] [logging.py:60:log_dist] [Rank 0] step=950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:39:21,446] [INFO] [timer.py:160:stop] 0/950, SamplesPerSec=4753.374119411346
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:39:24,776] [INFO] [logging.py:60:log_dist] [Rank 0] step=960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:39:24,840] [INFO] [timer.py:160:stop] 0/960, SamplesPerSec=4754.1752911966405
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.25808317 ms
avg iteration GPU training time:311.10243641 ms
avg iteration (step) total cpu time:340.16117183 ms
Epoch Time(s): 7.5894
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.2651 | Train Acc 0.9252 | Speed (samples/sec) 33791.5040 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:39:30,427] [INFO] [logging.py:60:log_dist] [Rank 0] step=970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:39:30,490] [INFO] [timer.py:160:stop] 0/970, SamplesPerSec=4753.486299415914
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.38537606 ms
avg iteration GPU training time:311.22484797 ms
avg iteration (step) total cpu time:340.02191370 ms
Epoch Time(s): 7.7011
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.2732 | Train Acc 0.9281 | Speed (samples/sec) 33792.2185 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:39:35,951] [INFO] [logging.py:60:log_dist] [Rank 0] step=980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:39:36,014] [INFO] [timer.py:160:stop] 0/980, SamplesPerSec=4752.831940732885
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:39:39,374] [INFO] [logging.py:60:log_dist] [Rank 0] step=990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:39:39,437] [INFO] [timer.py:160:stop] 0/990, SamplesPerSec=4753.106129317297
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:14.92523055 ms
avg iteration GPU training time:312.27312955 ms
avg iteration (step) total cpu time:339.45022930 ms
Epoch Time(s): 7.5466
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.2643 | Train Acc 0.9282 | Speed (samples/sec) 33793.6410 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:39:44,866] [INFO] [logging.py:60:log_dist] [Rank 0] step=1000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:39:44,929] [INFO] [timer.py:160:stop] 0/1000, SamplesPerSec=4753.754206389995
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.84406974 ms
avg iteration GPU training time:304.67084295 ms
avg iteration (step) total cpu time:333.53703672 ms
Epoch Time(s): 7.4242
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.2694 | Train Acc 0.9267 | Speed (samples/sec) 33803.1661 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:39:50,197] [INFO] [logging.py:60:log_dist] [Rank 0] step=1010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:39:50,260] [INFO] [timer.py:160:stop] 0/1010, SamplesPerSec=4754.762985583618
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:39:53,635] [INFO] [logging.py:60:log_dist] [Rank 0] step=1020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:39:53,698] [INFO] [timer.py:160:stop] 0/1020, SamplesPerSec=4755.201723521443
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.08951829 ms
avg iteration GPU training time:318.39719183 ms
avg iteration (step) total cpu time:346.99286114 ms
Epoch Time(s): 7.5777
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.2699 | Train Acc 0.9248 | Speed (samples/sec) 33802.7467 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:39:59,203] [INFO] [logging.py:60:log_dist] [Rank 0] step=1030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:39:59,267] [INFO] [timer.py:160:stop] 0/1030, SamplesPerSec=4754.799929817406
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:40:02,612] [INFO] [logging.py:60:log_dist] [Rank 0] step=1040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:40:02,675] [INFO] [timer.py:160:stop] 0/1040, SamplesPerSec=4755.448426131254
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:17.34173124 ms
avg iteration GPU training time:312.23122614 ms
avg iteration (step) total cpu time:341.61669558 ms
Epoch Time(s): 7.6209
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.2619 | Train Acc 0.9261 | Speed (samples/sec) 33806.1273 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:40:08,129] [INFO] [logging.py:60:log_dist] [Rank 0] step=1050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:40:08,192] [INFO] [timer.py:160:stop] 0/1050, SamplesPerSec=4756.403005266883
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:18.16326705 ms
avg iteration GPU training time:310.92419434 ms
avg iteration (step) total cpu time:346.27305378 ms
Epoch Time(s): 7.5600
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.2814 | Train Acc 0.9238 | Speed (samples/sec) 33807.8010 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:40:13,813] [INFO] [logging.py:60:log_dist] [Rank 0] step=1060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:40:13,855] [INFO] [timer.py:160:stop] 0/1060, SamplesPerSec=4756.035043420941
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:40:17,202] [INFO] [logging.py:60:log_dist] [Rank 0] step=1070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:40:17,266] [INFO] [timer.py:160:stop] 0/1070, SamplesPerSec=4756.6327360635105
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.37670387 ms
avg iteration GPU training time:310.39300815 ms
avg iteration (step) total cpu time:338.89657801 ms
Epoch Time(s): 7.6597
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.2641 | Train Acc 0.9270 | Speed (samples/sec) 33811.0820 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:40:22,956] [INFO] [logging.py:60:log_dist] [Rank 0] step=1080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:40:23,017] [INFO] [timer.py:160:stop] 0/1080, SamplesPerSec=4753.703550057772
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:17.52345319 ms
avg iteration GPU training time:320.65904652 ms
avg iteration (step) total cpu time:350.51098737 ms
Epoch Time(s): 7.8315
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.2655 | Train Acc 0.9260 | Speed (samples/sec) 33791.0425 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:40:28,482] [INFO] [logging.py:60:log_dist] [Rank 0] step=1090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:40:28,544] [INFO] [timer.py:160:stop] 0/1090, SamplesPerSec=4753.172449052556
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:40:32,025] [INFO] [logging.py:60:log_dist] [Rank 0] step=1100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:40:32,090] [INFO] [timer.py:160:stop] 0/1100, SamplesPerSec=4752.293885395611
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:17.96104448 ms
avg iteration GPU training time:311.27687489 ms
avg iteration (step) total cpu time:341.41980518 ms
Epoch Time(s): 7.7023
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.2726 | Train Acc 0.9232 | Speed (samples/sec) 33783.4718 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:40:37,545] [INFO] [logging.py:60:log_dist] [Rank 0] step=1110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:40:37,610] [INFO] [timer.py:160:stop] 0/1110, SamplesPerSec=4751.918911023175
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:40:40,924] [INFO] [logging.py:60:log_dist] [Rank 0] step=1120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:40:40,986] [INFO] [timer.py:160:stop] 0/1120, SamplesPerSec=4752.657997204329
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:15.60402055 ms
avg iteration GPU training time:310.50248857 ms
avg iteration (step) total cpu time:338.39758960 ms
Epoch Time(s): 7.5149
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.2692 | Train Acc 0.9241 | Speed (samples/sec) 33788.0377 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:40:46,434] [INFO] [logging.py:60:log_dist] [Rank 0] step=1130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:40:46,497] [INFO] [timer.py:160:stop] 0/1130, SamplesPerSec=4753.261661637731
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.97518826 ms
avg iteration GPU training time:313.92726551 ms
avg iteration (step) total cpu time:343.74371442 ms
Epoch Time(s): 7.5494
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.2669 | Train Acc 0.9268 | Speed (samples/sec) 33787.2485 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:40:51,884] [INFO] [logging.py:60:log_dist] [Rank 0] step=1140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:40:51,947] [INFO] [timer.py:160:stop] 0/1140, SamplesPerSec=4753.16339255924
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:40:55,288] [INFO] [logging.py:60:log_dist] [Rank 0] step=1150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:40:55,350] [INFO] [timer.py:160:stop] 0/1150, SamplesPerSec=4753.953677764618
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.92446839 ms
avg iteration GPU training time:311.53115845 ms
avg iteration (step) total cpu time:341.14144065 ms
Epoch Time(s): 7.5082
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.2688 | Train Acc 0.9244 | Speed (samples/sec) 33792.2062 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:41:00,975] [INFO] [logging.py:60:log_dist] [Rank 0] step=1160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:41:01,036] [INFO] [timer.py:160:stop] 0/1160, SamplesPerSec=4753.503118471621
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:17.39207831 ms
avg iteration GPU training time:312.05657682 ms
avg iteration (step) total cpu time:341.49891680 ms
Epoch Time(s): 7.7001
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.2592 | Train Acc 0.9260 | Speed (samples/sec) 33789.4499 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:41:06,441] [INFO] [logging.py:60:log_dist] [Rank 0] step=1170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:41:06,503] [INFO] [timer.py:160:stop] 0/1170, SamplesPerSec=4753.809315266361
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:41:09,921] [INFO] [logging.py:60:log_dist] [Rank 0] step=1180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:41:09,984] [INFO] [timer.py:160:stop] 0/1180, SamplesPerSec=4753.489611831796
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.07112156 ms
avg iteration GPU training time:312.54287165 ms
avg iteration (step) total cpu time:341.26513655 ms
Epoch Time(s): 7.5857
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.2529 | Train Acc 0.9274 | Speed (samples/sec) 33786.6461 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:41:15,407] [INFO] [logging.py:60:log_dist] [Rank 0] step=1190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:41:15,469] [INFO] [timer.py:160:stop] 0/1190, SamplesPerSec=4752.995734450952
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:41:18,826] [INFO] [logging.py:60:log_dist] [Rank 0] step=1200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:41:18,885] [INFO] [timer.py:160:stop] 0/1200, SamplesPerSec=4753.3019988982705
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.42883205 ms
avg iteration GPU training time:313.85201749 ms
avg iteration (step) total cpu time:342.36611019 ms
Epoch Time(s): 7.5504
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.2706 | Train Acc 0.9248 | Speed (samples/sec) 33786.8007 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:41:24,640] [INFO] [logging.py:60:log_dist] [Rank 0] step=1210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:41:24,705] [INFO] [timer.py:160:stop] 0/1210, SamplesPerSec=4749.602695638041
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.03118558 ms
avg iteration GPU training time:312.63434670 ms
avg iteration (step) total cpu time:340.57580341 ms
Epoch Time(s): 7.8233
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.2704 | Train Acc 0.9236 | Speed (samples/sec) 33774.7568 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:41:30,104] [INFO] [logging.py:60:log_dist] [Rank 0] step=1220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:41:30,166] [INFO] [timer.py:160:stop] 0/1220, SamplesPerSec=4749.302069225031
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:41:33,487] [INFO] [logging.py:60:log_dist] [Rank 0] step=1230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:41:33,551] [INFO] [timer.py:160:stop] 0/1230, SamplesPerSec=4750.239834633118
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.31714890 ms
avg iteration GPU training time:307.64509444 ms
avg iteration (step) total cpu time:336.22707020 ms
Epoch Time(s): 7.5322
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.2703 | Train Acc 0.9255 | Speed (samples/sec) 33778.7137 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:41:39,197] [INFO] [logging.py:60:log_dist] [Rank 0] step=1240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:41:39,261] [INFO] [timer.py:160:stop] 0/1240, SamplesPerSec=4747.537451102168
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.78545172 ms
avg iteration GPU training time:314.04203658 ms
avg iteration (step) total cpu time:343.70994568 ms
Epoch Time(s): 7.7703
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.2649 | Train Acc 0.9268 | Speed (samples/sec) 33767.4327 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:41:44,554] [INFO] [logging.py:60:log_dist] [Rank 0] step=1250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:41:44,618] [INFO] [timer.py:160:stop] 0/1250, SamplesPerSec=4747.466688686975
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:41:47,998] [INFO] [logging.py:60:log_dist] [Rank 0] step=1260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:41:48,061] [INFO] [timer.py:160:stop] 0/1260, SamplesPerSec=4747.751480957398
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:15.91661375 ms
avg iteration GPU training time:311.32204923 ms
avg iteration (step) total cpu time:339.53924613 ms
Epoch Time(s): 7.4202
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.2673 | Train Acc 0.9232 | Speed (samples/sec) 33770.4370 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:41:53,389] [INFO] [logging.py:60:log_dist] [Rank 0] step=1270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:41:53,452] [INFO] [timer.py:160:stop] 0/1270, SamplesPerSec=4747.689724466961
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:41:56,782] [INFO] [logging.py:60:log_dist] [Rank 0] step=1280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:41:56,843] [INFO] [timer.py:160:stop] 0/1280, SamplesPerSec=4748.565550472141
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:17.43784124 ms
avg iteration GPU training time:309.01469560 ms
avg iteration (step) total cpu time:339.02515065 ms
Epoch Time(s): 7.4138
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.2577 | Train Acc 0.9272 | Speed (samples/sec) 33771.1059 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:42:02,234] [INFO] [logging.py:60:log_dist] [Rank 0] step=1290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:42:02,297] [INFO] [timer.py:160:stop] 0/1290, SamplesPerSec=4747.539297974877
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:17.74780508 ms
avg iteration GPU training time:311.88692405 ms
avg iteration (step) total cpu time:342.92810613 ms
Epoch Time(s): 7.5032
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.2698 | Train Acc 0.9232 | Speed (samples/sec) 33769.8568 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:42:07,625] [INFO] [logging.py:60:log_dist] [Rank 0] step=1300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:42:07,688] [INFO] [timer.py:160:stop] 0/1300, SamplesPerSec=4747.1716060515755
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:42:11,088] [INFO] [logging.py:60:log_dist] [Rank 0] step=1310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:42:11,151] [INFO] [timer.py:160:stop] 0/1310, SamplesPerSec=4747.266411905036
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.88649021 ms
avg iteration GPU training time:315.67150879 ms
avg iteration (step) total cpu time:345.44307535 ms
Epoch Time(s): 7.5240
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.2627 | Train Acc 0.9246 | Speed (samples/sec) 33765.0718 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:42:16,509] [INFO] [logging.py:60:log_dist] [Rank 0] step=1320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:42:16,572] [INFO] [timer.py:160:stop] 0/1320, SamplesPerSec=4747.0663165410915
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:15.77388191 ms
avg iteration GPU training time:314.27251088 ms
avg iteration (step) total cpu time:342.92353283 ms
Epoch Time(s): 7.5015
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.2693 | Train Acc 0.9263 | Speed (samples/sec) 33766.7323 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:42:21,884] [INFO] [logging.py:60:log_dist] [Rank 0] step=1330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:42:21,947] [INFO] [timer.py:160:stop] 0/1330, SamplesPerSec=4747.33052298926
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:42:25,378] [INFO] [logging.py:60:log_dist] [Rank 0] step=1340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:42:25,442] [INFO] [timer.py:160:stop] 0/1340, SamplesPerSec=4746.8499953615965
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:15.98645522 ms
avg iteration GPU training time:317.70219560 ms
avg iteration (step) total cpu time:345.66170519 ms
Epoch Time(s): 7.4148
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.2744 | Train Acc 0.9272 | Speed (samples/sec) 33766.9867 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:42:30,850] [INFO] [logging.py:60:log_dist] [Rank 0] step=1350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:42:30,914] [INFO] [timer.py:160:stop] 0/1350, SamplesPerSec=4746.045143410957
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:42:34,268] [INFO] [logging.py:60:log_dist] [Rank 0] step=1360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:42:34,331] [INFO] [timer.py:160:stop] 0/1360, SamplesPerSec=4746.561383836811
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:17.29771640 ms
avg iteration GPU training time:311.70498935 ms
avg iteration (step) total cpu time:341.35020863 ms
Epoch Time(s): 7.5050
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.2683 | Train Acc 0.9273 | Speed (samples/sec) 33762.9642 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:42:39,590] [INFO] [logging.py:60:log_dist] [Rank 0] step=1370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:42:39,648] [INFO] [timer.py:160:stop] 0/1370, SamplesPerSec=4746.301438635097
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:15.60717383 ms
avg iteration GPU training time:323.56301048 ms
avg iteration (step) total cpu time:351.98129307 ms
Epoch Time(s): 7.5196
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.2716 | Train Acc 0.9255 | Speed (samples/sec) 33756.4262 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:42:45,091] [INFO] [logging.py:60:log_dist] [Rank 0] step=1380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:42:45,154] [INFO] [timer.py:160:stop] 0/1380, SamplesPerSec=4744.32280373994
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:42:48,552] [INFO] [logging.py:60:log_dist] [Rank 0] step=1390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:42:48,615] [INFO] [timer.py:160:stop] 0/1390, SamplesPerSec=4744.349917413575
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:17.72504711 ms
avg iteration GPU training time:315.57033747 ms
avg iteration (step) total cpu time:345.34536708 ms
Epoch Time(s): 7.5508
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.2674 | Train Acc 0.9264 | Speed (samples/sec) 33751.8461 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:42:53,989] [INFO] [logging.py:60:log_dist] [Rank 0] step=1400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:42:54,052] [INFO] [timer.py:160:stop] 0/1400, SamplesPerSec=4744.420032147798
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:17.27096731 ms
avg iteration GPU training time:306.83379850 ms
avg iteration (step) total cpu time:336.88701283 ms
Epoch Time(s): 7.3925
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.2575 | Train Acc 0.9272 | Speed (samples/sec) 33756.8663 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:42:59,372] [INFO] [logging.py:60:log_dist] [Rank 0] step=1410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:42:59,436] [INFO] [timer.py:160:stop] 0/1410, SamplesPerSec=4744.346402243577
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:43:02,879] [INFO] [logging.py:60:log_dist] [Rank 0] step=1420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:43:02,942] [INFO] [timer.py:160:stop] 0/1420, SamplesPerSec=4744.004163274576
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.80564941 ms
avg iteration GPU training time:313.05044001 ms
avg iteration (step) total cpu time:343.19964322 ms
Epoch Time(s): 7.5668
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.2553 | Train Acc 0.9296 | Speed (samples/sec) 33752.8738 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:43:08,253] [INFO] [logging.py:60:log_dist] [Rank 0] step=1430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:43:08,315] [INFO] [timer.py:160:stop] 0/1430, SamplesPerSec=4743.95234452362
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:43:11,679] [INFO] [logging.py:60:log_dist] [Rank 0] step=1440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:43:11,742] [INFO] [timer.py:160:stop] 0/1440, SamplesPerSec=4744.221307071496
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.12654244 ms
avg iteration GPU training time:313.94544567 ms
avg iteration (step) total cpu time:342.88295833 ms
Epoch Time(s): 7.4514
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.2682 | Train Acc 0.9277 | Speed (samples/sec) 33753.4157 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:43:17,427] [INFO] [logging.py:60:log_dist] [Rank 0] step=1450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:43:17,489] [INFO] [timer.py:160:stop] 0/1450, SamplesPerSec=4744.113667981451
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.20668203 ms
avg iteration GPU training time:309.67874423 ms
avg iteration (step) total cpu time:337.93835206 ms
Epoch Time(s): 7.7316
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.2689 | Train Acc 0.9249 | Speed (samples/sec) 33756.2542 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:43:22,770] [INFO] [logging.py:60:log_dist] [Rank 0] step=1460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:43:22,830] [INFO] [timer.py:160:stop] 0/1460, SamplesPerSec=4744.616975831587
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:43:26,236] [INFO] [logging.py:60:log_dist] [Rank 0] step=1470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:43:26,299] [INFO] [timer.py:160:stop] 0/1470, SamplesPerSec=4745.143156811068
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.18055560 ms
avg iteration GPU training time:312.31294667 ms
avg iteration (step) total cpu time:340.89777686 ms
Epoch Time(s): 7.4621
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.2750 | Train Acc 0.9219 | Speed (samples/sec) 33756.4878 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:43:31,696] [INFO] [logging.py:60:log_dist] [Rank 0] step=1480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:43:31,760] [INFO] [timer.py:160:stop] 0/1480, SamplesPerSec=4743.757859311789
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.10333087 ms
avg iteration GPU training time:313.22493397 ms
avg iteration (step) total cpu time:342.13443236 ms
Epoch Time(s): 7.5272
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.2596 | Train Acc 0.9276 | Speed (samples/sec) 33753.8490 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:43:37,105] [INFO] [logging.py:60:log_dist] [Rank 0] step=1490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:43:37,164] [INFO] [timer.py:160:stop] 0/1490, SamplesPerSec=4743.483198561069
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:43:40,581] [INFO] [logging.py:60:log_dist] [Rank 0] step=1500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:43:40,646] [INFO] [timer.py:160:stop] 0/1500, SamplesPerSec=4743.4147692118095
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:15.93297438 ms
avg iteration GPU training time:312.43640414 ms
avg iteration (step) total cpu time:341.16092595 ms
Epoch Time(s): 7.5207
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.2678 | Train Acc 0.9254 | Speed (samples/sec) 33751.2188 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:43:46,008] [INFO] [logging.py:60:log_dist] [Rank 0] step=1510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:43:46,070] [INFO] [timer.py:160:stop] 0/1510, SamplesPerSec=4742.872723320992
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:43:49,455] [INFO] [logging.py:60:log_dist] [Rank 0] step=1520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:43:49,518] [INFO] [timer.py:160:stop] 0/1520, SamplesPerSec=4742.911131540169
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.53047882 ms
avg iteration GPU training time:316.14650102 ms
avg iteration (step) total cpu time:344.77962147 ms
Epoch Time(s): 7.4981
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.2563 | Train Acc 0.9288 | Speed (samples/sec) 33745.9093 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:43:54,973] [INFO] [logging.py:60:log_dist] [Rank 0] step=1530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:43:55,036] [INFO] [timer.py:160:stop] 0/1530, SamplesPerSec=4741.880537514933
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:18.09255279 ms
avg iteration GPU training time:312.15336193 ms
avg iteration (step) total cpu time:343.19652211 ms
Epoch Time(s): 7.5471
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.2768 | Train Acc 0.9238 | Speed (samples/sec) 33741.9046 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:44:00,295] [INFO] [logging.py:60:log_dist] [Rank 0] step=1540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:44:00,357] [INFO] [timer.py:160:stop] 0/1540, SamplesPerSec=4742.062089390411
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:44:03,739] [INFO] [logging.py:60:log_dist] [Rank 0] step=1550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:44:03,803] [INFO] [timer.py:160:stop] 0/1550, SamplesPerSec=4742.206169448165
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:15.90945174 ms
avg iteration GPU training time:315.44928811 ms
avg iteration (step) total cpu time:343.98315170 ms
Epoch Time(s): 7.4443
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.2625 | Train Acc 0.9264 | Speed (samples/sec) 33741.3027 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:44:09,214] [INFO] [logging.py:60:log_dist] [Rank 0] step=1560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:44:09,276] [INFO] [timer.py:160:stop] 0/1560, SamplesPerSec=4741.163917591278
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.49468491 ms
avg iteration GPU training time:311.29711637 ms
avg iteration (step) total cpu time:340.50872109 ms
Epoch Time(s): 7.4752
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.2673 | Train Acc 0.9241 | Speed (samples/sec) 33738.6629 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:44:14,516] [INFO] [logging.py:60:log_dist] [Rank 0] step=1570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:44:14,578] [INFO] [timer.py:160:stop] 0/1570, SamplesPerSec=4741.517259384557
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:44:18,026] [INFO] [logging.py:60:log_dist] [Rank 0] step=1580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:44:18,089] [INFO] [timer.py:160:stop] 0/1580, SamplesPerSec=4741.954344685359
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:16.84335414 ms
avg iteration GPU training time:312.12460882 ms
avg iteration (step) total cpu time:341.73707529 ms
Epoch Time(s): 7.4826
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.2630 | Train Acc 0.9264 | Speed (samples/sec) 33738.2274 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:44:23,406] [INFO] [logging.py:60:log_dist] [Rank 0] step=1590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:44:23,469] [INFO] [timer.py:160:stop] 0/1590, SamplesPerSec=4741.820456970656
-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:44:26,854] [INFO] [logging.py:60:log_dist] [Rank 0] step=1600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:44:26,918] [INFO] [timer.py:160:stop] 0/1600, SamplesPerSec=4742.019940614189
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:17.50356648 ms
avg iteration GPU training time:319.04206155 ms
avg iteration (step) total cpu time:349.96865012 ms
Epoch Time(s): 7.5029
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.2628 | Train Acc 0.9272 | Speed (samples/sec) 33734.9160 | GPU 17159.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

[2021-06-17 21:44:32,261] [INFO] [logging.py:60:log_dist] [Rank 0] step=1610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 21:44:32,323] [INFO] [timer.py:160:stop] 0/1610, SamplesPerSec=4742.155989872673
-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71533203125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72705078125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.68994140625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.72900390625GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 16.757347106933594  GigaBytes

avg iteration(step) data from cpu to GPU time:15.49536861 ms
avg iteration GPU training time:307.86993131 ms
avg iteration (step) total cpu time:335.52557772 ms
Epoch Time(s): 7.3499
Eval Acc 0.9159
Test Acc: 0.7496
Avg epoch time(time.time()): 7517.740731438001 ms
total avg iteration(step) data from cpu to GPU time:16.55537533 ms
total avg iteration GPU training time:313.04274777 ms
total avg iteration (step) total cpu time:342.19941913 ms
